_jsload_('AMap.CustomLayer', 'var Vc=Ec.extend({G:{visible:!0,opacity:1,zIndex:11,zooms:[3,18],alwaysRender:!1},B:function(b,c){this.CLASS_NAME="AMap.CustomLayer";V.a.Sa(this.CLASS_NAME,c);this.re=V.f.create("div",null,"amap-e");this.re.appendChild(b);b.className="amap-custom";V.g.bb(this,c);this.ke(this.G)},setOpacity:function(b){V.a.add(this.CLASS_NAME,"setOpacity");this.re&&V.f.jk(this.re,b);this.set("opacity",b,!0)},getContainer:function(){V.a.add(this.CLASS_NAME,"getContainer");return this.re},show:function(){V.a.add(this.CLASS_NAME, "show");this.set("visible",!0)},hide:function(){V.a.add(this.CLASS_NAME,"hide");this.set("visible",!1)},setzIndex:function(b){V.a.add(this.CLASS_NAME,"setzIndex");this.set("zIndex",b,!0);this.re&&(this.re.style.zIndex=b)},Nf:function(b){this.get("map")||this.set("map",b.Ca,!0);return new V.V.Zq(this,b)}});window.AMap.CustomLayer=Vc;V.V.Zq=V.V.Af.extend({B:function(b,c){this.Ua=b;this.Xh=!0;this.nv=V.g.Ab(this);b&&this.ld("opacity visible zIndex zooms container alwaysRender".split(" "),b);this.A=c;this.P("display",c)},Tj:function(){return{visible:this.get("visible"),zIndex:this.get("zIndex"),Pc:this.get("zooms"),opacity:this.get("opacity"),D:this.get("container"),zp:this.get("alwaysRender")}},VX:function(){return this.Ua.render},Ih:function(b){if(V.J.Zq)return new V.J.Zq(this,b)}});V.J.Zq=V.J.Af.extend({qf:function(){return this.q.get("container")},he:function(b,c){if(this.q){var d=b.la.Aa;if(this.ia&&!this.q.Ua.co){if(this.ia===d&&this.cd===b.la.zoom&&!this.A.xu)return;if(!c.zp&&(b.Sf||b.yd)){if(!V.f.Bd&&b.yd){c.D.style.visibility="hidden";return}var d=Math.pow(2,b.la.zoom-this.cd),e=b.la.Aa.Ja(this.ia);e.x<-V.g.Va/2&&(e.x+=V.g.Va);e.x>V.g.Va/2&&(e.x-=V.g.Va);e=e.Gb(this.vf);1!==d&&(c.D.style[V.f.Bd]="scale3d("+d+","+d+",1)");c.D.style.top=-e.y*d+"px";c.D.style.left=-e.x*d+ "px";return}}(e=this.q.VX())&&e.call(this.q.Ua,b);this.q.zb||(this.q.zb=!0,V.g.Fe(function(){this.q&&this.q.ua("complete")},this));this.ia=d;this.vf=b.la.N;this.cd=b.la.zoom;c.D.style.zIndex=c.zIndex;c.D.style[V.f.Bd]="";c.D.style.top="";c.D.style.left="";c.D.style.height="";c.D.style.visibility="";V.f.jk(c.D,c.opacity)}}}); ')
_jsload_('cvector', 'V.J.canvas.xk=V.J.ug.extend({B:function(b,c){arguments.callee.Za.apply(this,arguments);var d=this;this.sE=function(){d.set("display",0)};this.ce();this.q.P("feature",this,!0)},O5:function(b,c){return V.r.Ld(b,c.Kl)||V.r.Ld(b,c.lZ)},UI:function(){return this.mb.cM},ce:function(){this.ta=document.createElement("canvas");this.ta.className="amap-vectors";this.La=this.ta.getContext("2d");this.Xd=this.q.Jc?this.q.rb:1;this.mb=new V.J.canvas.kd(this.ta,this.sE,this.Xd)},j4:function(b,c){var d=new V.rh;d.z= c;d.x=Math.floor(b[0]/this.A.get("resolution")/this.Wc);d.y=Math.floor(b[1]/this.A.get("resolution")/this.Wc);return d},k4:function(b,c,d){var e=b.x;b=b.y;return[this.yA*e-c*this.zc,this.yA*b-d*this.zc,this.yA*(e+1)+c*this.zc,this.yA*(b+1)+d*this.zc]},j3:function(){500<this.q.Jl.length&&this.Ka.clear();if(!this.Ka.iq()&&0!==this.q.Jl.length)for(var b in this.q.Jl)if(this.q.Jl.hasOwnProperty(b)){var c=this.q.Jl[b];if(c.va){var d=c.va.dc(),e=[];this.Ka.forEach(function(b,c){V.r.Ld(b[1],d)&&e.push(c)}, this);for(c=0;c<e.length;c+=1)this.Ka.remove(e[c])}}this.q.Jl=[]},he:function(b,c){if(this.iL||this.ia!==b.la.Aa||this.ia.zoom!==b.la.zoom||this.ia.rotation!==b.la.rotation||this.q.dh||this.A.xu){var d=this.la=b.la,e=this.N=d.N,g=this.q;this.zoom=d.zoom;this.Pa=d.Aa;this.rotation=d.rotation;var h=b.ma;this.yc=d.yc;d=this.Xd;this.ia||(this.ia=this.Pa,this.ia.zoom=this.zoom,this.ia.rotation=this.rotation,this.vf=this.N);if(this.q.dh||!b.Sf&&!b.yd||c.zp&&!b.U){this.ia=this.Pa;this.ia.zoom=this.zoom; this.ia.rotation=this.rotation;this.vf=this.N;this.q.dh=!1;this.mb.Xd=d;this.mb.zc=e/d;this.mb.ac=[h.$a.x,h.$a.y];var k=this.ta;k.width=Math.round(2*h.cb.x)*d;k.height=Math.round(2*h.cb.y)*d;var k=this.q.Ui||0,l=this.q.An||0,d=Math.max(this.q.ei,k/this.N)+l,k=Math.max(this.q.fi,k/this.N)+l,h=[h.$a.x,h.$a.y,h.Wb.x,h.Wb.y];h[0]-=d*e;h[1]-=k*e;h[2]+=d*e;h[3]+=k*e;e=g.ah(h);this.mb.La.et=0;this.mb.La.Jq=!1;if(this.q.Ua.Yh)g=this.q.get("style"),this.mb.fL(e,g)||(this.iL=!0);else{for(var m in e)e.hasOwnProperty(m)&& (e[m].get("visible")||delete e[m]);g=g.aJ(e);m=g.length;this.iL=!1;for(e=0;e<m;e+=1)this.mb.fL(g[e][0])}this.Kc(b)}else this.Kc(b,c,!0)}},Kc:function(){var b=Math.pow(2,this.zoom-this.ia.zoom),c=this.q.Jc?this.q.rb:1;this.transform={translate:this.Pa.Ja(this.ia).Gb(this.vf/c).add({x:this.ta.width/2,y:this.ta.height/2}),scale:b/c,rotate:0}},qf:function(){return this.ta}});V.J.canvas.kd=V.W.extend({B:function(b,c,d){this.ta=b;this.lo=25*d;this.La=b.getContext("2d");this.gn=document.createElement("canvas");b=6*d;this.gn.width=b;this.gn.height=b;var e=this.gn.getContext("2d");e.strokeStyle="#fff";e.lineWidth=2*d;e.moveTo(-1,b-1);e.lineTo(b/2,1);e.lineTo(b+1,b-1);e.stroke();this.wa={};this.Fk=c;this.Xd=d},fL:function(b,c){var d=!0,e;for(e in b)if(b.hasOwnProperty(e)){var g=b[e],h=g.name.split("-")[0];"circle"===h?this.s_(g,c||g.style):"point"===h?this.D_(g,c)||(d=!1): "polyline"===h?this.H_(g,c||g.style):"polygon"===h||"multipolygon"===h?this.E_(g,c||g.style):"text"===h&&this.n5(g,c||g.style)}return d},s_:function(b,c){var d=this.La,e=c.strokeColor,g=c.strokeWeight,h=c.strokeOpacity,k=c.fillColor,l=c.fillOpacity,m=c.strokeStyle,n=c.strokeDasharray,p,q=2*Math.PI,r,t;d.setLineDash&&d.setLineDash([]);d.save();k&&(d.fillStyle=k);e&&(g&&(d.lineWidth=g*this.Xd),d.strokeStyle=e);g=b.va;g instanceof V.ba.oe&&(t=[g]);for(var g=0,w=t.length;g<w;g+=1){d.beginPath();r=t[g].Ga; r=this.Ib(r);var u=b.get("radius")/(this.zc*Math.cos(Math.PI*b.get("center").M/180));d.arc(r[0],r[1],u,0,q,!0);d.closePath();k&&l!==p&&(p=d.globalAlpha=l);d.fill();e&&(h!==p&&(p=d.globalAlpha=h),"dashed"===m?d.setLineDash?(d.setLineDash(n),d.stroke()):d.kW(r[0],r[1],u,n):d.stroke())}d.restore()},D_:function(b,c){var d=this.La,e,g,h=0,k=0;e=this.Up(c.url);if(!e)return!1;var l=c.size.width,m=c.size.height,h=c.anchor.x,k=c.anchor.y;g=this.Ib(b.va.Ga);d.drawImage(e,Math.round(g[0]-h),Math.round(g[1]- k),l,m);return!0},RX:function(b,c,d){return[(c[0]-b[0])*d+b[0],(c[1]-b[1])*d+b[1]]},H_:function(b,c){var d=this.La,e,g,h,k,l,m,n,p,q,r;p=[NaN,NaN,0];var t=[NaN,NaN],w=[NaN,NaN];d.globalAlpha=c.strokeOpacity;e=c.strokeStyle;g=c.strokeDasharray;d.lineCap=c.lineCap||"butt";d.lineJoin=c.lineJoin||"round";d.setLineDash&&d.setLineDash([]);d.save();d.beginPath();h=b.va;h instanceof V.ba.uk?k=[h]:h instanceof V.ba.fr&&(k=h.Id);var u=c.showDir;h=[];l=0;for(m=k.length;l<m;l+=1){n=k[l].Ga;var D=[],v=0;q=0;for(r= n.length;q<r;q+=1)if(p=n[q],p=this.Ib(p),D.push(p),0===q)w[0]=p[0],w[1]=p[1],d.moveTo(p[0],p[1]);else if(t[0]=p[0],t[1]=p[1],q==n.length-1||3<=Math.abs(t[0]-w[0])||3<=Math.abs(t[1]-w[1])){if(u){var s=Math.sqrt(Math.pow(t[0]-w[0],2)+Math.pow(t[1]-w[1],2));if(s+v>this.lo){var O=0,O=w,J=t;if(J[0]===O[0])O=J[1]>O[1]?Math.PI:0;else if(J[1]===O[1])O=J[0]>O[0]?Math.PI/2:-Math.PI/2;else{var E=J[0]-O[0],J=J[1]-O[1],O=Math.atan(E/J);0<E&&0<J?O=Math.PI-O:0>E&&0>J?O=-O:0<E&&0>J?O=-O:0>E&&0<J&&(O=Math.PI-O)}for(E= this.lo-v;E<s;)J=this.RX(w,t,E/s),0<J[0]&&J[0]<this.ta.width&&0<J[1]&&J[1]<this.ta.height&&h.push(J[0],J[1],O),E+=this.lo;v=(s-(this.lo-v))%this.lo}else v+=s}"dashed"!==e||d.setLineDash?d.lineTo(p[0],p[1]):d.Hy(w[0],w[1],p[0],p[1],g);w[0]=t[0];w[1]=t[1]}}"dashed"===e&&d.setLineDash&&d.setLineDash(g);c.isOutline&&(d.strokeStyle=c.outlineColor,d.lineWidth=(c.strokeWeight+2*c.borderWeight)*this.Xd,d.stroke());c.strokeColor&&(d.strokeStyle=c.strokeColor,d.lineWidth=c.strokeWeight*this.Xd,d.stroke()); d.restore();for(e=0;e<h.length;e+=3)d.save(),d.translate(h[e],h[e+1]),d.rotate(h[e+2]),d.drawImage(this.gn,-this.gn.width/2,-this.gn.width/2),d.restore()},E_:function(b,c){var d=this.La,e=c.strokeColor,g=c.strokeWeight,h=c.strokeOpacity,k=c.fillColor,l=c.fillOpacity,m=c.strokeStyle,n=c.strokeDasharray,p,q,r,t,w,u,D,v,s,O;v=[NaN,NaN,0];var J=[NaN,NaN],E=[NaN,NaN];d.setLineDash&&d.setLineDash([]);d.save();e&&(d.strokeStyle=e,g&&(d.lineWidth=g*this.Xd),d.lineCap="butt",d.lineJoin=c.lineJoin||"miter"); k&&(d.fillStyle=k);d.beginPath();this.ao={};g=0;q=b.va;q instanceof V.ba.Xc?r=[q]:q instanceof V.ba.oo&&(r=q.Id);q=0;for(t=r.length;q<t;q+=1)if(w=r[q],w=w.df,u=w.length,0<u)for(var C=0;C<u;C+=1){var T;D=w[C].Ga;this.ao[g]=[];s=0;for(O=D.length;s<O;s+=1)if(v=D[s],v=this.Ib(v),this.ao[g].push(v),0===s)E[0]=NaN,E[1]=NaN,T=[v[0],v[1]],d.moveTo(v[0],v[1]);else if(J[0]=Math.round(v[0]),J[1]=Math.round(v[1]),J[0]!==E[0]||J[1]!==E[1])d.lineTo(v[0],v[1]),E[0]=J[0],E[1]=J[1];g+=1;T&&d.lineTo(T[0],T[1])}d.closePath(); k&&(l!==p&&(p=d.globalAlpha=l),d.fill());if(e){h!==p&&(d.globalAlpha=h);if("dashed"===m)if(d.setLineDash)d.setLineDash(n);else{d.beginPath();for(var P in this.ao)if(this.ao.hasOwnProperty(P))for(l=this.ao[P],m=0,p=l.length;m<p;m+=1)r=m===p-1?0:m+1,e=Math.round(l[m][0]),h=Math.round(l[m][1]),k=Math.round(l[r][0]),r=Math.round(l[r][1]),d.Hy(e,h,k,r,n)}d.stroke()}d.restore()},Up:function(b){var c=this.wa[b];if("undefined"===typeof c)c=document.createElement("img"),c.src=b,this.wa[b]=c,c.loaded=!1,V.w.dk(c, "load",function(){c.loaded=!0;var b=document.createElement("canvas");b.width=c.naturalWidth;b.height=c.naturalHeight;b.getContext("2d").drawImage(c,0,0);c.canvas=b;this.Fk&&this.Fk()},this);else if(c.loaded)return c.canvas||c},Ib:function(b){var c=this.zc;return[(b[0]-this.ac[0])/c,(b[1]-this.ac[1])/c]}}); ')
_cssload_('AMap.IndoorMap', '.amap-indoor-map .label-canvas{position:absolute;top:0;left:0}.amap-indoor-map .highlight-image-con *{pointer-events:none}.amap-indoormap-floorbar-control{position:absolute;margin:auto 0;bottom:165px;right:12px;width:35px;text-align:center;line-height:1.3em;overflow:hidden;padding:0 2px}.amap-indoormap-floorbar-control .panel-box{background-color:rgba(255,255,255,.9);border-radius:3px;border:1px solid #ccc}.amap-indoormap-floorbar-control .select-dock{position:absolute;top:0;left:0;width:100%;box-sizing:border-box;height:30px;border:solid #4196ff;border-width:0 2px;border-radius:2px;pointer-events:none;background:linear-gradient(to bottom,#f6f8f9 0,#e5ebee 50%,#d7dee3 51%,#f5f7f9 100%)}.amap-indoor-map .transition{transition:opacity .2s},.amap-indoormap-floorbar-control .transition{transition:top .2s,margin-top .2s}.amap-indoormap-floorbar-control .select-dock:after,.amap-indoormap-floorbar-control .select-dock:before{content:"";position:absolute;width:0;height:0;left:0;top:10px;border:solid transparent;border-width:4px;border-left-color:#4196ff}.amap-indoormap-floorbar-control .select-dock:after{right:0;left:auto;border-left-color:transparent;border-right-color:#4196ff}.amap-indoormap-floorbar-control.is-mobile{width:37px}.amap-indoormap-floorbar-control.is-mobile .floor-btn{height:35px;line-height:35px}.amap-indoormap-floorbar-control.is-mobile .select-dock{height:35px;top:36px}.amap-indoormap-floorbar-control.is-mobile .select-dock:after,.amap-indoormap-floorbar-control.is-mobile .select-dock:before{top:13px}.amap-indoormap-floorbar-control.is-mobile .floor-list-box{height:105px}.amap-indoormap-floorbar-control .floor-list-item .floor-btn{color:#555;font-family:"Times New Roman",sans-serif,"Microsoft Yahei";font-size:16px}.amap-indoormap-floorbar-control .floor-list-item.selected .floor-btn{color:#000}.amap-indoormap-floorbar-control .floor-btn{height:28px;line-height:28px;overflow:hidden;cursor:pointer;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.amap-indoormap-floorbar-control .floor-btn:hover{background-color:rgba(221,221,221,.4)}.amap-indoormap-floorbar-control .floor-minus,.amap-indoormap-floorbar-control .floor-plus{position:relative;text-indent:-1000em}.amap-indoormap-floorbar-control .floor-minus:after,.amap-indoormap-floorbar-control .floor-plus:after{content:"";position:absolute;margin:auto;top:9px;left:0;right:0;width:0;height:0;border:solid transparent;border-width:10px 8px;border-top-color:#777}.amap-indoormap-floorbar-control .floor-minus.disabled,.amap-indoormap-floorbar-control .floor-plus.disabled{opacity:.3}.amap-indoormap-floorbar-control .floor-plus:after{border-bottom-color:#777;border-top-color:transparent;top:-3px}.amap-indoormap-floorbar-control .floor-list-box{max-height:153px;position:relative;overflow-y:hidden}.amap-indoormap-floorbar-control .floor-list{margin:0;padding:0;list-style:none}.amap-indoormap-floorbar-control .floor-list-item{position:relative}.amap-indoormap-floorbar-control .floor-btn.disabled,.amap-indoormap-floorbar-control .floor-btn.disabled *,.amap-indoormap-floorbar-control.with-indrm-loader *{-webkit-pointer-events:none!important;pointer-events:none!important}.amap-indoormap-floorbar-control .with-indrm-loader .floor-nonas{opacity:.5}.amap-indoor-map-moverf-marker{color:#555;background-color:#FFFEEF;border:1px solid #7E7E7E;padding:3px 6px;font-size:12px;white-space:nowrap;display:inline-block;position:absolute;top:1em;left:1.2em}.amap-indoormap-floorbar-control .amap-indrm-loader{-moz-animation:amap-indrm-loader 1.25s infinite linear;-webkit-animation:amap-indrm-loader 1.25s infinite linear;animation:amap-indrm-loader 1.25s infinite linear;border:2px solid #91A3D8;border-right-color:transparent;box-sizing:border-box;display:inline-block;overflow:hidden;text-indent:-9999px;width:13px;height:13px;border-radius:7px;position:absolute;margin:auto;top:0;left:0;right:0;bottom:0}@-moz-keyframes amap-indrm-loader{0%{-moz-transform:rotate(0);transform:rotate(0)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes amap-indrm-loader{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes amap-indrm-loader{0%{-moz-transform:rotate(0);-ms-transform:rotate(0);-webkit-transform:rotate(0);transform:rotate(0)}100%{-moz-transform:rotate(360deg);-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)}}')
_jsload_('AMap.IndoorMap', 'V.XM=V.W.extend({oa:[V.ca],B:function(b){this.lm=V.extend({size:120,SL:0.7,oI:2,RL:300},b);this.hf={};this.ri=0;this.pv=this.lm.size},KN:function(b){return{Rq:b,gy:V.g.Pi(),Es:0}},get:function(b,c){if(!this.sc(b))return c;var d=this.hf[b];d.gy=V.g.Pi();d.Es+=1;return d.Rq},forEach:function(b,c){for(var d in this.hf)if(this.hf.hasOwnProperty(d)&&!1===b.call(c,this.hf[d].Rq,d))break},En:function(b,c){return this.get(b,c)},set:function(b,c){this.sc(b)?this.hf[b].Rq=c:(this.ri+=1,this.hf[b]=this.KN(c)); this.ri>this.pv&&this.MN()},sc:function(b){return this.hf.hasOwnProperty(b)},cm:function(b){if(!this.sc(b))return null;this.ri-=1;var c=this.hf[b];delete this.hf[b];return c.Rq},clear:function(){this.kv();this.hf={};this.ri=0},kv:function(){this.qv&&clearTimeout(this.qv)},MN:function(){if(this.ri>this.pv*this.lm.oI)this.kv(),this.LC();else if(!(10>V.g.Pi()-this.ON)){this.kv();var b=this;this.qv=setTimeout(function(){b.qv=null;b.LC()},this.lm.RL);this.ON=V.g.Pi()}},LC:function(){var b=Math.round(this.pv* this.lm.SL);if(!(this.ri<b))for(var b=this.GN(this.ri-b),c,d,e=0,g=b.length;e<g;e+=1)c=b[e],d=this.cm(c),this.l("drop",{key:c,Rq:d})},CN:function(b,c){var d=this.hf[b],e=this.hf[c],g=d.gy-e.gy;return 0!==g?g:d.Es-e.Es},GN:function(b){var c=[],d;for(d in this.hf)this.hf.hasOwnProperty(d)&&c.push(d);return this.HN(c,b,this.CN)},HN:function(b,c,d){if(0>=c)return[];for(var e=0,g=b.length-1,h,k,l;e<g;){h=e;k=g;for(l=b[c];h<=c&&k>=c;){for(;h<=c&&0>d.call(this,b[h],l);)h+=1;for(;k>=c&&0<d.call(this,b[k], l);)k-=1;var m=b[h];b[h]=b[k];b[k]=m;h+=1;k-=1}k<c&&(e=h);h>c&&(g=k)}return b.slice(0,c)}});V.im={Jy:function(b){V.f.wb(b,"transition")},lA:"function"!==typeof Object.create?function(){function b(){}return function(c){b.prototype=c;c=new b;b.prototype=null;return c}}():Object.create,iH:function(b,c){var d=this.mU;d||(d=this.mU=this.fQ());if(!1!==d){this.Jy(b);var e,g=this,h=function(){clearTimeout(e);g.Jy(b);V.w.C(b,d,h,g)};e=setTimeout(h,c||1E3);V.f.pb(b,"transition");V.w.dk(b,d,h,this)}},fQ:function(){var b,c=document.createElement("fakeelement"),d={transition:"transitionend",OTransition:"oTransitionEnd", MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(b in d)if(void 0!==c.style[b])return d[b];return!1}};(function(){var b="strokeColor strokeOpacity strokeWeight fillColor fillOpacity strokeStyle strokeDasharray fontSize".split(" "),c=V.W.extend({B:function(){this.dO=1;this.Nx={};this.HO(d);this.cF=[]},AJ:function(b){for(var c=!0,d=13;22>=d;d++){var k=this.QI(b,d);if(k&&(0<k.fontSize||k.be)){c=!1;break}}return c},QI:function(b,c){return this.qw(b,c)},UX:function(b,c){return this.qw(b,c)},OX:function(b,c){return this.qw(b,c)},eW:function(c,d){if(d)for(var h in d)d.hasOwnProperty(h)&&0<=b.indexOf(h)&& void 0===c[h]&&(c[h]=d[h]);return c},ot:function(c,d){if(!c)return null;for(var h={},k=0,l=b.length;k<l;k++){var m=b[k];c.hasOwnProperty(m)&&void 0!==c[m]&&(h[m]=c[m])}this.eW(h,d);return h},e3:function(b,c){return void 0===b?c:this.mz(b?this.ot(b,c):null)},tH:function(b){if(!b)return null;b=this.ot(b);return V.extend(b,{Qg:this.YX(b)})},qw:function(b,c){var d=b[0]+"_"+b[1];c=Math.round(c);var k=this.Nx[d];if(!k)return 0>this.cF.indexOf(d)&&this.cF.push(d),null;for(var d=0,l=k.length;d<l;d++)if(0<= k[d].yn.indexOf(""+c))return k[d].tB;return 20<c&&(k=k[k.length-1],0<=k.yn.indexOf("20"))?(k.yn.push(""+c),k.tB):null},HO:function(b){for(var c in b)this.IO(b[c],c)},IO:function(b,c){for(var d=0,k=b.length;d<k;d++)this.EO(b[d],c)},EO:function(b,c){var d=b.$;if(d){var k=b.StyleItem,d=d.mainkey+"_"+d.subkey;this.Nx[d]&&console.error("Style key duplicate",d);this.Nx[d]=this.GO(k,c)}else console.warn("Missing group $",b)},GO:function(b,c){for(var d=[],k=0,l=b.length;k<l;k++){var m=this.FO(b[k],c);m&& d.push(m)}return d},FO:function(b,c){var d=b.$;if(d){var k={};k.yn=d.level.split(",");k.wW=d.desc.split(",");k.tB=this.DO(k,k.wW,c);k.tB.yn=k.yn;return k}console.warn("Missing $",b)},Fm:function(b){b.trim&&(b=b.trim());return V.g.cy(b.substr(2,8))},XI:function(){return this.dO++},YX:function(b){var c=[],d;for(d in b)b.hasOwnProperty(d)&&c.push(d);c.sort();for(var k=[],l=0,m=c.length;l<m;l++)k.push(c[l]+":"+b[d]);return k.join(";")||"empty"},dK:function(b,c){return b?c?V.extend({},b,c,{Qg:c.Qg+";"+ b.Qg}):b:c},mz:function(b){return V.extend({},b,{Qg:this.XI()})},DO:function(b,c,d){switch(d){case "PoiStyle":b={be:parseInt(c[1],10),fontSize:Math.min(15,parseInt(c[4],10)||0),fillColor:this.Fm(c[5]),strokeColor:this.Fm(c[6]),nD:0===parseInt(c[8],10)};1===b.be&&(b.be=0);break;case "LineStyle":b={fillColor:"rgba(252,249,242,1)",strokeColor:this.Fm(c[7]),strokeWeight:Math.max(2,Math.round(parseInt(c[2],10)/3))};break;case "RegionStyle":b={fillColor:this.Fm(c[2])};break;case "BuildingStyle":b={fillColor:this.Fm(c[1]), strokeColor:this.Fm(c[2])};break;default:return console.warn("Unknown style type",d),null}b.Qg=this.XI();return b}}),d={PoiStyle:[{$:{mainkey:"10001",subkey:"1"},StyleItem:[{$:{level:"18,19,20",desc:"50,2,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"2"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,7,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"3"},StyleItem:[{$:{level:"19,20",desc:"50,8,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"4"}, StyleItem:[{$:{level:"18",desc:"50,25,2,1,0,0xff84638E,0xffffffff,0x0,0"}},{$:{level:"19,20",desc:"50,25,1,1,12,0xff84638E,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"5"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,59,2,1,0,0xff84638E,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"6"},StyleItem:[{$:{level:"18,19,20",desc:"50,3,1,1,12,0xff84638E,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"7"},StyleItem:[{$:{level:"18,19,20",desc:"50,4,1,1,12,0xff816B4E,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001", subkey:"8"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,9,1,1,12,0xff935676,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"9"},StyleItem:[{$:{level:"18,19,20",desc:"50,10,1,1,12,0xff935676,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"10"},StyleItem:[{$:{level:"18,19,20",desc:"50,14,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"11"},StyleItem:[{$:{level:"18,19,20",desc:"50,15,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"12"},StyleItem:[{$:{level:"18,19,20", desc:"50,17,1,1,12,0xff816B4E,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"13"},StyleItem:[{$:{level:"18,19,20",desc:"50,18,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"14"},StyleItem:[{$:{level:"18,19,20",desc:"50,19,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"15"},StyleItem:[{$:{level:"18,19,20",desc:"50,22,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"16"},StyleItem:[{$:{level:"20",desc:"50,24,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"17"},StyleItem:[{$:{level:"19,20",desc:"50,1,0,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"18"},StyleItem:[{$:{level:"18,19,20",desc:"50,27,1,1,12,0xff84638E,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"19"},StyleItem:[{$:{level:"18,19,20",desc:"50,36,1,1,12,0xff8E3A3D,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"20"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,39,1,1,12,0xff935676,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"21"},StyleItem:[{$:{level:"18,19", desc:"50,44,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,44,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"22"},StyleItem:[{$:{level:"18,19",desc:"50,45,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,45,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"23"},StyleItem:[{$:{level:"18,19",desc:"50,46,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,46,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"24"}, StyleItem:[{$:{level:"18,19",desc:"50,47,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,47,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"25"},StyleItem:[{$:{level:"18,19",desc:"50,48,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,48,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"26"},StyleItem:[{$:{level:"18,19",desc:"50,49,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,49,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"27"},StyleItem:[{$:{level:"18,19",desc:"50,50,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,50,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"28"},StyleItem:[{$:{level:"18,19",desc:"50,51,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,51,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"29"},StyleItem:[{$:{level:"18,19",desc:"50,52,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,52,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"30"},StyleItem:[{$:{level:"18,19",desc:"50,53,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,53,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"31"},StyleItem:[{$:{level:"18,19",desc:"50,54,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,54,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"32"},StyleItem:[{$:{level:"18,19",desc:"50,55,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,55,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"33"},StyleItem:[{$:{level:"18,19",desc:"50,56,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,56,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"34"},StyleItem:[{$:{level:"18,19",desc:"50,57,2,1,0,0xff696F71,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,57,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"35"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,6,2,1,0,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"36"}, StyleItem:[{$:{level:"18,19,20",desc:"50,12,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"37"},StyleItem:[{$:{level:"19,20",desc:"50,13,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"38"},StyleItem:[{$:{level:"18,19,20",desc:"50,16,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"39"},StyleItem:[{$:{level:"17",desc:"50,20,2,1,0,0xff69859F,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,20,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001", subkey:"40"},StyleItem:[{$:{level:"17",desc:"50,5,2,1,0,0xff69859F,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,5,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"41"},StyleItem:[{$:{level:"20",desc:"50,28,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"42"},StyleItem:[{$:{level:"18,19,20",desc:"50,29,1,1,12,0xff4C6776,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"43"},StyleItem:[{$:{level:"18,19,20",desc:"50,31,1,1,12,0xff000000,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"44"},StyleItem:[{$:{level:"18,19,20",desc:"50,32,2,1,0,0xff4C6776,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"45"},StyleItem:[{$:{level:"18,19,20",desc:"50,33,2,1,0,0xff4C6776,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"46"},StyleItem:[{$:{level:"18",desc:"50,34,2,1,0,0xff935676,0xffffffff,0x0,0"}},{$:{level:"19,20",desc:"50,34,1,1,12,0xff935676,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"47"},StyleItem:[{$:{level:"18,19,20",desc:"50,35,2,1,0,0xff4C6776,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"48"},StyleItem:[{$:{level:"19,20",desc:"50,37,1,1,12,0xff4C6776,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"49"},StyleItem:[{$:{level:"18,19,20",desc:"50,38,2,1,0,0xff4C6776,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"50"},StyleItem:[{$:{level:"18,19,20",desc:"50,42,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"51"},StyleItem:[{$:{level:"18,19,20",desc:"50,41,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"52"},StyleItem:[{$:{level:"20", desc:"50,43,1,1,12,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"53"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,58,2,1,0,0xff696F71,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"54"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,21,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"55"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,30,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"56"},StyleItem:[{$:{level:"19,20",desc:"50,1,0,1,12,0xff000000,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"57"},StyleItem:[{$:{level:"18,19,20",desc:"50,23,2,1,0,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"58"},StyleItem:[{$:{level:"18,19,20",desc:"50,40,2,1,0,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"59"},StyleItem:[{$:{level:"18,19,20",desc:"50,11,2,1,0,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"60"},StyleItem:[{$:{level:"16,17",desc:"50,1,0,1,20,0xff6590a6,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"62"},StyleItem:[{$:{level:"17,18,19,20", desc:"50,61,2,1,0,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"63"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,60,2,1,0,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"64"},StyleItem:[{$:{level:"17",desc:"50,62,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,62,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"65"},StyleItem:[{$:{level:"17",desc:"50,63,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,63,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"66"},StyleItem:[{$:{level:"17",desc:"50,64,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,64,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"67"},StyleItem:[{$:{level:"17",desc:"50,65,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,65,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"68"},StyleItem:[{$:{level:"17",desc:"50,66,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,66,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"69"},StyleItem:[{$:{level:"17",desc:"50,67,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,67,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"70"},StyleItem:[{$:{level:"17",desc:"50,68,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,68,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"71"},StyleItem:[{$:{level:"17",desc:"50,69,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,69,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"72"},StyleItem:[{$:{level:"17",desc:"50,70,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"18,19,20",desc:"50,70,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"73"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,71,2,1,0,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"74"},StyleItem:[{$:{level:"17,18,19,20",desc:"50,72,2,1,0,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"75"},StyleItem:[{$:{level:"18,19",desc:"50,73,2,1,0,0xff62686B,0xffffffff,0x0,0"}}, {$:{level:"20",desc:"50,73,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"76"},StyleItem:[{$:{level:"18,19",desc:"50,74,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,74,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"77"},StyleItem:[{$:{level:"18,19",desc:"50,75,2,1,0,0xff62686B,0xffffffff,0x0,0"}},{$:{level:"20",desc:"50,75,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"78"},StyleItem:[{$:{level:"18,19",desc:"50,76,2,1,0,0xff62686B,0xffffffff,0x0,0"}}, {$:{level:"20",desc:"50,76,1,1,12,0xff62686B,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"79"},StyleItem:[{$:{level:"19,20",desc:"50,81,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"80"},StyleItem:[{$:{level:"19,20",desc:"50,89,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"81"},StyleItem:[{$:{level:"19,20",desc:"50,85,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"82"},StyleItem:[{$:{level:"19,20",desc:"50,90,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"83"},StyleItem:[{$:{level:"19,20",desc:"50,83,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"84"},StyleItem:[{$:{level:"19,20",desc:"50,103,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"85"},StyleItem:[{$:{level:"19,20",desc:"50,98,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"86"},StyleItem:[{$:{level:"19,20",desc:"50,86,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"87"},StyleItem:[{$:{level:"19,20", desc:"50,87,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"88"},StyleItem:[{$:{level:"19,20",desc:"50,111,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"89"},StyleItem:[{$:{level:"19,20",desc:"50,88,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"90"},StyleItem:[{$:{level:"19,20",desc:"50,91,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"91"},StyleItem:[{$:{level:"19,20",desc:"50,93,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"92"},StyleItem:[{$:{level:"19,20",desc:"50,113,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"93"},StyleItem:[{$:{level:"19,20",desc:"50,95,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"94"},StyleItem:[{$:{level:"19,20",desc:"50,100,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"95"},StyleItem:[{$:{level:"19,20",desc:"50,97,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"96"},StyleItem:[{$:{level:"19,20", desc:"50,94,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"97"},StyleItem:[{$:{level:"18,19,20",desc:"50,108,1,1,12,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"98"},StyleItem:[{$:{level:"18,19,20",desc:"50,1,2,1,0,0xff69859F,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"99"},StyleItem:[{$:{level:"18,19,20",desc:"50,1,0,1,12,0xff696F71,0xffffffff,0x0,1"}}]},{$:{mainkey:"10001",subkey:"105"},StyleItem:[{$:{level:"16,17,18",desc:"50,1,0,1,14,0xff696F71,0xffffffff,0x0,0"}}]}, {$:{mainkey:"10001",subkey:"106"},StyleItem:[{$:{level:"19,20",desc:"50,1,0,1,12,0xff4d4e51,0xffffffff,0x0,0"}}]},{$:{mainkey:"10001",subkey:"107"},StyleItem:[{$:{level:"16,17,18,19,20",desc:"50,109,1,1,12,0xff4d4e51,0xffffffff,0x0,0"}}]}],LineStyle:[{$:{mainkey:"20001",subkey:"1"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"88,2,10,0,0,0,0xffe68e00,0xffe68e00,0xffe68e00,0xffe68e00"}}]},{$:{mainkey:"20001",subkey:"2"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"88,2,8,0,0,0,0xffababab,0xffababab,0xff5e492f,0xffffe080"}}]}], RegionStyle:[{$:{mainkey:"30001",subkey:"1"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"90,1,0xfffcfbed"}}]},{$:{mainkey:"30001",subkey:"99"},StyleItem:[{$:{level:"19,20",desc:"90,1,0x1a151b2b"}}]},{$:{mainkey:"30001",subkey:"98"},StyleItem:[{$:{level:"19,20",desc:"90,1,0x8c151b2b"}}]}],BuildingStyle:[{$:{mainkey:"30001",subkey:"2"},StyleItem:[{$:{level:"17,18,19,20",desc:"99,0xffe6e6e6,0xff858585,0xffcfcfcf,0xffb8b8b8,255"}}]},{$:{mainkey:"30001",subkey:"3"},StyleItem:[{$:{level:"15,16,17,18,19,20", desc:"99,0xffe6e6e6,0xff858585,0xffcfcfcf,0xffb8b8b8,255"}}]},{$:{mainkey:"30001",subkey:"4"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xffbfd6e9 ,0xff6f7c87,0xffacc0d1,0xff99abba,255"}}]},{$:{mainkey:"30001",subkey:"5"},StyleItem:[{$:{level:"17,18,19,20",desc:"99,0xffcce3e8 ,0xff778487,0xffb7ccd0,0xffa3b6ba,255"}}]},{$:{mainkey:"30001",subkey:"6"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xffcce3e8,0xff778487,0xffb7ccd0,0xffa3b6ba,255"}}]},{$:{mainkey:"30001",subkey:"7"},StyleItem:[{$:{level:"15,16,17,18,19,20", desc:"99,0xffe5dae8,0xff857f87,0xffcec4d0,0xffb7aeba,255"}}]},{$:{mainkey:"30001",subkey:"8"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xfffaeccd,0xff948c79,0xffe1d4b8,0xffc8bda4,255"}}]},{$:{mainkey:"30001",subkey:"9"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xff90bae8,0xff546d87,0xff81a7d0,0xff7395ba,255"}}]},{$:{mainkey:"30001",subkey:"10"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xfff0e3df,0xff8f8d8c,0xffd8ccc8,0xffc0b6b2,255"}}]},{$:{mainkey:"30001",subkey:"11"}, StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xffbfd3e9,0xff6f7b87,0xffacbdd1,0xff99a9ba,255"}}]},{$:{mainkey:"30001",subkey:"12"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xffdae2f4,0xff7f848f,0xffc4cbdb,0xffaeb5c3,255"}}]},{$:{mainkey:"30001",subkey:"13"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xff95e3f5,0xff598791,0xff86ccdc,0xff77b6c4,255"}}]},{$:{mainkey:"30001",subkey:"14"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xffc9edf5,0xff778d91,0xffb5d5dc,0xffa1bec4,255"}}]}, {$:{mainkey:"30001",subkey:"15"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xfff4c4ba,0xff8f726d,0xffdbb0a7,0xffc39d95,255"}}]},{$:{mainkey:"30001",subkey:"16"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xffdbe8b3,0xff7f8768,0xffc5d0a1,0xffafba8f,255"}}]},{$:{mainkey:"30001",subkey:"17"},StyleItem:[{$:{level:"15,16,17,18,19,20",desc:"99,0xfff5cedc,0xff917a82,0xffdcb9c6,0xffc4a5b0,255"}}]}]};V.Uu=new c;d=null})();(function(){function b(b){function d(b,c,d){b=b.subarray(c,d);c=0;d="";var e=0;for(c=e=0;c<b.length;)e=b[c],0===e>>>7?(e=String.fromCharCode(b[c]),0!=e.charCodeAt(0).toString(16)&&(d+=e),c+=1):252===(e&252)?(e=(b[c]&3)<<30,e|=(b[c+1]&63)<<24,e|=(b[c+2]&63)<<18,e|=(b[c+3]&63)<<12,e|=(b[c+4]&63)<<6,e|=b[c+5]&63,d+=String.fromCharCode(e),c+=6):248===(e&248)?(e=(b[c]&7)<<24,e|=(b[c+1]&63)<<18,e|=(b[c+2]&63)<<12,e|=(b[c+3]&63)<<6,e|=b[c+4]&63,d+=String.fromCharCode(e),c+=5):240===(e&240)?(e=(b[c]&15)<< 18,e|=(b[c+1]&63)<<12,e|=(b[c+2]&63)<<6,e|=b[c+3]&63,d+=String.fromCharCode(e),c+=4):224===(e&224)?(e=(b[c]&31)<<12,e|=(b[c+1]&63)<<6,e|=b[c+2]&63,d+=String.fromCharCode(e),c+=3):192===(e&192)?(e=(b[c]&63)<<6,e|=b[c+1]&63,d+=String.fromCharCode(e),c+=2):(e=String.fromCharCode(b[c]),0!=e.charCodeAt(0).toString(16)&&(d+=e),c+=1);return d.trim()}function e(b,c){b=b.toString(2);c=c.toString(2);b=Array(32-b.length+1).join("0")+b;c=Array(32-c.length+1).join("0")+c;var d=l;d.lastIndex=0;if(d=(c+b).toString().match(d)){var e= 0;-1==d[0].indexOf(".")&&(e=parseInt(d,2));return e=e.toString(36).toUpperCase()}return"error"}function g(b){for(var c,g,h,l,t,w={},u={},D=new Uint8Array(b),v=new DataView(b),s=0,s=s+4,s=s+4,O=v.getInt32(s,!0),s=s+4,s=s+4,J=v.getInt32(s,!0),s=s+(4+J),s=s+4,E=v.getUint32(s,!0).toString(2),C=v.getUint32(s+4,!0).toString(2),T=e(E,C),s=s+8,P=d(D,s,s+64),s=s+64,R=d(D,s,s+64),s=s+64,G=v.getInt8(s,!0),s=s+1,x=d(D,s,s+8),s=s+8,z=v.getInt16(s,!0),I=v.getInt16(s+2,!0),s=s+4,F=v.getFloat32(s,!0),A=v.getFloat32(s+ 4,!0),s=s+8,B=v.getFloat32(s,!0),H=v.getFloat32(s+4,!0),s=s+8,N=v.getFloat32(s,!0),K=v.getFloat32(s+4,!0),s=s+8,M=v.getInt32(s,!0),s=s+4,L=v.getInt32(s,!0),s=s+4,S=v.getInt32(s,!0),s=s+4,X=[],Q=0;Q<M;Q++)X.push(v.getInt32(s,!0)),s+=4;for(var U=[],Q=0;Q<S;Q++)U.push(v.getInt32(s,!0)),s+=4;for(var W=[],Q=0;Q<M;Q++){var ga=d(D,s,s+48);W.push(ga);s+=48}for(var ba=[],Q=0;Q<M;Q++){var za=d(D,s,s+8);ba.push(za);s+=8}for(var na=[],Q=0;Q<L;Q++){var ha=v.getInt32(s,!0)*k+A,ra=v.getInt32(s+4,!0)*k+F;na.push([ha, ra]);s+=8}c={type:"Feature",geometry:{type:"Polygon",coordinates:[na]},properties:{pid:T,name_cn:P,name_en:R,default_floor:G,buildingtype:x,building_poi_style:[z,I],centerPoint:[A,F],left_bottom_Point:[B,H],width:N,height:K,numberofFloor:M,numberofGeoPoints:L,park_floor_count:S,floor_indexs:X,park_floors:U,floor_names:W,floor_nonas:ba}};for(var $b=0;$b<O;$b++){var Zc=d(D,s,s+8),s=s+8,Ea=v.getInt8(s,!0),s=s+1;u[Ea]={floor:{},shops:[],pubs:[],cons:[]};for(var $c=v.getInt16(s,!0),ad=v.getInt16(s+2,!0), s=s+4,bd=v.getInt16(s,!0),cd=v.getInt16(s+2,!0),s=s+4,dd=v.getInt16(s,!0),ed=v.getInt16(s+2,!0),s=s+4,ac=v.getInt32(s,!0),s=s+4,bc=v.getInt32(s,!0),s=s+4,cc=v.getInt32(s,!0),s=s+4,sb=v.getInt32(s,!0),s=s+4,tb=[],Ia=0;Ia<sb;Ia++){for(var fd=v.getInt32(s,!0),s=s+4,dc=[],da=0;da<fd;da++)ha=v.getInt32(s,!0)*k+A,ra=v.getInt32(s+4,!0)*k+F,dc.push([ha,ra]),s+=8;tb.push(dc)}var ec="Polygon",fc=tb[0];1<sb&&(ec="MultiPolygon",fc=tb);g={type:"Feature",geometry:{type:ec,coordinates:[fc]},properties:{namecode:Zc, index:Ea,floor_region_type:[$c,ad],unhighlighted_floor_line_style:[bd,cd],highlighted_floor_line_style:[dd,ed],numberofShopCount:ac,numberofPubCount:bc,numberofConCount:cc,floor_area_count:sb}};u[Ea].floor=g;for(var gc=[],ta=0,ta=0;ta<ac;ta++){for(var gd=d(D,s,s+128),s=s+128,hd=v.getUint32(s,!0).toString(2),id=v.getUint32(s+4,!0).toString(2),jd=e(hd,id),s=s+8,kd=d(D,s,s+24),s=s+24,ld=d(D,s,s+12),s=s+12,md=v.getInt32(s,!0),s=s+4,nd=v.getFloat32(s,!0),s=s+4,od=v.getInt8(s,!0),s=s+1,pd=v.getInt16(s, !0),qd=v.getInt16(s+2,!0),s=s+4,rd=v.getInt16(s,!0),sd=v.getInt16(s+2,!0),s=s+4,td=v.getInt32(s,!0)*k+A,ud=v.getInt32(s+4,!0)*k+F,s=s+8,hc=v.getInt32(s,!0),s=s+4,ic=[],Ia=0;Ia<hc;Ia++)ha=v.getInt32(s,!0)*k+A,ra=v.getInt32(s+4,!0)*k+F,ic.push([ha,ra]),s+=8;h={type:"Feature",geometry:{type:"Polygon",coordinates:[ic]},properties:{name:gd,pid:jd,cpid:kd,logo:ld,area:md,rank:nd,height:od,poitype:[pd,qd],regiontype:[rd,sd],font_anthor_point:[td,ud],shop_point_number:hc}};gc.push(h)}u[Ea].wu=gc;for(var jc= [],ta=ta=0;ta<bc;ta++){var vd=d(D,s,s+24),s=s+24,wd=v.getUint32(s,!0).toString(2),xd=v.getUint32(s+4,!0).toString(2),yd=e(wd,xd),s=s+8,zd=d(D,s,s+48),s=s+48,Ad=v.getFloat32(s,!0),s=s+4,Bd=v.getInt16(s,!0),Cd=v.getInt16(s+2,!0),s=s+4,ha=v.getInt32(s,!0)*k+A,ra=v.getInt32(s+4,!0)*k+F,s=s+8;t={type:"Feature",geometry:{type:"Point",coordinates:[ha,ra]},properties:{cpid:vd,pid:yd,name:zd,rank:Ad,poitype:[Bd,Cd]}};jc.push(t)}u[Ea].bu=jc;for(var kc=[],ta=0;ta<cc;ta++){var Dd=d(D,s,s+24),s=s+24,Ed=v.getUint32(s, !0).toString(2),Fd=v.getUint32(s+4,!0).toString(2),Gd=e(Ed,Fd),s=s+8,Hd=d(D,s,s+48),s=s+48,Id=v.getFloat32(s,!0),s=s+4,Jd=v.getInt16(s,!0),Kd=v.getInt16(s+2,!0),s=s+4,ha=v.getInt32(s,!0)*k+A,ra=v.getInt32(s+4,!0)*k+F,s=s+8;l={type:"Feature",geometry:{type:"Point",coordinates:[ha,ra]},properties:{cpid:Dd,pid:Gd,name:Hd,rank:Id,poitype:[Jd,Kd]}};kc.push(l)}u[Ea].Xs=kc}for(var s=s+4,Ld=v.getInt32(s,!0),s=s+(4+Ld),Md=v.getInt32(s,!0),s=s+4,lc=[],Q=0;Q<Md;Q++)ha=v.getInt32(s,!0)*k+A,ra=v.getInt32(s+4, !0)*k+F,lc.push([ha,ra]),s+=8;c.properties.outside_outline=lc;var Ja={},ia;for(ia in u){Ja.floor=u[ia].floor;for(da=0;da<u[ia].wu.length;da++){var Nd=v.getInt16(s,!0),s=s+2,Od=v.getInt16(s,!0),s=s+2;u[ia].wu[da].properties.zoom_min=Nd;u[ia].wu[da].properties.zoom_max=Od}Ja.shops=u[ia].wu;for(da=0;da<u[ia].bu.length;da++){var Pd=v.getInt16(s,!0),s=s+2,Qd=v.getInt16(s,!0),s=s+2;u[ia].bu[da].properties.zoom_min=Pd;u[ia].bu[da].properties.zoom_max=Qd}Ja.pubs=u[ia].bu;for(da=0;da<u[ia].Xs.length;da++){var Rd= v.getInt16(s,!0),s=s+2,Sd=v.getInt16(s,!0),s=s+2;u[ia].Xs[da].properties.zoom_min=Rd;u[ia].Xs[da].properties.zoom_max=Sd}Ja.cons=u[ia].Xs;w.floor=Ja}var s=s+4,Td=v.getInt32(s,!0),s=s+(4+Td),Ud=v.getInt8(s,!0),s=s+1;c.properties.f3=Ud;w.building=c;return w}var h=h||{};h.ni=function(){this.Bj=0};h.ni.prototype.create=function(b){this.om&&this.Bj===b||(this.om=[]);this.Bj=b;this.qs=this.Ne=0};h.ni.prototype.flush=function(){var b=this.Ne-this.qs;if(0!==b){for(;b--;)this.yj.J1(this.om[this.qs++]);this.Ne>= this.Bj&&(this.Ne=0);this.qs=this.Ne}};h.ni.prototype.gu=function(){this.flush();this.yj=null};h.ni.prototype.lB=function(b){this.gu();this.yj=b};h.ni.prototype.ad=function(b){b||(this.Ne=this.qs=0)};h.ni.prototype.dW=function(b,c){var d=this.Ne-b-1;for(0>d&&(d+=this.Bj);c--;)d>=this.Bj&&(d=0),this.om[this.Ne++]=this.om[d++],this.Ne>=this.Bj&&this.flush()};h.ni.prototype.h_=function(b){this.om[this.Ne++]=b;this.Ne>=this.Bj&&this.flush()};h.ni.prototype.AI=function(b){b=this.Ne-b-1;0>b&&(b+=this.Bj); return this.om[b]};h.km=function(){};h.km.prototype.lB=function(b){this.yj=b};h.km.prototype.gu=function(){this.yj=null};h.km.prototype.ad=function(){var b=5;this.jf=0;for(this.Vd=-1;b--;)this.jf=this.jf<<8|this.yj.ge()};h.km.prototype.oW=function(b){for(var c=0,d;b--;)this.Vd>>>=1,d=this.jf-this.Vd>>>31,this.jf-=this.Vd&d-1,c=c<<1|1-d,0===(this.Vd&4278190080)&&(this.jf=this.jf<<8|this.yj.ge(),this.Vd<<=8);return c};h.km.prototype.of=function(b,c){var d=b[c],e=(this.Vd>>>11)*d;if((this.jf^2147483648)< (e^2147483648))return this.Vd=e,b[c]+=2048-d>>>5,0===(this.Vd&4278190080)&&(this.jf=this.jf<<8|this.yj.ge(),this.Vd<<=8),0;this.Vd-=e;this.jf-=e;b[c]-=d>>>5;0===(this.Vd&4278190080)&&(this.jf=this.jf<<8|this.yj.ge(),this.Vd<<=8);return 1};h.Wh=function(b,c){for(;c--;)b[c]=1024};h.tg=function(b){this.Tw=[];this.Xr=b};h.tg.prototype.ad=function(){h.Wh(this.Tw,1<<this.Xr)};h.tg.prototype.nf=function(b){for(var c=1,d=this.Xr;d--;)c=c<<1|b.of(this.Tw,c);return c-(1<<this.Xr)};h.tg.prototype.Q_=function(b){for(var c= 1,d=0,e=0,g;e<this.Xr;++e)g=b.of(this.Tw,c),c=c<<1|g,d|=g<<e;return d};h.R_=function(b,c,d,e){for(var g=1,h=0,k=0,l;k<e;++k)l=d.of(b,c+g),g=g<<1|l,h|=l<<k;return h};h.no=function(){this.Hv=[];this.Pw=[];this.Sw=[];this.nE=new h.tg(8);this.Xo=0};h.no.prototype.create=function(b){for(;this.Xo<b;++this.Xo)this.Pw[this.Xo]=new h.tg(3),this.Sw[this.Xo]=new h.tg(3)};h.no.prototype.ad=function(){var b=this.Xo;for(h.Wh(this.Hv,2);b--;)this.Pw[b].ad(),this.Sw[b].ad();this.nE.ad()};h.no.prototype.nf=function(b, c){return 0===b.of(this.Hv,0)?this.Pw[c].nf(b):0===b.of(this.Hv,1)?8+this.Sw[c].nf(b):16+this.nE.nf(b)};h.$q=function(){this.zr=[]};h.$q.prototype.ad=function(){h.Wh(this.zr,768)};h.$q.prototype.qW=function(b){var c=1;do c=c<<1|b.of(this.zr,c);while(256>c);return c&255};h.$q.prototype.rW=function(b,c){var d=1,e,g;do if(e=c>>7&1,c<<=1,g=b.of(this.zr,(1+e<<8)+d),d=d<<1|g,e!==g){for(;256>d;)d=d<<1|b.of(this.zr,d);break}while(256>d);return d&255};h.dr=function(){};h.dr.prototype.create=function(b,c){var d; if(!this.tr||this.Yo!==c||this.$w!==b)for(this.$w=b,this.cT=(1<<b)-1,this.Yo=c,this.tr=[],d=1<<this.Yo+this.$w;d--;)this.tr[d]=new h.$q};h.dr.prototype.ad=function(){for(var b=1<<this.Yo+this.$w;b--;)this.tr[b].ad()};h.dr.prototype.AX=function(b,c){return this.tr[((b&this.cT)<<this.Yo)+((c&255)>>>8-this.Yo)]};h.fm=function(){this.Bi=new h.ni;this.Wd=new h.km;this.FE=[];this.JE=[];this.KE=[];this.LE=[];this.ME=[];this.IE=[];this.Im=[];this.VF=[];this.UF=new h.tg(4);this.Gw=new h.no;this.Ax=new h.no; this.Kw=new h.dr;this.Xv=this.Wv=-1;this.Im[0]=new h.tg(6);this.Im[1]=new h.tg(6);this.Im[2]=new h.tg(6);this.Im[3]=new h.tg(6)};h.fm.prototype.h0=function(b){if(0>b)return!1;this.Wv!==b&&(this.Wv=b,this.Xv=Math.max(this.Wv,1),this.Bi.create(Math.max(this.Xv,4096)));return!0};h.fm.prototype.k0=function(b,c,d){var e=1<<d;if(8<b||4<c||4<d)return!1;this.Kw.create(c,b);this.Gw.create(e);this.Ax.create(e);this.dT=e-1;return!0};h.fm.prototype.ad=function(){var b=4;this.Bi.ad(!1);h.Wh(this.FE,192);h.Wh(this.IE, 192);h.Wh(this.JE,12);h.Wh(this.KE,12);h.Wh(this.LE,12);h.Wh(this.ME,12);h.Wh(this.VF,114);for(this.Kw.ad();b--;)this.Im[b].ad();this.Gw.ad();this.Ax.ad();this.UF.ad();this.Wd.ad()};h.fm.prototype.nf=function(b,c,d){var e=0,g=0,k=0,l=0,u=0,D=0,v=0;this.Wd.lB(b);this.Bi.lB(c);for(this.ad();0>d||D<d;)if(b=D&this.dT,0===this.Wd.of(this.FE,(e<<4)+b))v=this.Kw.AX(D++,v),v=7<=e?v.rW(this.Wd,this.Bi.AI(g)):v.qW(this.Wd),this.Bi.h_(v),e=4>e?0:e-(10>e?3:6);else{if(1===this.Wd.of(this.JE,e))v=0,0===this.Wd.of(this.KE, e)?0===this.Wd.of(this.IE,(e<<4)+b)&&(e=7>e?9:11,v=1):(0===this.Wd.of(this.LE,e)?c=k:(0===this.Wd.of(this.ME,e)?c=l:(c=u,u=l),l=k),k=g,g=c),0===v&&(v=2+this.Ax.nf(this.Wd,b),e=7>e?8:11);else if(u=l,l=k,k=g,v=2+this.Gw.nf(this.Wd,b),e=7>e?7:10,b=this.Im[5>=v?v-2:3].nf(this.Wd),4<=b)if(c=(b>>1)-1,g=(2|b&1)<<c,14>b)g+=h.R_(this.VF,g-b-1,this.Wd,c);else{if(g+=this.Wd.oW(c-4)<<4,g+=this.UF.Q_(this.Wd),0>g){if(-1===g)break;return!1}}else g=b;if(g>=D||g>=this.Xv)return!1;this.Bi.dW(g,v);D+=v;v=this.Bi.AI(0)}this.Bi.flush(); this.Bi.gu();this.Wd.gu();return!0};h.fm.prototype.g0=function(b){var c,d;if(5>b.size)return!1;c=b.ge();d=c%9;c=~~(c/9);if(!this.k0(d,c%5,~~(c/5)))return!1;c=b.ge();c|=b.ge()<<8;c|=b.ge()<<16;c+=16777216*b.ge();return this.h0(c)};h.sW=function(b,c){var d=new h.fm,e;if(!d.g0(b))throw"Incorrect stream properties";e=b.ge();e|=b.ge()<<8;e|=b.ge()<<16;e+=16777216*b.ge();b.ge();b.ge();b.ge();b.ge();if(!d.nf(b,c,e))throw"Error in data stream";};var k=1E-9,l=RegExp("^[+\\\\-]?[0-1]*[.]?[0-1]*$","gi");b.getUnifyJson= function(b){var c=[];if(!b instanceof ArrayBuffer){var e={status:3,building:{},floor:{},id:""};c.push(e);return c}new Uint8Array(b);b=new DataView(b);var k;k=4;var l=b.getInt16(k,!1);for(k+=2;0<l;){k+=4;var t=b.getUint8(k,!1);k+=1;for(var w=new ArrayBuffer(t),w=new Uint8Array(w),u=0;u<t;u++)w[u]=b.getUint8(k,!1),k+=1;t=d(w,0,t);k+=2;w=b.getInt8(k,!1);k+=1;0!=w&&(e={},e.status=w,e.building={},e.floor={},e.id=t,c.push(e));var D=b.getInt32(k,!1);k+=4;u=b.getInt32(k,!0);k+=4;D-=u;if(0!=u){for(var e=u% 8,v=new ArrayBuffer(8*Math.ceil(u/8)),s=new Int32Array(v),O=0;8<=u;){var J=b.getInt32(k,!0),E=b.getInt32(k+4,!0),J=J^2078870821,E=E^292664;s[O]=J;s[O+1]=E;O+=2;k+=8;u-=8}0!=u&&(J=b.getInt32(k,!0),E=b.getInt32(k+4,!0),J^=2078870821,E^=292664,s[O]=J,s[O+1]=E,k+=u);O=new Uint8Array(v);E=O.length;v=E-8+e;s=new Uint8Array(v);for(u=0;u<v;u++)s[u]=O[u];for(u=0;u<e;u++)s[v-e+u]=O[E-1-u];e={data:[],offset:0,J1:function(b){this.data[this.offset++]=b}};h.sW({data:s,offset:0,ge:function(){return this.data[this.offset++]}}, e);e=e.data;v=e.length;s=new ArrayBuffer(v);O=new Int8Array(s);for(u=0;u<v;u++)O[u]=e[u];e=g(s);e.status=w;e.id=t;c.push(e)}k+=D;l-=1}return c}}V.hC={ZS:b};b(V.hC)})();(function(){var b=V.hC,c=new V.hv(function(c){var e;(e=c?c.getUnifyJson:b.getUnifyJson)||console.error("getUnifyJson not found!!");return{aY:function(b,c){setTimeout(function(){try{var d=e(b);c(null,d)}catch(l){c(l.message||l.toString())}},0)}}},{hostWorker:V.ut,clientId:"indoor",lazy:!0,batchSend:!1,libPolyfills:[b.ZS]});window.Z4=c;V.iC={Ym:function(){return c.Ym()},WU:function(b){c.Gs([b]);return c.aY.apply(c,arguments)}}})();V.UM=V.W.extend({B:function(b){this.Qb(b.map)},Qb:function(b){if(this.map=b)this.gl=15,this.Ip=this.map.get("resolution",this.gl)},du:function(b){return this.NZ(b)},NZ:function(b){b=this.WZ(b);var c=[],d;if(b instanceof V.Rd)c=[b];else if(b instanceof V.ba.tk)d=new V.Rd,d.hB(b),c=[d];else if(this.isArray(b))for(var e,g,h=0,k=b.length;h<k;h+=1)if(e=b[h],g=g||e instanceof V.ba.tk)d=new V.Rd({zIndex:1,map:this.map,va:e,style:null}),d.name=e.Pg+"-"+V.g.Ab(d),c[h]=d;else{c=b;break}return c},WZ:function(b){if("FeatureCollection"=== b.type){var c=b.features,d=c.length,e;b=Array(d);for(e=0;e<d;e+=1)b[e]=this.KA(c[e])}else b="Feature"===b.type?this.KA(b):"GeometryCollection"===b.type?this.Y4(b):this.KA({type:"Feature",va:b}).va;return b},KA:function(b){var c=b.geometry,d=null,e=new V.Rd({zIndex:1,map:this.map});b.id&&(e.id=b.id);if(c){var g=c.type;switch(g){case "Point":d=this.TZ(c);e.Or=!0;e.set("radius",2,!0);e.set("center",d.Df,!0);e.set("strokeWeight",0,!0);e.P("resolution",this.map);break;case "LineString":d=this.QZ(c);break; case "Polygon":d=this.UZ(c);break;case "MultiPoint":d=this.a5(c);break;case "MultiLineString":d=this.RZ(c);break;case "MultiPolygon":d=this.SZ(c);break;default:throw Error("Bad geometry type: "+g);}d&&(d.Pg=g.toLowerCase(),e.name=d.Pg+"-"+V.g.Ab(e));e.Lb=b.properties;e.hB(d)}return e},Ju:function(b){b[0][0]||console.log(b);var c=b.length,d,e=[];d=this.map.Ub(new V.O(b[0][0],b[0][1]),this.gl,this.Ip);for(var g=d.x,h=d.y,k=d.x,l=d.y,m=0;m<c;m+=1)d=this.map.Ub(new V.O(b[m][0],b[m][1]),this.gl,this.Ip), e[m]=[d.x,d.y],e[m][0]<g&&(g=e[m][0]),e[m][0]>k&&(k=e[m][0]),e[m][1]<h&&(h=e[m][1]),e[m][1]>l&&(l=e[m][1]);e.nd=[g,h,k,l];return e},UZ:function(b){var c=[];b=b.coordinates;for(var d=0;d<b.length;d+=1)c[d]=this.Ju(b[d]);return new V.ba.Xc(c)},TZ:function(b){b=b.coordinates;b=new V.O(b[0],b[1]);var c=this.map.Ub(b,this.gl,this.Ip),c=new V.ba.oe([c.x,c.y]);c.Df=b;return c},SZ:function(b){b=b.coordinates;for(var c=b.length,d=[],e=0;e<c;e+=1){d[e]=[];for(var g=0;g<b[e].length;g+=1)d[e][g]=this.Ju(b[e][g])}return new V.ba.oo(d)}, QZ:function(b){b=this.Ju(b.coordinates);return new V.ba.uk(b)},RZ:function(b){for(var c=b.coordinates.length,d=[],e=0;e<c;e+=1)d[e]=this.Ju(b.coordinates[e]);return new V.ba.fr(d)},isArray:function(b){return V.g.isArray(b)}});(function(){var b={cons:{name:"",rank:0.20000000298023224,zoom_max:20,zoom_min:18},pubs:{name:"",rank:0.5,zoom_max:20,zoom_min:18},shops:{name:"",pid:"0",logo:"",area:1,rank:0.10000000149011612,height:0,shop_point_number:5,zoom_max:20,zoom_min:18}},c;for(c in b)b.hasOwnProperty(c)&&(b[c].ui=c);var d={poitype:{},regiontype:{}},e=V.im.lA;V.VM={WV:function(c,h,k){h={yk:h,zP:k};for(var l in c)if(c.hasOwnProperty(l)){k=c[l];var m=V.extend(e(h),b[l]);V.g.isArray(k)||(k=[k]);for(var n=0,p=k.length;n<p;n++){var q= k[n],r=k[n].properties,t=e(m),w=void 0;for(w in r)r.hasOwnProperty(w)&&r[w]!==t[w]&&(t[w]=r[w]);r=void 0;for(r in d)d.hasOwnProperty(r)&&t[r]&&(w=t[r].join("-"),d[r][w]||(d[r][w]=[].concat(t[r])),t[r]=d[r][w]);q.properties=t}}return c}}})();V.Tu=V.W.extend({oa:[V.ca],ve:{loaded:20,Dc:10,empty:0,VV:-10,M_:-20},wV:{pubs:"public",cons:"connection",shops:"shop"},Kh:-9999,B:function(b){this.da=b;this.kl=new V.XM({size:V.j.size,SL:0.7,oI:2,RL:300});this.kl.e("drop",function(){});this.eP=V.iC;this.RD=new V.UM({map:b});this.Pe=V.Uu},Qb:function(b){this.da=b;this.RD.Qb(b)},forEach:function(){return this.kl.forEach.apply(this.kl,arguments)},k3:function(){this.kl.clear()},PY:function(b){for(var c=0,d=b.length;c<d;c++)this.Zz(b[c])},cz:function(b, c){c=c||b.Fb||b.Kh;var d=this.Oi(b,c,!0),e=null;d?e=d.r:b.wH&&(e=b.wH.r);return e?new V.Td(e):null},Nz:function(b){return b.Dj&&b.Dj>=this.ve.loaded},wJ:function(b,c){return this.YD(b,c)>=this.ve.loaded},LV:function(b,c,d){var e=c||b.Fb;if(e&&e!==this.Kh){e=""+e;c=b.Ps;for(var g=[b.ra,b.pl,b.kn,b.sl],h=[b.pt,b.Xy,b.xn],k=[],l=0,m=c.length;l<m;l++){var n=c[l],p=b.kn[n];p<this.ve.loaded&&p>=this.ve.empty||k.push(""+n)}this.zD(g,function(b){b=""+b;return 0<=k.indexOf(""+b)&&b!==e});this.zD(h,function(b){var c= b.split("_"),c=c[0];return 0<=k.indexOf(c)&&0!==b.indexOf(e+"_"+(d?d:""))})}},zD:function(b,c){for(var d=0,e=b.length;d<e;d++)this.hP(b[d],c)},hP:function(b,c){var d=[],e;for(e in b)b.hasOwnProperty(e)&&d.push(e);e=0;for(var g=d.length;e<g;e++)c.call(this,d[e])&&delete b[d[e]]},YD:function(b,c){return b.kn[c||b.Fb||b.Kh]||this.ve.empty},Oz:function(b,c){return this.Nz(b)&&this.wJ(b,c)},rD:function(b){for(var c=[],d=0,e=b.length;d<e;d++){var g=b[d];V.g.isArray(g)&&(g=new V.K(g[0],g[1]));c.push(this.da.Se(g))}return c}, MP:function(b){b=b.va;if(!b||!b.TI)return null;b=b.df;for(var c=[],d=0,e=b.length;d<e;d++)c.push(this.rD(b[d].Ga));return c},oX:function(b){b=this.de(b);if(!b)return null;b=b.Cj;if(!b)return null;b=b.Lb;return b.name||b.name_cn},nX:function(b){return(b=this.de(b))?this.$y(b):null},$y:function(b,c){if(!b)return null;if(!b.or){var d=b.Cj;if(!d)return null;var d=d.Lb,e=V.im.lA(this.FP(b));b.or=V.extend(e,{id:d.pid,name:d.name||d.name_cn,lnglat:b.Xz,floor_details:{floor_indexs:d.floor_indexs,floor_nonas:d.floor_nonas, floor_names:d.floor_names}})}V.extend(b.or,{floor:b.Fb});c&&c.floorPath&&(d=(d=this.Oi(b,b.Fb,!0))&&d.Oh?this.MP(d.Oh):null,V.extend(b.or,{floorPath:d}));return b.or},XX:function(b,c,d){b=this.Oi(b,c,!0);if(!b)return null;b=b.ra;c=null;for(var e=0,g=b.length;e<g;e++)if(b[e].Lb.cpid===d){c=b[e];break}return this.ty(c)},FP:function(b){var c=this;return{getAllShops:function(d){var e=c.Oi(b,d||b.Fb,!0);d=[];if(!e)return d;for(var e=e.ra,g=0,h=e.length;g<h;g++)e[g].Lb.cpid&&d.push(c.ty(e[g]));return d}}}, dQ:function(b){var c=this;return{setCustomStyle:function(d,e){e=V.extend({autoRefresh:!0},e);b.Qv=d?c.Pe.tH(d):null;e.autoRefresh&&c.l("featureStyleUpdate",{F:b});return this},getCustomStyle:function(){return c.Pe.ot(b.Qv)},setCustomLabelStyle:function(d,e){e=V.extend({autoRefresh:!0},e);b.Pv=d?c.Pe.tH(d):null;e.autoRefresh&&c.l("featureLabelStyleUpdate",{F:b});return this},getCustomLabelStyle:function(){return c.Pe.ot(b.Pv)},setOptions:function(d,e){e=V.extend({autoRefresh:!0,replace:!0},e);b.rm= e.replace?d:V.extend({},b.rm,d);e.autoRefresh&&c.l("featureOptionsUpdate",{F:b});return this},disableIconRender:function(){this.setOptions({disableIconRender:!0},{replace:!1})},enableIconRender:function(){this.setOptions({disableIconRender:!1},{replace:!1})},disableLabelRender:function(){this.setOptions({disableLabelRender:!0},{replace:!1})},enableLabelRender:function(){this.setOptions({disableLabelRender:!1},{replace:!1})},getOptions:function(){return b.rm}}},ty:function(b){if(!b)return null;if(!b.yG){var c= b.Lb,d=c.font_anthor_point?new V.O(c.font_anthor_point[0],c.font_anthor_point[1]):null,e=c.yk;d||(d=V.r.Ye(b.va.dc()),d=this.da.Se(new V.K(d[0],d[1])));var g=V.im.lA(this.dQ(b));b.yG=V.extend(g,{id:c.cpid,poiId:c.pid,building_id:e,name:c.name||c.name_cn,lnglat:d,category:this.wV[c.ui]})}return b.yG},Oi:function(b,c,d){if(!this.Oz(b))return null;c=c||b.Fb;var e=null;b.ra?e=b.ra[c]:b.ra={};if(!e&&d){d=b.sl[c];if(!d)return console.warn("Missing geojson of floor",c,b),null;e=b.ra[c]=this.qO(b,c,d);b.sl[c]= -1}return e},FA:function(b){for(var c=[Infinity,Infinity,-Infinity,-Infinity],d=0,e=b.length;d<e;d++){var g=b[d].va;g&&V.r.extend(c,g.dc())}return{ra:b,r:c,ac:[c[0],c[1]]}},qO:function(b,c,d){c=this.FA(this.YC(d));d=c.ra;"floor"===d[0].Lb.ui&&(c.Oh=d[0],c.ra=d.slice(1));b.r?V.r.extend(b.r,c.r):b.r=c.r;return c},tP:function(b){var c=b.Lb,d=1,e=b.name.split("-"),e=e[0];switch(e){case "point":if(c.poitype&&this.Pe.AJ(c.poitype)){b.DN=1;return}break;case "polygon":break;case "multipolygon":break;default:console.warn("Unknown geoType", e)}switch(c.ui){case "building":break;case "floor":d=2;break;case "shops":d=3;break;case "pubs":case "cons":d=3;break;default:console.warn("Unknown category",c.ui)}b.zIndex=d},YC:function(b){b=this.RD.du(b);for(var c=0,d=b.length;c<d;c++)b[c].Bg=c,this.tP(b[c]),b[c].DN&&(b.splice(c,1),c--,d--);b.sort(function(b,c){var d=b.zIndex-c.zIndex;if(0!==d)return d;d=(b.Lb.rank||0)-(c.Lb.rank||0);return 0!==d?d:b.Bg-c.Bg});return b},qQ:function(b){for(var c=[],d=0,e=b.length;d<e;d++)c.push(this.rQ(b[d]));return c}, sO:function(b){var c=[],d=b.floor.floor;b.building.properties.ui="building";d.properties.ui="floor";c.push(d);b=b.floor;for(var d=["shops","pubs","cons"],e=0,g=d.length;e<g;e++)for(var h=b[d[e]],k=0,l=h.length;k<l;k++)c.push(h[k]);return{type:"FeatureCollection",features:c}},cQ:function(b){switch(b){case 2:return Error("Building not found!");default:return Error("Server error")}},rQ:function(b){var c=b.id,d=this.de(c);if(!d)return console.warn("Can not find: ",c),{error:Error("Can not find: "+c), result:d};if(0!==b.status)return{error:this.cQ(b.status),result:d};var e=b.floor.floor.properties.index;d.Kh||(d.Fb=d.Kh=e);d.pL=null;b.floor=V.VM.WV(b.floor,c,e);d.sl||(d.sl={});if(!d.Cj&&b.building){c=b.building;c.properties.ui="building";var g=this.YC(c);d.wH=this.FA(g);d.Cj=g[0];d.Ps=c.properties.floor_indexs}b.floor&&(d.kn[e]>=this.ve.loaded?console.warn("Floor alreay load!",e,d):(d.sl[e]=this.sO(b,d),d.kn[e]=this.ve.loaded));b=d.Cj;if(!b)return console.log("Missing building geojson",d.sl),d.Dj= this.ve.VV,d;b=b.Lb;d.Xz||(d.Xz=new V.O(b.centerPoint[0],b.centerPoint[1]));d.Dj=this.ve.loaded;return{error:null,result:d}},gT:function(b,c){c&&(b.Gg||(b.Gg=[]),b.Gg.push(c))},Zz:function(b,c,d){d=d||{};"string"===typeof b&&(b={id:b});var e=this.de(b);e?e!==b&&V.extend(e,b):(e=V.extend({Dj:this.ve.empty,kn:{}},b),this.ST(e));var g=this.Hr(e);if(this.Oz(e,g))return c&&setTimeout(function(){c(null,e)},0),!1;g=parseInt(g,10);if(isNaN(g))c&&c(Error("Floor should be an integer!"));else if(e.Ps&&0>e.Ps.indexOf(g))c&& c(Error("Floor out of range, try these: "+e.Ps));else{var h=this;b=!1;this.gT(e,function(b,e){g===h.Kh&&(g=h.Hr(e));b||h.Oz(e,g)?c&&c(b,e):g===h.Hr(e)?d.Y_?c&&c(Error("Floor request failed!"),null):h.Zz(e,c,V.extend({},d,{Y_:!0})):c&&c(Error("Requested floor expired!"),null)});e.Dj<this.ve.Dc?(e.Dj=this.ve.Dc,b=!0):e.Dj===this.ve.Dc?b=!1:this.YD(e,g)<this.ve.Dc&&(e.kn[g]=this.ve.Dc,b=!0);b&&this.TN([e])}},de:function(b){if(0===b)return null;if(!b)return console.warn("Empty building!"),null;var c= b.id;c||"string"!==typeof b||(c=b);return this.kl.get(c)},q_:function(b){this.kl.cm(b)},ST:function(b){return this.kl.set(b.id,b)},Hr:function(b){return b.pL||b.Fb||b.Kh||this.Kh},TN:function(b){V.g.isArray(b)||(b=[b]);if(this.Mm)for(var c=this.Mm,d=0,e=b.length;d<e;d++){for(var g=b[d],h=!1,k=0,l=c.length;k<l;k++)g.id===c[k].id&&(h=!0,c[k]=g);h||c.push(g)}else this.Mm=[],this.Mm.push.apply(this.Mm,b);if(!this.dG){var m=this;this.dG=setTimeout(function(){m.dG=null;m.kR(m.Mm);m.Mm.length=0},0)}},Rv:function(b, c){b&&c&&(c.Dj=this.ve.M_,c.Yw=V.g.Pi()+3E3);if(c&&c.Gg){var d=c.Gg;c.Gg=null;for(var e=0,g=d.length;e<g;e++)d[e](b,c)}this.l(b?"loaded_error":"loaded",{error:b,data:c})},aQ:function(b){var c=V.k.gc+"/v3/indoor/indoormaps?",d=[];d.push("poiid="+b.id);d.push("floor="+b.floor);d.push("version="+b.version);d.push("s=rsv3");d.push("key="+V.k.key);d.push.apply(d,["from=indoorH5Map","servicetype=unify","platform=JS","logversion=2.0","sdkversion="+V.k.Yx,"appname="+V.k.al]);return c+d.join("&")},QT:function(b){function c(c, d){c?g(c):V.g.isArray(d)?b.K0(e.qQ(d)):g(Error("Indoor parser not return an array"))}this.eP.Ym();var d=this.aQ(b),e=this,g=b.iI;setTimeout(function(){V.Tu.$_(d,c,b.iI)},0)},GT:function(b){if(b&&b.length){for(var c=[],d=[],e=[],g=[],h=this,k,l=function(b){console.warn&&console.warn("\\u5ba4\\u5185\\u6570\\u636e\\u52a0\\u8f7d\\u89e3\\u6790\\u5931\\u8d25",b);for(var c=0,d=e.length;c<d;c++)h.Rv(b,e[c])},m=0,n=b.length;m<n;m++){k=b[m].data;if(k.Yw)if(V.g.Pi()<k.Yw){h.Rv(Error("Holding errored request!"),k);continue}else k.Yw= null;g.push(0);c.push(b[m].id);d.push(b[m].floor);e.push(k)}c.length&&this.QT({version:g.join(";"),id:c.join(";"),floor:d.join(";"),iI:l,K0:function(b){for(var c=0,d=b.length;c<d;c++){var e=b[c];h.Rv(e.error,e.result)}}})}},kR:function(b){V.g.isArray(b)||(b=[b]);if(b.length){for(var c=[],d={},e=0,g=b.length;e<g;e++){var h=b[e];"string"===typeof h&&(h=this.de(h));var h={data:h,id:h.id,floor:this.Hr(h)},k=h.id+"_"+h.floor;d[k]?console.warn("Param duplicate",k):(d[k]=!0,c.push(h))}this.GT(c)}}}); V.extend(V.Tu,{$_:function(b,c,d){var e=this.ET;e||(this.ET=e={});e[b]||(e[b]={Zm:[]});var g=e[b].Zm;g.push({succ:c,err:d});if(!e[b].a0){e[b].a0=!0;var h=new XMLHttpRequest,k=function(c,d){for(var h=0,k=g.length;h<k;h++)g[h][c]&&g[h][c].apply(this,d);e[b]=null;delete e[b]},l=function(){k("err",arguments)},m=function(b){V.iC.WU(b,function(b,c){k("succ",[b,c])})};h.onreadystatechange=function(){4===h.readyState&&(200!==h.status?l(Error("Status code not 200: "+h.status+"_"+h.statusText)):m(this.response))}; h.onerror=l;h.open("GET",b,!0);h.responseType="arraybuffer";h.send()}}});V.mi=V.V.kd.extend({B:function(b,c){V.mi.qe.B.apply(this,arguments);this.Qo=!0;this.ro=new V.Ea.fj(new Ac,c);this.ro.Zb.set("bubble",!0)},T3:function(){return this.ro},Fs:function(b){V.mi.qe.Fs.apply(this,arguments);b.wj=this.ro},Ih:function(b){this.zb||(this.zb=!0,this.Ua.l("complete"));return new V.mi.rC(this,b)}});V.mi.UB=Fc.extend({B:function(){V.mi.UB.qe.B.apply(this,arguments);this.Qo=!0},Nf:function(b){return new V.mi(this,b)},Ee:function(){}}); V.mi.rC=V.J.Af.extend({B:function(){V.mi.rC.qe.B.apply(this,arguments)},he:function(b){b=this.la=b.la;this.zoom=b.zoom;this.N=b.N},qf:function(){return[]}});V.kC=V.J.canvas.kd.extend({oa:[V.ca],B:function(){V.kC.qe.B.apply(this,arguments)},x_:function(b){var c={},d=[],e,g,h;e=0;for(g=b.length;e<g;e++){var k=b[e];h=k.name.split("-")[0];k.style&&(k.style.Qg?"polygon"!==h&&"multipolygon"!==h?console.warn("Not polygon"):(c[k.zIndex]||(c[k.zIndex]={zIndex:k.zIndex,aM:{}},d.push(c[k.zIndex])),h=c[k.zIndex].aM,h[k.style.Qg]||(h[k.style.Qg]=[]),h[k.style.Qg].push(k)):console.warn("Style missing uid",k))}d.sort(function(b,c){return b.zIndex-c.zIndex});e=0;for(g= d.length;e<g;e++){h=d[e].aM;for(var l in h)h.hasOwnProperty(l)&&this.AT(h[l])}},BO:function(b,c){for(var d=null,e=0,g=c.length;e<g;e+=1){var h=this.Ib(c[e]),h=[Math.round(h[0])+0.5,Math.round(h[1])+0.5];0<e?b.lineTo(h[0],h[1]):(d=h,b.moveTo(h[0],h[1]))}d&&b.lineTo(d[0],d[1])},AO:function(b,c){for(var d=0,e=c.length;d<e;d+=1)this.BO(b,c[d].Ga)},zO:function(b,c){for(var d=0,e=c.length;d<e;d+=1)this.AO(b,c[d].df)},AT:function(b,c){c||(c=b[0].style);var d=this.La,e=c.strokeColor,g=c.strokeWeight,h=c.strokeOpacity, k=c.fillColor,l=c.fillOpacity,m=c.strokeStyle,n=c.strokeDasharray,p,q;d.save();e&&(d.strokeStyle=e,g&&(d.lineWidth=g),d.lineCap="butt",d.lineJoin=c.lineJoin||"miter");k&&(d.fillStyle=k);d.beginPath();for(var g=0,r=b.length;g<r;g++){q=b[g].va;if(q instanceof V.ba.Xc||q.TI)q=[q];else if(q instanceof V.ba.oo||q.CI)q=q.Id;else{console.warn("Unknown geometry",q);continue}this.zO(d,q)}d.closePath();k&&(l!==p&&(p=d.globalAlpha=l),d.fill());e&&(h!==p&&(d.globalAlpha=h),"dashed"===m&&d.setLineDash&&d.setLineDash(n), d.stroke());d.restore()},iu:function(b){return this.x_(b)}});V.WM=V.W.extend({oa:[V.ca],B:function(b,c){this.da=b;this.Ra=c;this.FQ=V.g.bind(this.Fk,this);this.Pe=V.Uu;this.gl=15;this.Ip=this.da.get("resolution",this.gl);this.KL(1);this.n1=!0;this.GL();this.IL();this.Yv=!1},KL:function(b){this.Xd=b;this.Fi=Math.log(this.Xd)/Math.log(2)},GL:function(b){this.GQ=b||new V.K(0,0)},IL:function(b){this.OE=b||new V.K(0,0)},i0:function(b){this.Yv=b},e4:function(){return this.Xd},iR:function(b){return this.da.Ub(b,this.gl,this.Ip)},Fk:function(){},ks:function(b){b.canvas= b.canvas||b.sa;this.mb&&this.mb.ta===b.canvas||(this.mb=new V.kC(b.canvas,this.FQ));!1!==b.Fd?V.f.gi(this.mb.ta,b.width,b.height,!0):b.width!==b.canvas.width?console.warn("width not match"):b.height!==b.canvas.height&&console.warn("height not match");this.mb.ac=b.ac;this.mb.zc=b.N||this.da.get("view").getResolution(b.zoom)},Kv:function(b,c,d,e){e=V.extend({split:!0,qB:!0,margin:{x:0,y:0}},e);d=d||b.Fb;this.e_(b,d,c,e);if(!b.pl)return null;var g=b.pl[d];if(!g)return null;var g=g.RB[c],h=this.Ra.Oi(b, d,!0);if(!h)return null;d=g.labels;var k=g.td;k<g.total&&(d=d.slice(0,g.td));if(!d||!d.length)return null;var l=e.r||h.r,h=e.ac||h.ac,m=e.N||this.da.get("view").getResolution(c),n=e.margin,p=Math.ceil((l[2]-l[0])/m)+2*n.x,l=Math.ceil((l[3]-l[1])/m)+2*n.y,h=[h[0]-n.x*m,h[1]-n.y*m];c={Ql:new V.Bf,zoom:c,N:m,ac:h,width:p,height:l};e.canvas&&(c.sa=e.canvas);c=this.Lx(c,{split:e.split,jn:e.split?50:0,mt:e.split?50:0});l=0;for(h=c.length;l<h;l++){var q;e.Pj&&V.g.isArray(e.Pj)&&e.Pj[l]&&(c[l].sa=e.Pj[l].sa, V.f.gi(c[l].sa,c[l].width,c[l].height,!0));c[l].sa?(q=c[l].sa,!0===e.Fd&&V.f.gi(q,c[l].width,c[l].height,!0)):this.Mo||(q=this.wr(),V.f.gi(q,c[l].width,c[l].height,!0),c[l].sa=q);m=q?q.getContext("2d"):null;this.xT(d,V.extend({},c[l],{cq:!e.jA,canvas:q,xe:m}));k<g.total?V.extend(c[l],{status:0,td:k,total:g.total}):(c[l].status=1,c[l].Ql=null)}e.jA&&(b.pl=null);return c},GD:function(b,c,d){d=V.extend({},d);var e=b.Lb;return"label"===d.$l&&(!(20===e.zoom_max&&20<c-this.Fi)&&e.zoom_max&&c-this.Fi>e.zoom_max|| e.zoom_min&&c-this.Fi<e.zoom_min)?!1:this.tu(b,c,d)?!0:!1},fw:function(b,c,d){if(b.filter)return b.filter(c,d);for(var e=[],g=0,h=b.length;g<h;g++)!1!==c.call(d,b[g],g)&&e.push(b[g]);return e},uP:function(b,c){if(!b)return b;var d=this.fw(b,function(b){return this.GD(b.F,c,{$l:"label"})?(b=b.F.Md)&&(b.fontSize||b.be)?!0:!1:!1},this);return d.length===b.length?b:d},HD:function(b,c){if(!b)return b;var d=this.fw(b,function(b){return 0>b.name.indexOf("polygon")||!this.GD(b,c,{$l:"polygon"})||!b.style? !1:!0},this);return d.length===b.length?b:d},sD:function(b,c,d,e){e=V.extend({split:!0,margin:{x:10,y:10}},e);var g=e.r||b.r,h=e.ac||b.ac,k=e.N||this.da.get("view").getResolution(d),l=e.margin,m=Math.ceil((g[2]-g[0])/k)+2*l.x,g=Math.ceil((g[3]-g[1])/k)+2*l.y,h=[h[0]-l.x*k,h[1]-l.y*k];d=this.Lx({zoom:d,N:k,ac:h,width:m,height:g},{split:e.split});h=0;for(k=d.length;h<k;h++)d[h].sa=e.canvas||this.wr(),this.ks(V.extend({},d[h],{canvas:d[h].sa,Fd:e.Fd})),this.mb.iu(c||b.ra);return d},ZO:function(b,c,d){var e= this.Ra.FA(b);return e?this.sD(e,b,c,d):null},uD:function(b,c,d,e){d=d||b.Fb;b=this.Ra.Oi(b,d,!0);return b&&b.Oh?(d=this.HD([b.Oh],c))&&d.length?this.sD(b,d,c,e):null:null},Lx:function(b,c){c=V.extend({jn:0,mt:0,maxWidth:c.split?V.j.U?512:1536:9999999,maxHeight:c.split?V.j.U?512:1536:9999999},c);for(var d=c.maxHeight,e=b.width,g=b.height,h=b.N,k=b.ac,l=Math.ceil(e/c.maxWidth),m=Math.round(e/l),d=Math.ceil(g/d),n=Math.round(g/d),p=[],q=0;q<l;q++)for(var r=0;r<d;r++){var t=q*m,w=Math.min(e,(q+1)*m), u=r*n,D=Math.min(g,(r+1)*n),v=[k[0]+t*h,k[1]+u*h],s=[k[0]+w*h,k[1]+D*h];p.push(V.extend({},b,{width:w-t+2*c.jn,height:D-u+2*c.mt,ac:[v[0]-c.jn*h,v[1]-c.mt*h],md:new V.Td([v[0]-c.jn*h,v[1]-c.mt*h,s[0]+c.jn*h,s[1]+c.jn*h])}))}return p},sP:function(b,c){return this.fw(b,function(b){b.qD||(b.qD=new V.Td(b.va.dc()));return c.md.Ld(b.qD)?!0:!1})},tD:function(b,c,d,e){d=d||b.Fb;var g=this.Ra.Oi(b,d,!0);if(!g)return null;var h=this.HD(g.ra,c);if(!h||!h.length)return null;this.l("willRenderFloorPolygonFeatures", {zoom:c,floor:d,Z2:b,ra:h});e=V.extend({split:!0,qB:!0,margin:{x:10,y:10}},e);d=e.r||g.r;var g=e.ac||g.ac,k=e.N||this.da.get("view").getResolution(c),l=e.margin,m=Math.ceil((d[2]-d[0])/k)+2*l.x;d=Math.ceil((d[3]-d[1])/k)+2*l.y;g=[g[0]-l.x*k,g[1]-l.y*k];c={zoom:c,N:k,ac:g,width:m,height:d};e.canvas&&(c.sa=e.canvas);c=this.Lx(c,{split:e.split});d=0;for(g=c.length;d<g;d++)k=this.sP(h,c[d]),k.length&&(V.extend(c[d],{status:0,ra:k,td:0,total:k.length}),e.Pj&&V.g.isArray(e.Pj)&&e.Pj[d]&&(c[d].sa=e.Pj[d].sa, V.f.gi(c[d].sa,c[d].width,c[d].height,!0)),e.qB||!c[d].sa?this.hU(c[d],b,c[d].total+1):(this.ks(V.extend({},c[d],{Fd:e.Fd})),this.mb.iu(k)));return c},AP:function(b){b.Ai&&(b=b.Ai);var c=b.ra.slice(0,b.td);this.jD(b);b.sa=this.wr();this.ks({Fd:!0,canvas:b.sa,width:b.width,height:b.height,zoom:b.zoom,ac:b.ac,N:b.N});this.mb.iu(c);return b.sa},jD:function(b){b.td>=b.total&&(b.status=1,b.ra=null)},OP:function(){this.MD||(this.MD=V.g.bind(this.AP,this));return this.MD},hU:function(b,c,d){d||(d=V.j.U? 300:1E3);c=b.td;d=Math.min(c+d,b.total);var e=b.ra;c>=d||!e?b.status=1:(b.td=d,b.sa?"function"!==typeof b.sa&&(this.ks(V.extend({},b,{Fd:!1})),this.mb.iu(e.slice(c,d)),this.jD(b)):b.sa=this.OP(),c=!0,b.td<b.total?(b.xi||(b.xi=0),b.td-b.xi<b.total/5&&(c=!1)):b.status=1,c&&!0!==b.mK&&b.xi!==b.td&&(b.xi=b.td,this.l("render",{type:"floor"})))},Gr:function(b,c){return b+"_"+c},SI:function(b,c){if(!b)return null;if(b.zoom===c)return b;V.g.isArray(b)||(b=[b]);for(var d=[],e=0,g=b.length;e<g;e++)d.push(V.extend({}, b[e],{Ai:b[e],width:Math.round(b[e].width*Math.pow(2,c-b[e].zoom)),height:Math.round(b[e].height*Math.pow(2,c-b[e].zoom))}));return d},yP:function(b,c,d){if(!d)return null;b=b.Fb;c=Math.round(c);var e=c-2,g,h;for(g=c;20>=g;g++)if(h=this.Gr(b,g),d[h])return d[h];for(g=c;g>=e;g--)if(h=this.Gr(b,g),d[h])return d[h];return null},wr:function(){this.xv||(this.xv=1);var b=document.createElement("canvas");b.id="amap_indoor_c_"+this.xv;this.xv++;return b},Lv:function(b,c){var d=this.wr();this.wE=d;d.width= Math.max(300,b);d.height=Math.max(300,c);d.yr={x:0,y:0,kg:0};return d},zR:function(b,c,d){b=b.yr;b.x+=c;b.kg=Math.max(b.kg,d)},xP:function(b,c){var d=this.wE;d||(d=this.Lv(b,c));for(var e=d.yr,e=[{x:e.x,y:e.y,kg:Math.max(e.kg,c)},{x:0,y:e.y+e.kg,kg:c}],g=0,h=e.length;g<h;g++){var k=e[g];if(k.x+b<d.width&&k.y+c<d.height)return V.extend(d.yr,k),d}return this.Lv(b,c)},LO:function(b,c){var d=this.xE;this.xE||(d=this.xE=(this.wE||this.Lv(100,12)).getContext("2d"));var e=this.tG(d,c);return[Math.ceil(d.measureText(b).width)+ 1,e.fontSize+3]},tG:function(b,c){var d=c.fontSize*this.Xd,e=c.strokeColor,g=c.fillColor;b.lineWidth=2;b.font="400 "+d+\'px "Microsoft YaHei"\';b.textBaseline="bottom";b.textAlign="start";b.strokeStyle=e;b.fillStyle=g;return{fontSize:d}},ZQ:function(b){var c=[b.width,b.height],d=b.style,e=b.text,g=[3,3],g=[c[0]+g[0],c[1]+g[1]],h=this.xP(g[0],g[1]);if(!h)return console.error("No canvas got!"),null;var k=h.getContext("2d"),l=h.yr;this.tG(k,d);k.textBaseline="bottom";d.strokeColor&&k.strokeText(e,l.x, l.y+c[1],c[0]);d.fillColor&&k.fillText(e,l.x,l.y+c[1],c[0]);V.extend(b,{x:l.x,y:l.y,style:null,text:null});b.sa=h;this.zR(h,g[0],g[1]);return h},UP:function(){this.NE||(this.NE=V.g.bind(this.ZQ,this));return this.NE},aP:function(b,c){if(!c.fontSize)return{sa:null,width:0,height:0};var d=this.LO(b,c),d={style:c,text:b,width:d[0],height:d[1],BA:d[0],AA:d[1]};d.sa=this.UP();return d},$O:function(b,c){c=c||b.Fb;var d=this.Ra.Oi(b,c,!0);if(!d)return null;var e=[],g=[];b.Cj&&(e.push(b.Cj),d.Oh&&(b.Cj.Gv= V.r.Ye(d.Oh.va.dc())));d.Oh&&e.push(d.Oh);e.push.apply(e,d.ra);for(var d=0,h=e.length;d<h;d++){var k=e[d],l=k.Lb,m=k.va.dc();if(!l.poitype||!this.Pe.AJ(l.poitype)){if(!k.Gv&&l.font_anthor_point){var n=this.iR(l.font_anthor_point);k.Gv=[n.x,n.y]}l.rank||l.building_poi_style&&(l.rank=10);g.push({coords:k.Gv||V.r.Ye(m),wq:l.rank||0,F:k,Lb:k.Lb})}}g.sort(function(b,c){var d=c.wq-b.wq;if(0!==d)return d;var d=b.F.Md,e=c.F.Md,g=0,h=0;d&&e&&(d.be&&(g=1),e.be&&(h=1));return h-g});return{RB:{},labels:g}},iU:function(b, c,d,e){e||(e=V.j.U?300:1E3);c=b.RB[d];var g=c.td;e=Math.min(g+e,c.total);var h=c.labels;if(g>=e||!h)c.status=1;else{for(;g<e;g++){var k=h[g].F;if(!h[g].Xq)h[g].Xq=k.D2={};else if(h[g].Xq[d])continue;this.tu(k,d,{$l:"label"});var l=k.Lb.name||k.Lb.name_cn,m=k.Md;if(m){l=this.aP.call(this,l,m);k=m.yn||[d];m.be&&(l.be=m.be);for(var m=0,n=k.length;m<n;m++)h[g].Xq[parseInt(k[m],10)+this.Fi]=l}else console.warn("No style",h[g])}c.td=e;d=!0;c.td<c.total?(c.xi||(c.xi=0),c.td-c.xi<c.total/5&&(d=!1)):c.status= 1;d&&!0!==b.mK&&c.xi!==c.td&&(c.xi=c.td,this.l("render",{type:"label"}))}},vO:function(b,c){var d=b.RB,e=d[c];e||(e=this.uP(b.labels,c),e=d[c]={total:e.length,labels:e,status:0,td:0});e.td===e.total&&(e.status=1)},e_:function(b,c,d){if(c=c||b.Fb){b.pl||(b.pl={});var e=b.pl;e[c]||(e[c]=this.$O(b,c));this.vO(e[c],d);this.iU(V.extend({},e[c],{mK:!0}),b,d,999999999);return e[c]}},Ho:function(b,c,d,e){var g=b.Fb;if(!g)return null;var h=Math.round(c)+this.Fi,g=e.ln?e.ln.call(this,g,h):null,k=e.fq,l=g&& k?k[g]:null;(!l||l.mv)&&d&&(l=e.Jp.call(this,b,h,l?{Pj:l}:null))&&(l.mv&&(l.mv=null),g&&(k[g]=l));return l?h===c?l:this.SI(l,c):e.rI?(b=this.yP(b,c,k),this.SI(b,c)):null},MX:function(b,c,d){c=c.zoom;b.xn||(b.xn={});return this.Ho(b,c,d,{fq:b.xn,ln:this.Gr,Jp:function(b,c,d){return this.Kv(b,c,b.Fb,d)}})},jz:function(){var b;this.kj&&(b=this.kj.Sr);return b||0},NX:function(b,c){this.DQ();var d=Math.round(c.zoom)+this.Fi;b.xn||(b.xn={});this.Kv(b,d,b.Fb);d=this.pT();if(0<this.jz())return[];if(c.ma){for(var e= [],g=0,h=d.length;g<h;g++){var k=d[g].Ga;k&&c.ma.contains(new V.K(k[0],k[1]))&&e.push(d[g])}d=e}return d},JX:function(b,c,d){c=c.zoom;b.Xy||(b.Xy={});return this.Ho(b,c,d,{rI:!0,fq:b.Xy,ln:function(c,d){return c+"_"+d+(b.os?"_sel":"")},Jp:function(b,c){return this.uD(b,c,b.Fb)}})},lI:function(b,c){if(b){c=V.extend({Gp:!0},c);var d=[b.pt];c.Gp&&(d.push(b.xn),b.pl=null);for(var e=0,g=d.length;e<g;e++){var h=d[e];if(h)for(var k in h)h.hasOwnProperty(k)&&(h[k].mv=!0)}}},IX:function(b,c,d){c=c.zoom;b.pt|| (b.pt={});return(b=this.Ho(b,c,d,{rI:!0,fq:b.pt,ln:this.Gr,Jp:function(b,c,d){return this.tD(b,c,b.Fb,d)}}))?b:null},HX:function(b,c,d,e){return this.Ho(b,c.zoom,!0,{fq:{},ln:null,Jp:function(b,c){return this.ZO(e.ra,c,V.extend({jA:!0,split:!1,canvas:e.canvas},e.G))}})},cw:function(b,c,d,e){var g=c.ma,h=g.$a,k=g.Wb;return this.Ho(b,c.zoom,!0,{fq:{},ln:null,Jp:function(b,c){return e.Gz.call(this,b,c,b.Fb,V.extend({jA:!0,margin:{x:0,y:0},split:!1,canvas:d,r:[h.x,h.y,k.x,k.y],ac:[h.x,h.y],qB:!1},e.G))}})}, MW:function(b,c,d,e){return this.cw(b,c,d,{Gz:this.Kv,G:e})},KW:function(b,c,d,e){return this.cw(b,c,d,{Gz:this.uD,G:e})},JW:function(b,c,d,e){return this.cw(b,c,d,{Gz:this.tD,G:e})},gw:function(b,c,d,e,g,h,k){d*=g;e*=g;g=k.call(this,{wM:d,kg:e,vt:d/2,nn:e/2,N:g});k=0;for(var l=g.length;k<l;k++){var m=[c[0]+g[k][0],c[1]+g[k][1]],m=[m[0],m[1],m[0]+d,m[1]+e];if(!h||(!b||b.contains(new V.Td(m)))&&!h.search(m).length)return m}return null},$P:function(b,c,d){var e=Math.ceil((b[0]-c[0])/d);c=Math.ceil((b[1]- c[1])/d);var g=Math.round((b[2]-b[0])/d);b=Math.round((b[3]-b[1])/d);return{width:g,height:b,x:e,y:c}},DQ:function(){this.Mo=!0;this.vw=[]},pT:function(){this.Mo=!1;var b=this.vw;this.vw=null;return b},uO:function(b,c,d){c=b.Lb;if(!c)return console.warn(b),null;var e=c.name||c.name_cn,g=c.pid,h=b.coords,k=[];b.Sz&&k.push({source:b,md:b.Sz});b.Ez&&k.push({AY:!0,source:b.yt?b.yt:b,md:b.Ez});b=[];for(var l=[],m=0,n=k.length;m<n;m++){var p=k[m].source;b.push(p.sa||p.rY);p=[Math.round((k[m].md[0]-h[0])/ d),Math.round((k[m].md[1]-h[1])/d),p.width,p.height,p.x||0,p.y||0,p.BA||p.width,p.AA||p.height];k[m].AY&&(p.DE=!0);l.push(p)}return{Ga:h,name:e,sq:g,s3:c.cpid,wa:b,kb:l}},aw:function(b,c,d,e,g,h,k){if(this.Mo){if(d.sa){"function"===typeof d.sa&&(d.sa(d.Ai||d,{md:e,N:g,ac:h}),d.Ai&&(d=V.extend({},d,d.Ai)));var l=this.uO(d,e,g);l&&this.vw.push(l)}}else{l=this.$P(e,h,g);if(d.sa){"function"===typeof d.sa&&(d.sa(d.Ai||d,{md:e,N:g,ac:h,rg:l,canvas:b}),d.Ai&&(d=V.extend({},d,d.Ai)));if(d.sa){var m=!0;if(k){var n= new V.Td(0,0,b.width,b.height),p=new V.Td(l.x,l.y,l.x+d.width,l.y+d.height);n.contains(p)||(m=!1)}m&&c.drawImage(d.sa,d.x||0,d.y||0,d.BA||d.width,d.AA||d.height,l.x,l.y,d.width,d.height)}return l}if(d.Gg){var q=this,l=d.Gg,r=Array.prototype.slice.call(arguments,0);r.push(1);l.push(function(b,c){b||(V.extend(r[1],c),q.aw.apply(this,r))})}}},tm:function(b,c,d){return[b[0]-c[0]*d,b[1]-c[1]*d,b[2]+c[0]*d,b[3]+c[1]*d]},t2:function(b){b=this.Ra.rD([[b[0],b[1]],[b[2],b[1]],[b[2],b[3]],[b[0],b[3]]]);var c= new AMap.Polygon({map:this.da,path:b,fillColor:"rgba(0,0,0,0.3)",strokeColor:"",ib:1});this.da.e("zoomstart",function(){c.Qb(null)});return c},BT:function(b,c){if(b.F.Md){var d=b.F.Md.nD,e=b.coords,g=this.dz(b.F,"labelSizeOffset")||this.OE,h=Math.max(0<b.width?1:0,b.width+g.Sc()),k=Math.max(0<b.height?1:0,b.height+g.xc()),g=h-b.width,l=k-b.height,e=this.gw(c.cq?c.md:null,e,h,k,c.N,d?c.Ql:null,function(b){return[[-b.vt,-b.nn],[0,-b.nn],[-b.wM,-b.nn]]});if(!e)return!1;d&&c.md.Ld(new V.Td(e))&&c.Ql.zt(this.tm(e, [1,1],c.N),b);e=this.tm(e,[g/2*-1,l/2*-1],c.N);b.Sz=e;this.aw(c.canvas,c.xe,b,e,c.N,c.ac,c.cq);return!0}},wT:function(b,c){var d=b.yt;if(!d)return!1;if(b.F.Md){var e=b.F.Md.nD,g=b.coords,h=this.dz(b.F,"iconSizeOffset")||this.GQ,k=Math.max(0<d.width?1:0,d.width+h.Sc()),l=Math.max(0<d.height?1:0,d.height+h.xc()),h=k-d.width,m=l-d.height,n=this.gw(c.cq?c.md:null,g,k,l,c.N,e?c.Ql:null,function(b){return[[-b.vt,-b.nn]]});if(!n)return!1;var p=this.dz(b.F,"labelSizeOffset")||this.OE,q=Math.max(0<b.width? 1:0,b.width+p.Sc()),r=Math.max(0<b.height?1:0,b.height+p.xc()),p=q-b.width,t=r-b.height,w=null;0<q*r&&(w=this.gw(c.cq?c.md:null,g,q,r,c.N,e?c.Ql:null,function(b){return[[-b.vt,(0+l/2)*b.N],[(0+k/2)*b.N,-b.nn],[-b.wM-(0+k/2)*b.N,-b.nn],[-b.vt,-b.kg-(0+l/2)*b.N]]}));g=[];n&&(e&&c.md.Ld(new V.Td(n))&&c.Ql.zt(this.tm(n,[0,0],c.N),d),n=this.tm(n,[h/2*-1,m/2*-1],c.N),b.Ez=n,d.Lb=b.Lb,d.Ez=n,d.coords=b.coords,d.DE=!0,this.Mo&&w||g.push([d,n]));w&&(e&&c.md.Ld(new V.Td(w))&&c.Ql.zt(this.tm(w,[0,0],c.N),b), w=this.tm(w,[p/2*-1,t/2*-1],c.N),b.Sz=w,g.push([b,w]));this.Mo&&1<g.length&&console.warn("More than one image with _imageRenderingHolded");d=0;for(e=g.length;d<e;d++)this.aw(c.canvas,c.xe,g[d][0],g[d][1],c.N,c.ac,c.cq)}},aE:function(b){return V.k.nb+"/images/indoor_icon/"+(1<this.Xd?"36/"+b+"@2x":"18/"+b)+".png"},kP:function(b,c){var d=this.aE(b),e=document.createElement("img");e.crossOrigin="Anonymous";e.onload=function(){e.loaded=!0;c(null,this);e.onload=e.onerror=null};e.onerror=function(b){c(b, this);e.onload=e.onerror=null};e.src=d},SP:function(b){this.kj||(this.kj={Sr:0});var c=this.kj[b];if(!c){var c=this.kj[b]={status:1,be:b,width:18*this.Xd,height:18*this.Xd,rY:this.aE(b),Gg:[]},d=this;this.kj.Sr++;this.kP(b,function(b,g){d.kj.Sr--;if(!b&&(c.sa=g,c.BA=g.width,c.AA=g.height,c.Gg)){var h=c.Gg;c.Gg=null;for(var k=0,l=h.length;k<l;k++)h[k].call(d,null,c)}d.kj.Sr||d.l("render",{type:"icon"})})}return c},xT:function(b,c){if(b.length)for(var d=0,e=b.length;d<e;d++)if(b[d].Xq){var g=b[d].Xq[c.zoom]; if(g){!this.Yv&&g.be&&(g.yt=this.SP(g.be));var h=!this.Yv&&g.yt?this.wT:this.BT;b[d].RF||(b[d].RF=new V.K(b[d].coords[0],b[d].coords[1]));c.md.contains(b[d].RF)&&(b[d].F&&this.tu(b[d].F,c.zoom,{$l:"label"}),h.call(this,V.extend({Ai:g},b[d],g),c))}}},eX:function(b){if(b.rm){var c=b.rm;c.disableIconRender&&b.Md&&b.Md.be&&(b.Md=V.extend({},b.Md,{be:null}));c.disableLabelRender&&b.Md&&(b.Md=V.extend({},b.Md,{fontSize:0}))}},dz:function(b,c){return b&&b.rm?b.rm[c]:null},tu:function(b,c,d){d.$l||console.warn("triggerType not set"); V.extend({$l:"polygon"},d);c-=this.Fi;d=b.Lb;var e=d.poitype||d.building_poi_style;e&&(b.Md=this.Pe.QI(e,c));b.Pv&&(b.Md=this.Pe.dK(b.Md,b.Pv));if(d.highlighted_floor_line_style)(e=this.Ra.de(d.yk))?b.style=this.Pe.OX(e.os?d.highlighted_floor_line_style:d.unhighlighted_floor_line_style,c):console.warn("Can not load: ",d);else if(d=d.regiontype||d.floor_region_type)b.style=this.Pe.UX(d,c);b.Qv&&(b.style=this.Pe.dK(b.style,b.Qv));this.eX(b);if(!b.style&&!b.Md)return!1;1!==this.Xd&&b.style&&b.style.strokeWeight&& (b.style=this.Pe.mz(b.style),b.style.strokeWeight*=this.Xd);return!0}});V.jC=V.W.extend({oa:[V.ca,V.gd],G:{visible:!0,zooms:[18,20],floorBarContainerStyle:null,floorListContainerStyle:null},B:function(b){V.g.bb(this,b);this.h={};this.Bx();this.setOptions(this.G);this.UD()},setOptions:function(b){this.ke(b)},show:function(){this.setOptions({visible:!0})},hide:function(){this.setOptions({visible:!1})},visibleChanged:function(){var b=this.get("visible");V.f.ja(this.h.D,{display:b?"block":"none"});b&&(b=this.h.D.vh)&&this.jp(b)},floorDataChanged:function(){var b=this.get("floorData"); this.nT(b)},XQ:function(){return!!this.get("visible")},Wm:function(b,c){this.map=b;c.appendChild(this.h.D);this.Zc=c;this.Ci()},Jn:function(){this.Hi();this.Zc.removeChild(this.h.D);this.h={};this.map=this.Zc=null},Ci:function(){this.vb={};for(var b="click mouseover mouseout mousedown mouseup touchstart touchend touchcancel mousewheel".split(" "),c=0,d=b.length;c<d;c++)this.vb[b[c]]=V.event.T(this.h.D,b[c],this.nQ,this)},Fv:function(b){if(b){var c=this;setTimeout(function(){b.call(c,c.pr)},0)}},UD:function(b){if(this.pr)this.Fv(b); else{var c=function(b){b.Vr&&(clearTimeout(b.Vr),b.Vr=null);b.SE&&b.Nw&&(b.Nw.apply(this,arguments),b.SE=!1)},d={"mousewheel DOMMouseScroll":{"*":function(b,c){V.w.stopPropagation(c);var d=0;c.wheelDelta?(d=120,V.j.Kt&&(d=120===Math.abs(c.wheelDelta)?400:240),d=c.wheelDelta/d,window.opera&&9.5>parseFloat(window.opera.version())&&(d=-d)):c.detail&&(d=-c.detail);this.wR(d)}},mousedown:{"floor-nav":function(b){b.Mw=!1;var c=arguments,d=this;b.Vr=setTimeout(function(){b.Vr=null;b.Mw=!0;b.Ow&&(b.Ow.apply(d, c),b.SE=!0)},1E3)}},mouseup:{"floor-nav":function(){c.apply(this,arguments)}},mouseover:{"floor-nav":function(b){V.f.pb(b,"hover")}},mouseout:{"floor-nav":function(b){V.f.wb(b,"hover");c.apply(this,arguments)}},click:{"floor-plus":function(b){b.Mw||this.fF(1)},"floor-minus":function(b){b.Mw||this.fF(-1)},"floor-nonas":function(b){this.BP(b.parentNode)}}};if(V.j.U&&V.j.ed){var e=this;this.Tm=!0;V.Qa.load("AMap.IndoorMapTouch",function(){e.pr=d;e.PQ();e.Fv(b)})}else this.pr=d,this.Fv(b)}},nQ:function(b){var c= b.target||b.target||b.srcElement,d=b.type;if(c){var e=[c,b];this.UD(function(b){for(var h in b)if(!(0>h.split(" ").indexOf(d))){var k=b[h],l;for(l in k)("*"===l||V.f.pn(c,l))&&k[l].apply(this,e)}})}},kw:function(b,c){var d=this.h.D.CP,e=d.indexOf(b);if(0>e)console.warn("Can not found floor: ",b,d);else if(e+=c,!(0>e||e>=d.length))return{id:e,ql:d[e]}},fF:function(b){(b=this.kw(this.h.D.vh,b))&&this.Rx(b.ql)},wR:function(b){0<b?this.Sx(null,!0):this.Tx(null,!0)},BP:function(b){b.hj!==this.h.D.vh&& this.Rx(b.hj)},Rx:function(b){this.nU("floorChanged",{ql:b,pV:this.h.D.ti})},nU:function(b,c){this.l(b,c)},Hi:function(){this.np();if(this.vb)for(var b in this.vb)this.vb.hasOwnProperty(b)&&V.event.removeListener(this.vb[b])},yO:function(){var b=document.createElement("div");b.className="floor-btn floor-nav floor-plus";b.innerHTML="+";b.Ow=function(){this.Sx()};b.Nw=function(){this.np()};return b},xO:function(){var b=document.createElement("div");b.className="floor-btn floor-nav floor-minus";b.innerHTML= "-";b.Ow=function(){this.Tx()};b.Nw=function(){this.np()};return b},y2:function(){return this.h.D.vh},x2:function(){return this.h.D.ti},Dr:function(b){var c=null;this.hw(function(d){if(d.hj===b)return c=d,!1});return c},FL:function(b,c,d){if(this.h.D.ti===b){b=this.Dr(c);if(!b)return!1;this.VN(b,!d);d&&this.jp(c)}},VN:function(b,c){if(!b)return!1;var d=this.vP(b,"amap-indrm-loader");c?d&&d.parentNode.removeChild(d):d||(d=document.createElement("div"),d.className="amap-indrm-loader",b.appendChild(d)); this.Eh(b,"with-indrm-loader",!c);this.Eh(this.h.D,"with-indrm-loader",!c);return!0},vP:function(b,c){var d=null;this.ND(b,function(b){if(V.f.pn(b,c))return d=b,!1},c);return d},ND:function(b,c,d){b=Array.prototype.slice.call(b.childNodes,0);for(var e=0,g=b.length;e<g;e++){var h=b[e];if(h&&(!d||V.f.pn(h,d))&&!1===c.call(this,h,e))break}},hw:function(b){this.ND(this.h.Rj,b,"floor-list-item")},p0:function(b,c){this.h.D.ti!==b?console.warn("building id not match"):(this.hw(function(b){this.Eh(b,"selected", b.hj===c)}),this.h.D.vh=c,this.oT(),this.jp(c))},hT:function(b){var c=b.offsetLeft,d=b.offsetTop;do if(b=b.offsetParent)c+=b.offsetLeft,d+=b.offsetTop;else break;while(1);return{left:c,top:d}},rr:function(b){if(!b.getBoundingClientRect)return this.hT(b);b=b.getBoundingClientRect();var c=document.documentElement;return{top:b.top+c.scrollTop,left:b.left+c.scrollLeft}},qr:function(b){return b.offsetHeight||b.clientHeight||0},UQ:function(b){var c=document.body;if(c.contains)return c.contains(b);for(;b;){if(b=== c)return!0;b=b.parentNode}return!1},Sx:function(b,c){if(V.f.pn(this.h.D,"can-scroll-up")){var d=this.h.D;b||(b=d.oG||d.vh);var e=this.kw(b,1);if(e&&(this.jp(e.ql),!c)){this.np();var g=this;g.zs=setTimeout(function(){g.Sx(e.ql)},170)}}},Tx:function(b,c){if(V.f.pn(this.h.D,"can-scroll-down")){var d=this.h.D;b||(b=d.oG||d.vh);var e=this.kw(b,-1);if(e&&(this.jp(e.ql),!c)){var g=this;this.np();g.zs=setTimeout(function(){g.Tx(e.ql)},170)}}},np:function(){this.zs&&(clearTimeout(this.zs),this.zs=null)},u2:function(b){return V.im.Jy(b)}, UC:function(b,c){if(!V.j.U)return V.im.iH(b,c)},dE:function(b){return this.rr(b).top-this.rr(this.h.Rj).top},cE:function(b,c){var d=this.Dr(b);if(!d)return!1;var e=this.qr(this.h.Rj),g=this.qr(this.h.Wy),h=this.qr(d),d=this.dE(d)-g/2+h/2;c=V.extend({iA:this.Tm?-h:0,fA:e-g+(this.Tm?h:0)},c);return{OY:e,hV:g,iA:c.iA,fA:c.fA,gM:d}},jp:function(b){if(this.XQ()){var c=this.Dr(b);if(!c)console.warn("Can not find floor: ",b);else if(this.UQ(c)){var c=this.h.Rj,d=this.cE(b),e=this.Tm||d.OY>d.hV;this.Eh(this.h.D, "can-scroll",e);this.h.D.oG=b;e&&(b=d.gM,e=d.iA,d=d.fA,b<e?b=e:b>d&&(b=d),e=-parseInt(c.style.marginTop,10)||0,5<Math.abs(e-b)&&(this.UC(c),c.style.marginTop=-b+"px"),e=-parseInt(c.style.marginTop,10)||0,this.Eh(this.h.D,"can-scroll-down",e<d),this.Eh(this.h.D,"can-scroll-up",0<e));this.nG()}}},nG:function(b){if(!this.Tm){arguments.length||(b=this.h.D.vh);var c=this.Dr(b);if(!c)return!1;var d=this.h.Wy,e=this.h.Rj;this.UC(this.h.fB);var g=this.rr(d).top-this.rr(this.h.D).top,c=g+this.dE(c)+(parseInt(e.style.marginTop, 10)||0);this.h.fB.style.top=c+"px";this.h.fB.style.display=c>this.qr(d)+g+5||c<g-15?"none":""}},oT:function(){var b=this.h.D,c=b.vh,d=b.qR;this.Eh(this.h.QK,"disabled",c===b.oR);this.Eh(this.h.gK,"disabled",c===d)},Eh:function(b,c,d){b&&(d?V.f.pb:V.f.wb).call(V.f,b,c)},Bx:function(){if(this.h.D){var b=this.h.D;b.innerHTML="";b.className="amap-indoormap-floorbar-control";b.ti=null}else this.h.D=V.f.create("div",null,"amap-indoormap-floorbar-control")},nT:function(b){var c=this.h.D;b?(b.id!==c.ti&& this.rO(b),c.vh=b.Fb,this.p0(c.ti,c.vh)):this.Bx()},sG:function(b,c){c?b.setAttribute("title",c):b.removeAttribute("title")},rO:function(b){this.Bx();var c=this.h.D;this.Eh(c,"is-mobile",!!V.j.U);this.Eh(c,"touch-scroll",this.Tm);var d=b.hX,e=d.iX,g=d.Yy.length,h=g>(this.Tm?Infinity:5),k=document.createDocumentFragment(),l=V.f.create("div",k,"panel-box");this.sG(c,d.name_cn);this.h.fB=V.f.create("div",l,"select-dock");h&&(this.h.QK=this.yO(),l.appendChild(this.h.QK));var m=document.createElement("ul"); m.className="floor-list";for(var n=g-1;0<=n;n--){var p=document.createElement("li");p.className="floor-list-item";p.innerHTML=\'<div class="floor-btn floor-nonas">\'+d.jX[n]+"</div>";p.hj=d.Yy[n];0===n?c.qR=p.hj:n===g-1&&(c.oR=p.hj);this.sG(p,e[n]);m.appendChild(p)}c.H2=0;c.G2=g-1;c.CP=[].concat(d.Yy);d=document.createElement("div");d.className="floor-list-box";d.appendChild(m);l.appendChild(d);h&&(this.h.gK=this.xO(),l.appendChild(this.h.gK));c.ti=b.id;c.appendChild(k);this.h.Rj=m;this.h.Wy=d;this.XN()}, XN:function(){var b={floorBarContainer:this.h.D,floorListContainer:this.h.Wy},c;for(c in b)if(b.hasOwnProperty(c)){var d=this.get(c+"Style");d&&this.YN(b[c],d)}},YN:function(b,c){if(b)for(var d in c)c.hasOwnProperty(d)&&(b.style[d]=c[d])}});var Xd=window.AMap.CustomLayer.extend({G:{visible:!0,opacity:1,zIndex:11,featureszIndex:null,zooms:[17,25],hideFloorBar:!1,bubble:"true",alwaysShow:!1,disableIconRender:!1,disableLabelRender:!1,disableHoverMarker:!1,autoLoadBuildingsInTile:!0},B:function(b){this.CLASS_NAME="AMap.IndoorMap";if(!V.j.hq)return null;this.iG=!V.j.U;this.ym=V.f.create("div");this.uE=V.f.create("div",this.ym,"floor-outline-image-con");this.Oo=V.f.create("div",this.ym,"floor-image-con");this.ww=V.f.create("div",this.ym,"highlight-image-con"); this.Nr=V.f.create("div",this.ym,"label-image-con");Xd.qe.B.call(this,this.ym,b);this.CLASS_NAME="AMap.IndoorMap";V.a.Sa(this.CLASS_NAME,b);V.f.pb(this.ym,"amap-indoor-map");this.Gf=new Z({offset:new V.K(0,0),zooms:this.get("zooms")||[3,20],content:" ",noSelect:!0,visible:!1});this.Gf.ea=!0;this.da=this.Er();this.pc=null;this.Ra=this._dataMgr=new V.Tu(this.da);this.Ra.e("loaded",this.Di,this);this.Ra.e("featureStyleUpdate",this.ZR,this);this.Ra.e("featureLabelStyleUpdate",this.XR,this);this.Ra.e("featureOptionsUpdate", this.YR,this);this.bO=1;this.lf=void 0;this.Pe=V.Uu;this.fP=this.Pe.mz({strokeColor:"rgba(224,180,135,1)",fillColor:"rgba(224,180,135,0.5)"});this.vE=!0;this.da&&this.mapChanged();this.mH=this.getRenderLabels;V.g.Ab(this)},setzIndex:function(b){Xd.qe.setzIndex.apply(this,arguments);this.zh&&this.zh.setzIndex(this.get("featureszIndex")||b)},sK:function(b){this.ux(b.xH)},yM:function(){return!!this.get("autoLoadBuildingsInTile")},showIndoorMap:function(b,c,d,e){V.a.add(this.CLASS_NAME,"showIndoorMap"); var g=this;if(this.xy()){var h=arguments[arguments.length-1],k=null;h&&"function"===typeof h&&(k=h);k===c&&(c=null);k===d&&(d=null);this.uB(b,c,function(b,c,h){if(!b){var p=(g.get("zooms")||[18,20])[0],p=Math.max(g.da.get("zoom"),p),q=c.Xz,r=null;d&&(r=g.Ra.XX(c,c.Fb,d));r&&r.lnglat&&(q=r.lnglat);e||g.da.setZoomAndCenter(p,q,!0);g.xy()&&g.Di();g.rp(c);r&&(h.shop=r)}V.event.H(g,"floor_complete",h);k&&k(b,h)},{rM:!1})}},showFloor:function(b,c){V.a.add(this.CLASS_NAME,"showFloor");if(!this.Lg)return!1; this.showIndoorMap(this.Lg,b,void 0,c)},showFloorBar:function(){V.a.add(this.CLASS_NAME,"showFloorBar");this.set("hideFloorBar",!1)},hideFloorBar:function(){V.a.add(this.CLASS_NAME,"hideFloorBar");this.set("hideFloorBar",!0)},hideFloorBarChanged:function(){this.Rk()},featureszIndexChanged:function(){this.zh&&this.zh.setzIndex(this.get("featureszIndex")||this.get("zIndex"))},visibleChanged:function(){var b=Xd.qe.visibleChanged;b&&b.apply(this,arguments);this.xx()},disableLabelRenderChanged:function(){this.Di()}, hideLabels:function(){V.a.add(this.CLASS_NAME,"hideLabels");this.set("disableLabelRender",!0)},showLabels:function(){V.a.add(this.CLASS_NAME,"showLabels");this.set("disableLabelRender",!1)},cursorChanged:function(){this.Ix(this.get("cursor"))},Ix:function(b){this.Fc&&this.Fc.ro.Zb.set("cursor",b)},getSelectedBuildingId:function(){V.a.add(this.CLASS_NAME,"getSelectedBuildingId");return this.Lg||null},getSelectedBuilding:function(b){V.a.add(this.CLASS_NAME,"getSelectedBuilding");var c=this.Lg||null; return c?(c=this.Ra.de(c))?this.Ra.$y(c,b):null:null},Ee:function(){this.AD()},ZR:function(b){this.refreshFloorStyle(b.F.Lb.yk,{Gp:!1})},XR:function(b){this.refreshFloorStyle(b.F.Lb.yk,{Gp:!0})},YR:function(b){this.refreshFloorStyle(b.F.Lb.yk,{Gp:!0})},refreshFloorStyle:function(b,c){if(this.Ra){c=V.extend({Gp:!0},c);if(b)this.cc.lI(this.Ra.de({id:b}),c);else{var d=this;this.Ra.forEach(function(b){d.cc.lI(b,c)})}this.sr();this.Di()}},iconSizeOffsetChanged:function(){this.cc&&(this.cc.GL(this.get("iconSizeOffset")), this.refreshFloorStyle())},disableIconRenderChanged:function(){this.cc&&(this.cc.i0(this.get("disableIconRender")),this.refreshFloorStyle())},labelSizeOffsetChanged:function(){this.cc&&(this.cc.IL(this.get("labelSizeOffset")),this.refreshFloorStyle())},mapChanged:function(){if(this.vE){var b=this.Er();this.pc&&this.da===b||(Xd.qe.mapChanged.apply(this,arguments),this.AD(),this.da=b,this.pc=this.GP(),this.Cg()?this.$N():!this.da||this.pc||this.UG||(this.UG=!0,this.da.e("coreMapCreated",function(){this.UG= !1;this.mapChanged()},this,!0)))}},AD:function(){this.da&&(this.da.C("mousemove",this.XE,this),this.da.C("zoomchange",this.Qw,this),this.da.C("movestart",this.ZE,this),this.da.C("mapmove",this.$E,this),this.da.C("moveend",this.YE,this),this.da.C("dragstart",this.WE,this),this.da.C("dragend",this.VE,this),this.da.C("resize",this.Di,this),this.da.C("click",this.TE,this),this.da.C("dblclick",this.UE,this));this.Ff&&(this.da&&this.da.removeControl(this.Ff),this.Ff=null);this.Fc&&(this.Fc.clear(),this.sT(), this.Fc=null);this.cc&&this.cc.C("render",this.ls,this);this.lf=!0;V.Ie&&(V.Ie.C("vecTileParsed.builds.found",this.sK,this),V.Ie.HL(!1,this.da));this.sm(null);this.Gf.setMap(null);this.Rk();this.pc=this.da=null;this.sr()},$N:function(){this.da.e("zoomchange",this.Qw,this);this.da.e("moveend",this.YE,this);this.da.e("mapmove",this.$E,this);this.da.e("movestart",this.ZE,this);this.da.e("dragstart",this.WE,this);this.da.e("dragend",this.VE,this);this.da.e("resize",this.Di,this);this.da.e("click",this.TE, this);this.da.e("dblclick",this.UE,this);this.da.e("mousemove",this.XE,this);this.Qw();this.xx();this.sv();this.Ra.Qb(this.da);this.zh=new V.mi.UB({zIndex:this.get("featureszIndex")||this.getzIndex(),map:this.da,innerLayer:!0});this.Fc=this.zh.V;V.Ie&&this.yM()&&V.Ie.e("vecTileParsed.builds.found",this.sK,this);this.cursorChanged();this.QN();this.cc=new V.WM(this.da,this.Ra);this.cc.KL(V.j.Jc?2:1);this.cc.n1=this.iG;this.cc.e("render",this.ls,this);this.Rk();this.oQ();this.disableHoverMarkerChanged(); this.iconSizeOffsetChanged();this.labelSizeOffsetChanged();this.disableIconRenderChanged()},disableHoverMarkerChanged:function(){this.Gf&&this.Gf.setMap(this.lf||this.get("disableHoverMarker")?null:this.da)},sT:function(){this.Jw(!1);var b=this.zh;setTimeout(function(){b.setMap(null)},0);this.Fc=this.zh=null},QN:function(){this.zh.setMap(this.da);this.Fc=this.zh.V;this.Jw(!0)},Jw:function(b){if(this.Fc){var c=this.Fc.ro,d=this.get("indoorEvents")||[];V.g.isArray(d)?(0>d.indexOf("click")&&d.push("click"), V.j.U||(0>d.indexOf("mouseover")&&d.push("mouseover"),0>d.indexOf("mouseout")&&d.push("mouseout"))):d=d.split(" ");b=b?c.e:c.C;for(var e=0,g=d.length;e<g;e++)b.call(c,d[e],this.jQ,this)}},Qw:function(){if(this.Cg()){var b=this.da.get("zoom");if(V.j.U){var c=this,d=b+this.cc?this.cc.Fi:0;this.Ra.forEach(function(b){c.RO(b.id,d)})}this.Fc&&this.Fc.J&&Math.floor(b)===b&&this.Fc.J.zoom!==b&&(this.Fc.J.zoom=b,this.Fc.J.N=this.da.get("resolution",b));this.Rk({kJ:!0});this.xx()}},AE:function(b,c){if(!b)return!1; "object"!==typeof b&&(b=this.Ra.de({id:b}));var d=this.nw(),e=this.Ra.cz(b);if(c&&this.da){var g=this.da.get("view").getResolution();c=c.tc(g);d=new V.Td(d.$a.add(c),d.Wb.Ja(c))}return d&&e?d.Ld(e,0):!1},RO:function(b,c){var d=this.Ra.de({id:b});this.AE(d)||this.iD(b,c)},iD:function(b,c){var d=this.Ra.de({id:b});d&&this.Ra.LV(d,void 0,c)},mG:function(){this.Gx&&clearTimeout(this.Gx);var b=this;b.Gx=setTimeout(function(){b.Gx=null;b.Po=!1},300)},$E:function(){this.Po=!0;this.mG()},ZE:function(){this.Po= !0;this.mG()},YE:function(){this.Rk({kJ:!0});this.Po=!1},aO:function(){var b=this.getVisibleBuildingIds();b&&1===b.length&&this.setSelectedBuildingId(b[0])},WE:function(){},VE:function(){},EQ:function(){this.rE=!0;var b=this;setTimeout(function(){b.rE=!1},0)},TE:function(){this.rE||(this.l("map_click"),this.gP({id:0},200))},UE:function(){this.zy()},gP:function(b,c){var d=this;this.zy();this.Br=setTimeout(function(){d.Br=null;d.rp(b)},c||300)},zy:function(){this.Br&&(clearTimeout(this.Br),this.Br= null)},xx:function(){var b=!this.Cg()||!this.get("visible");if(!b&&this.da)var b=this.da.get("zoom"),c=this.get("zooms"),b=b<c[0]||b>c[1];this.lf!==b&&(this.sr(),this.lf=b,V.Ie&&V.Ie.HL(!this.lf,this.da),this.disableHoverMarkerChanged(),this.Jw(!this.lf),this.Rk(),this.lf&&(this.sm(null),this.TG(null)),this.ls());this.sv()},setSelectedBuildingId:function(b){V.a.add(this.CLASS_NAME,"setSelectedBuildingId");this.rp({id:b})},rp:function(b){this.zy();if(this.Lg!==b.id){if(this.Lg){var c=this.Ra.de(this.Lg); c&&(c.os=!1,this.iD(c.id))}this.l("selectedBuildingIdChanged",{oldId:this.Lg,newId:b.id});this.Lg=b.id;if(b=this.Ra.de(b.id))b.os=!0;this.Di()}this.Rk()},sv:function(){if(this.da&&!V.j.U)for(var b=this.da.get("zoom"),c=[this.da],d=!this.lf&&this.ep&&0<this.ep.length,e=0,g=c.length;e<g;e++)if(c[e]){var h=c[e].get("zooms");h&&(d?20>h[1]&&(c[e].set("zooms",[h[0],20]),c[e].IK=h[1]):18<h[1]&&b<h[1]&&c[e].set("zooms",[h[0],c[e].IK||h[1]]))}},NP:function(b){if(!this.Lg)return!1;var c=this.Ra.de(this.Lg); return!c||!c.sl||b&&b.kJ&&!this.AE(c,new V.K(30,30))?!1:{id:c.id,Fb:c.Fb||c.Kh,hX:this.tO(c.Cj.Lb)}},tO:function(b){return V.extend({},b,{Yy:b.floor_indexs,jX:b.floor_nonas,iX:b.floor_names})},KQ:function(){var b=this.Ff;b&&(b.e("floorChanged",function(b){this.uB(b.pV,b.ql,function(){})},this),b.e("visible",function(){b&&this.l("floorBarVisibleChanged",{I3:b,visible:b.get("visible")})},this))},getFloorBar:function(){return this.Ff},getFeaturesLayer:function(){return this.zh},Rk:function(b){!this.Cg()|| this.get("hideFloorBar")||this.lf?this.Ff&&this.Ff.hide():(b=this.NP(b),this.Ff||(this.Ff=new V.jC(this.get(V.j.U?"floorBarOptionsForMobile":"floorBarOptions")),this.KQ(),this.da.addControl(this.Ff)),this.Ff.set("floorData",b),b?this.Ff.show():this.Ff.hide())},xS:function(b){var c=b.Vk;if(!c)return null;var d=c.Lb;if(!d)return null;var e=null;d.cpid&&(e=this.Ra.ty(c));return{building_id:d.yk,floor:d.zP,lnglat:b.af||b.lnglat,shop:e}},XE:function(b){b=b.af||b.lnglat;b&&this.PE&&b.Hb(this.PE)||(this.PE= b,this.yD(b))},yD:function(b,c){function d(){e.Sv=null;e.Vw&&b?(e.Gf.show(),e.Gf.setPosition(b)):e.Gf.hide()}this.Sv&&clearTimeout(this.Sv);this.Gf.get("visible")&&this.Gf.hide();var e=this;c?d():this.Sv=setTimeout(d,100)},sm:function(b,c,d){this.get("disableIndoorMouseoverHighlight")&&(b=null);var e=null;this.Bm=null;b&&(b.Lb?b.Lb.pid||("floor"===b.Lb.ui&&(b=this.Ra.oX(b.Lb.yk))&&(e=b),b=null):b=null);b&&!e&&(e=b.Lb.name||b.Lb.name_cn);if(e)for(var g=["\\u8f85\\u52a9\\u9762"],h=0,k=g.length;h<k;h++){if(0<= e.indexOf(g[h])){b=e=null;break}}else b=null;if(b)switch(b.Lb.ui){case "shops":this.Bm=b}this.Gf&&(e?(this.Vw!==e&&(this.Vw=e,this.Gf.setContent(\'<div class="amap-indoor-map-moverf-marker">\'+e+"</div>")),this.yD(d.af||d.lnglat,!0)):(this.Vw=null,this.Gf.hide(),this.Gf.setContent("")));this.FT(c)},FT:function(b){this.LB&&V.g.dl(this.LB);this.LB=V.g.Fe(function(){this.LB=null;this.eG(b)},this)},jQ:function(b){if(this.lf)console.warn("Layer is hidden");else{var c=this.xS(b);if(!c)this.sm(null),c=null; else if(c.building_id){b.w2=!0;b.type||(b.type=b.type);var d=c.building_id,e="click"===b.type,g="mouseover"===b.type,h="mouseout"===b.type;if(e||g)e&&this.EQ(),this.Lg!==d&&this.rp({id:c.building_id});g?(this.Ix("default"),this.sm(b.Vk,d,b,c)):h&&(this.Ix(this.get("cursor")),this.sm(null))}V.event.H(this,b.type,c||b)}},ls:function(b){this.Hx&&clearTimeout(this.Hx);var c=this;this.Hx=setTimeout(function(){c.Hx=null;c.Di()},b||100)},Nf:function(){if(!this.vE)return null;var b=Xd.qe.Nf.apply(this,arguments), c=this;setTimeout(function(){c.mapChanged()},0);return b},Er:function(){return this.get("map")},GP:function(){var b=this.Er();return b?b.map:null},v2:function(){var b=this.Er();return b?V.Ie.sI(b):null},rP:function(b,c){var d=this.da.get("view").getResolution(),e=b.Ye(),g=c.Ye(),h=this.da.get("size"),k=Math.abs(e.y-g.y)/d;return Math.abs(e.x-g.x)/d>3*h.width||k>3*h.height},SD:function(){if(this.lf||!this.Cg())return[];var b=this.nw(),c=[],d=[];b&&this.Ra.forEach(function(e,g){if(this.Ra.Nz(e)){var l= this.Ra.cz(e);l&&(b.Ld(l,0)?c.push(e.id):V.j.U&&this.rP(b,l)&&d.push(g))}},this);if(d.length)for(var e=0,g=d.length;e<g;e++)this.Ra.q_(d[e]);return c},Di:function(){this.co||(this.ju=V.g.Fe(this.PT,this),this.co=!0)},WD:function(b){return b.Kh||b.Fb||1},Cg:function(){return!(!this.da||!this.pc)},xU:function(b){if(this.Cg()){var c=this;setTimeout(function(){b.call(c)},0)}else this.fp||(this.fp=[]),this.fp.push(b)},oQ:function(){if(this.fp){var b=this.fp;this.fp=null;for(var c=0,d=b.length;c<d;c++)b[c].call(this)}}, ux:function(b){this.Cg()&&!this.lf&&(b||this.yM()&&(b=V.Ie.mX(this.da)),b&&b.length&&this.Ra.PY(b))},uB:function(b,c,d,e){e=V.extend({rM:!0},e);var g=this;if(this.Cg()){var h=!1,k=this.Ff,l=this.Ra.de(b);k&&(l&&this.Ra.wJ(l,c)||(h=!0),h&&k.FL(b,c,!0));var m=function(c,g){var h;h=c?{status:1,error:c}:{status:0,building:this.Ra.$y(g)};V.extend(h,{id:b});!1!==e.rM&&V.event.H(this,"floor_complete",h);d&&d.call(this,c,g,h)};this.Ra.Zz({id:b,pL:c},function(d,e){!d&&c&&(e.Fb=c);h&&k.FL(b,c,!1);d?m.call(g, d,e):(g.sm(null),g.Di(),g.rp(e),m.call(g,null,e))})}else{var n=Array.prototype.slice.call(arguments,0);this.xU(function(){this.uB.apply(this,n)})}},CT:function(b){return!this.Cg()||b&&b.w5&&(b=this.pc,b.Ag||b.dg||b.Hg&&this.Po)?!1:!0},PT:function(){this.pc&&this.pc.set("display",0)},xy:function(){var b=this.da;if(b){if(this.get("alwaysShow"))return!0;b.getLayers();for(var c in b.map.Ba)if(V.V.wg&&b.map.Ba[c]instanceof V.V.wg)return!0;return!1}},render:function(b){if(this.xy())if(this.ju&&V.g.dl(this.ju), this.co=!1,this.ux(),this.CT()){var c=this.jw();c.Sp=b;this.hG=this.bO++;this.uU(c.Js,c);this.tT(c.Js,c);this.TG(c.Js);this.vo(this.uE);this.vo(this.Oo);this.vo(this.ww);this.vo(this.Nr);this.sv()}else this.ls(500)},sr:function(){this.So=null},getRenderLabels:function(){if(!this.Cg()||this.get("disableLabelRender")||this.lf||0<this.cc.jz())return this.sr(),[];var b=this.jw(),c=[];if(this.So&&this.So.result.wS===this.get("opacity")&&this.So.v1===b.key)c=this.So.result;else{for(var d=b.Js,c=[],e=0, g=d.length;e<g;e++){var h=d[e];h.Fb||(h.Fb=this.WD(h));h=this.cc.NX(h,b);c.push.apply(c,h)}c&&0<c.length&&0===this.cc.jz()&&(c.wS=this.get("opacity"),this.So={v1:b.key,result:c})}c.lK=this.SD();return c},getVisibleBuildingIds:function(){V.a.add(this.CLASS_NAME,"getVisibleBuildingIds");return this.ep||[]},getBuildingInfoById:function(b){return this.Ra.nX(b)},TG:function(b){var c=[];if(b&&!this.lf)for(var d=0,e=b.length;d<e;d++)this.Ra.Nz(b[d])&&c.push(b[d].id);c.sort();b=this.ep||[];this.ep=c;V.Ie&& V.Ie.j0(c,this.da);b.join(",")!==c.join(",")&&(this.l("visibleBuildingChanged",{oldIds:b,newIds:this.ep}),this.aO())},jw:function(){for(var b=this.SD(),c=[],d=[],e=[],g=0,h=b.length;g<h;g++){var k=this.Ra.de(b[g]);k?(c.push(k),e.push(k.id),d.push(k.id+"_"+k.Fb+(k.os?"_sel":""))):console.warn("Can not find bld: ",b[g])}d.sort();this.Cg()?(b=this.nw(),g=this.da.get("zoom")):(b=new V.Td(0,0,0,0),g=0);return{Js:c,b3:e,ma:b,zoom:g,key:g+";"+b.toString()+";"+d.join(",")}},uU:function(b){var c,d,e=[];c= 0;for(d=b.length;c<d;c++)e.push(b[c].id+"_"+b[c].Fb);c=e.sort().join(";");if(this.Fc.wU!==c){this.Fc.wU=c;this.Fc.clear();var g=this;this.Fc.Ox&&V.g.uV(this.Fc.Ox);this.Fc.Ox=V.g.N_(function(){g.Fc&&(g.Fc.Ox=null,g.mT(b))})}},mT:function(b){for(var c=[],d=0,e=b.length;d<e;d++){var g=b[d];if(g=this.Ra.Oi(g,g.Fb,!0))g.Oh&&c.push(g.Oh),c.push.apply(c,g.ra)}this.Fc.Zk(c)},nw:function(){return this.da?this.da.get("coordsBound"):null},WO:function(b,c){if(0===(this.da.get("rotateEnable")?parseInt(this.da.get("rotation"), 10)%360:0))return this.da.Li(b,c);var d=this.da;b=b.Tb();var e=d.Se(b),g=d.get("center");-180>g.I-e.I?b.x-=V.g.Va:180<g.I-e.I&&(b.x+=V.g.Va);e=d.get("centerCoords");e=b.Ja(e).Gb(d.get("resolution",c));return d.get("size").Wn().Gb(2).add(new V.K(e.x*Math.cos(0)-Math.sin(0)*e.y,Math.sin(0)*e.x+Math.cos(0)*e.y))},fG:function(b,c,d){if(!b)console.warn("Empty image");else if(V.g.isArray(b))for(var e=0,g=b.length;e<g;e++)this.fG(b[e],c,d);else if(!b.md||d.u1.Ld(b.md,0)){var h=b.sa;"function"===typeof h&& (h=h(b));h&&(h.bc=this.hG,e=b.ac,e=this.WO(new V.K(e[0],e[1])),b={position:"absolute",width:Math.round(b.width)+"px",height:Math.round(b.height)+"px",left:Math.ceil(e.x)+"px",top:Math.ceil(e.y)+"px"},V.extend(h.style,b),h.parentNode!==c&&(c.appendChild(h),d.Dn&&!V.j.U&&(h.style.opacity=d.Dn,V.im.iH(h,1E3),setTimeout(function(){h.style.opacity=1},0))))}},jG:function(b,c,d){V.f.gi(b,c||b.width,d||b.height,!0)},uT:function(b,c,d){this.Wk?d.Fd&&this.jG(this.Wk):(this.Wk=document.createElement("canvas"), this.Oo.appendChild(this.Wk));this.Sm?d.Fd&&this.jG(this.Sm):(this.Sm=document.createElement("canvas"),this.Nr.appendChild(this.Sm));d=[{ol:this.cc.KW,D:this.Oo,Fy:[b,c,this.Wk,{Fd:d.Fd}]},{ol:this.cc.JW,D:this.Oo,Fy:[b,c,this.Wk,{Fd:!1}]},{disable:this.get("disableLabelRender")||c.Sp&&c.Sp.ZA,ol:this.cc.MW,D:this.Nr,Fy:[b,c,this.Sm,{Fd:d.Fd}]}];this.zx(b,c,d)},zx:function(b,c,d){for(var e=0,g=d.length;e<g;e++)if(!d[e].disable){var h=d[e].Fy||[b,c,!0];d[e].nI&&h.push.apply(h,d[e].nI);(h=d[e].ol.apply(this.cc, h))&&this.fG(h,d[e].D,{a3:b.id,Dn:d[e].Dn,u1:c.ma,zoom:c.zoom})}},eG:function(b,c){"string"===typeof b&&(b=this.Ra.de(b));c||(c=this.jw());var d=!0;b&&!this.Po&&this.Bm||(d=!1);this.Bm&&d&&(this.cc.tu(this.Bm,c.zoom+this.cc.Fi,{$l:"polygon"}),this.Bm.style||(d=!1));d?(this.oE||(this.oE=document.createElement("canvas")),d=this.get("shopHighlightCoverStyle")||this.fP,d.Qg||(d.Qg="highlight"),d=[{ol:this.cc.HX,nI:[{canvas:this.oE,ra:[V.extend(new V.Rd,this.Bm,{style:d})]}],D:this.ww,Dn:0.1}],this.zx(b, c,d)):this.vo(this.ww,-1)},vT:function(b,c){var d=[{ol:this.cc.JX,D:this.uE},{ol:this.cc.IX,D:this.Oo,Dn:0.1},{disable:this.get("disableLabelRender")||c.Sp&&c.Sp.ZA,ol:this.cc.MX,D:this.Nr,Dn:0.1}];this.zx(b,c,d);V.j.U||this.eG(b,c)},yU:function(b,c){var d=this.da.get("view").getResolution(c.zoom),e=8E5;"undefined"!==typeof screen&&screen.width&&screen.height&&(e=screen.width*screen.height*1.3);for(var g=0,h=b.length;g<h;g++){var k=this.Ra.cz(b[g]);if(k){var l=k.Be()/d,k=k.ze()/d;if(l*k>e)return!0}}return!1}, tT:function(b,c){var d=this.iG;d&&this.yU(b,c)&&(d=!1);for(var e=0,g=b.length;e<g;e++){var h=b[e];h.Fb||(h.Fb=this.WD(h));d?this.vT(h,c):this.uT(h,c,{Fd:0===e})}},vo:function(b,c){if(b){c=c||this.hG;for(var d=Array.prototype.slice.call(b.childNodes,0),e=d.length-1;0<=e;e-=1){var g=d[e];g&&g.bc!==c&&b.removeChild(g)}}}});window.AMap.IndoorMap=Xd; ')
_jsload_('AMap.ToolBar', 'V.rN=V.W.extend({oa:[V.ca],B:function(b){this.CLASS_NAME="AMap.ToolBar";V.a.Sa(this.CLASS_NAME,b);this.an(b||{});this.h={};this.h.D=V.f.create("div",null,"amap-toolbar");this.h.Ml=V.f.create("div",this.h.D,"amap-pancontrol");this.h.left=V.f.create("div",this.h.Ml,"amap-pan-left");this.h.top=V.f.create("div",this.h.Ml,"amap-pan-top");this.h.right=V.f.create("div",this.h.Ml,"amap-pan-right");this.h.bottom=V.f.create("div",this.h.Ml,"amap-pan-bottom");this.h.Ic=V.f.create("div",this.h.D,"amap-locate"); this.h.zoom=V.f.create("div",this.h.D,"amap-zoomcontrol");this.h.Yi=V.f.create("div",this.h.zoom,"amap-zoom-plus");this.h.je=V.f.create("div",this.h.zoom,"amap-zoom-ruler");this.h.Vi=V.f.create("div",this.h.zoom,"amap-zoom-minus");this.h.Nt=V.f.create("div",this.h.je,"amap-zoom-mask");this.h.cursor=V.f.create("div",this.h.je,"amap-zoom-cursor");this.h.labels=V.f.create("div",this.h.je,"amap-zoom-labels");this.h.street=V.f.create("div",this.h.labels,"amap-zoom-label-street");this.h.city=V.f.create("div", this.h.labels,"amap-zoom-label-city");this.h.WK=V.f.create("div",this.h.labels,"amap-zoom-label-province");this.h.country=V.f.create("div",this.h.labels,"amap-zoom-label-country");(this.Aj=(this.lU=V.j.U)||b&&b.liteStyle)?(this.s0(),this.position="RB",this.offset=new V.K(10,110)):V.f.ja(this.h.Ml,{position:"relative"}).ja(this.h.Ic,{position:"relative",left:"17px"}).ja(this.h.zoom,{position:"relative",left:"14px"});this.bb(b);this.hy&&this.Vx()},an:function(b){this.o1=b.useNative||!1;this.Pg="toolbar"; this.NL=this.Ic=this.direction=this.je=this.visible=!0;this.position="LT";this.offset=new V.K(10,10);this.hy=!1;this.timeout=b.timeout||5E3;this.UY=V.k.nb+"/theme/v1.3/small_loading.gif";this.Ti=new Z({position:this.Ud,offset:new V.K(-11,-11),content:"<div style=\'width:23px;height:23px;overflow:hidden;\'><img style=\'position:relative;cursor:pointer;\' width=\'23px\' height=\'23px\' src=\'"+V.k.Ce+"/loc.png\'></div>"});this.Ti.ea=!0},Wm:function(b,c){this.map=b;c.appendChild(this.h.D);this.Zc=c;this.$G(); this.Ci();var d=this;setTimeout(function(){d.LF()},0)},Jn:function(){this.Hi();this.Zc.removeChild(this.h.D);this.map=this.Zc=null;this.Ux()},s0:function(){var b=V.f.create("div",this.h.Yi);b.innerHTML="&#43;";V.f.wb(this.h.Yi,"amap-zoom-plus");V.f.pb(this.h.Yi,"amap-zoom-touch-plus");V.f.wb(this.h.Ic,"amap-locate");V.f.pb(this.h.Ic,"amap-geo amap-toolbar-geo");b=V.f.create("div",this.h.Vi);b.innerHTML="&#8722;";V.f.wb(this.h.Vi,"amap-zoom-minus");V.f.pb(this.h.Vi,"amap-zoom-touch-minus");V.f.pb(this.h.D, "amap-touch-toolbar")},t0:function(b){b.direction=!1;!0!==b.locate&&(b.locate=!1);b.ruler=!1;return b},bb:function(b){b=b||{};this.Aj&&(b=this.t0(b));for(var c in b)b.hasOwnProperty(c)&&"_"!==c.substr(0,1)&&void 0!==this[c]&&(this[c]=b[c]);this.offset=void 0!==b.offset?b.offset:this.offset;this.position=void 0!==b.position?b.position:this.position;this.je=void 0!==b.ruler?b.ruler:this.je;this.Ic=void 0!==b.locate?b.locate:this.Ic;this.direction=void 0!==b.direction?b.direction:this.direction;this.hy= void 0!==b.autoPosition?b.autoPosition:this.hy;void 0!==b.locationMarker&&(this.Ti.getMap===this.map&&(this.Ti.setMap(null),b.locationMarker.setPosition(this.Ti.getPosition()),b.locationMarker.setMap(this.map)),this.Ti=b.locationMarker);this.mR();this.position&&this.offset&&this.kp(this.position,this.offset);this.direction?V.f.ja(this.h.Ml,{display:"block"}):V.f.ja(this.h.Ml,{display:"none"});this.Ic?V.f.ja(this.h.Ic,{display:"block"}):V.f.ja(this.h.Ic,{display:"none"});!this.je||this.map&&270>this.map.getSize().getHeight()? V.f.ja(this.h.je,{display:"none"}):V.f.ja(this.h.je,{display:"block"});this.visible?V.f.ja(this.h.D,{visibility:"visible"}):V.f.ja(this.h.D,{visibility:"hidden"})},nz:function(b){return this[b]},kp:function(b,c){switch(b){case "LT":V.f.ja(this.h.D,{left:c.Sc()+"px",top:c.xc()+"px",right:"",bottom:""});break;case "RT":V.f.ja(this.h.D,{right:c.Sc()+"px",top:c.xc()+"px",left:"",bottom:""});break;case "LB":V.f.ja(this.h.D,{left:c.Sc()+"px",bottom:c.xc()+"px",right:"",top:""});break;case "RB":V.f.ja(this.h.D, {right:c.Sc()+"px",bottom:c.xc()+"px",left:"",top:""})}this.Zc&&(this.Zc.removeChild(this.h.D),this.Zc.appendChild(this.h.D))},LF:function(){this.Pc=null;this.$G();this.Jx(this.map.get("zoom"))},Ci:function(){this.Jx(this.map.get("zoom"));this.vb={Pc:V.event.addListener(this.map,"zooms",this.LF,this),left:V.event.T(this.h.left,"click",this.cS,this),top:V.event.T(this.h.top,"click",this.sS,this),right:V.event.T(this.h.right,"click",this.lS,this),bottom:V.event.T(this.h.bottom,"click",this.JR,this), Ic:V.event.T(this.h.Ic,"click",this.fS,this),b5:V.event.T(this.h.D,"mousedown",function(b){V.w.preventDefault(b)},this),D3:V.event.T(this.h.cursor,"mousedown",this.Ok,this),x3:V.event.T(this.h.cursor,"mouseover",this.UR,this),w3:V.event.T(this.h.cursor,"mouseout",this.VR,this),B3:V.event.T(document,"mousemove",this.Mk,this),C3:V.event.T(document,"mouseup",this.Nk,this),cursor:V.event.T(this.h.cursor,"click",this.TR,this),Yi:V.event.T(this.h.Yi,"click",this.iS,this),Vi:V.event.T(this.h.Vi,"click", this.gS,this),t5:V.event.T(this.h.je,"mouseover",this.EF,this),o6:V.event.T(this.h.zoom,"mouseout",this.DF,this),B4:V.event.T(this.h.labels,"mouseover",this.EF,this),A4:V.event.T(this.h.labels,"mouseout",this.DF,this),je:V.event.T(this.h.je,"click",this.pS,this),street:V.event.T(this.h.street,"click",this.rS,this),city:V.event.T(this.h.city,"click",this.NR,this),WK:V.event.T(this.h.WK,"click",this.jS,this),country:V.event.T(this.h.country,"click",this.SR,this),CM:V.event.addListener(this.map,"zoomend", this.sj,this),T5:V.event.T(this.h.D,"touchstart",V.g.pI,V.w.stopPropagation),resize:V.event.addListener(this.map,"resize",this.kS,this)};V.j.lg&&(this.vb.D4=V.event.T(this.h.left,"mouseover",this.eS,this),this.vb.R5=V.event.T(this.h.top,"mouseover",this.uS,this),this.vb.q5=V.event.T(this.h.right,"mouseover",this.nS,this),this.vb.d3=V.event.T(this.h.bottom,"mouseover",this.LR,this),this.vb.C4=V.event.T(this.h.left,"mouseout",this.dS,this),this.vb.Q5=V.event.T(this.h.top,"mouseout",this.tS,this),this.vb.p5= V.event.T(this.h.right,"mouseout",this.mS,this),this.vb.c3=V.event.T(this.h.bottom,"mouseout",this.KR,this))},UR:function(){this.h.cursor.style.top=parseInt(this.h.cursor.style.top)-2+"px"},VR:function(){this.h.cursor.style.top=parseInt(this.h.cursor.style.top)+2+"px"},Hi:function(){if(this.vb)for(var b in this.vb)this.vb.hasOwnProperty(b)&&V.event.removeListener(this.vb[b])},cS:function(){this.map.panBy(this.map.getSize().width/2-1,0)},JR:function(){this.map.panBy(0,-this.map.getSize().height/2+ 1)},lS:function(){this.map.panBy(-this.map.getSize().width/2+1,0)},eS:function(){this.h.left.className+=" amap-pan-left-hover"},nS:function(){this.h.right.className+=" amap-pan-right-hover"},uS:function(){this.h.top.className+=" amap-pan-top-hover"},LR:function(){this.h.bottom.className+=" amap-pan-bottom-hover"},dS:function(){this.h.left.className=this.h.left.className.replace(" amap-pan-left-hover","")},mS:function(){this.h.right.className=this.h.right.className.replace(" amap-pan-right-hover", "")},tS:function(){this.h.top.className=this.h.top.className.replace(" amap-pan-top-hover","")},KR:function(){this.h.bottom.className=this.h.bottom.className.replace(" amap-pan-bottom-hover","")},sS:function(){this.map.panBy(0,this.map.getSize().height/2-1)},mR:function(){navigator.geolocation||(this.Ic=!1)},$G:function(){this.Pc||(this.Pc=this.map?this.map.get("zooms"):[3,18]);this.NL=5<this.Pc[0]||17>this.Pc[1]?!1:!0},fS:function(){this.Ud?this.Ux():this.Vx()},P2:function(b,c){var d=V.k.gc+"/v3/assistant/coordinate/convert?coordsys=gps&s=rsv3&output=json", d=d+"&locations="+b.toString()+"&key="+V.k.key,d=new V.na.za(d,{callback:"callback"});d.e("complete",c,this);d.e("error",c,this)},Vx:function(){if(navigator.geolocation){this.Aj||(this.h.Dc||(this.h.Dc=V.f.create("img",this.h.Ic),this.h.Dc.src=this.UY,V.f.ja(this.h.Dc,{margin:(this.Aj?10:4)+"px"})),this.h.Ic.appendChild(this.h.Dc));V.f.pb(this.h.Ic,"amap-locate-loading");var b=this;V.Qa.load("AMap.Geolocation",function(){b.geolocation||(b.geolocation=new V.dC({useNative:this.o1,showButton:!1,showMarker:!1, showCircle:!1,panToLocation:!1,maximumAge:6E5}));b.geolocation.getCurrentPosition(function(c,d){V.f.wb(b.h.Ic,"amap-locate-loading");"complete"===c?(b.nR(d),V.event.H(b,"location-success",d)):(b.lR(),V.event.H(b,"location-failed",d))})})}},Ux:function(){this.Aj?V.f.wb(this.h.Ic,"amap-toolbar-geo-secc"):V.f.ja(this.h.Ic,{backgroundPosition:"-130px -185px"});this.wQ();this.Ud=null},bU:function(){var b=this;if(this.Ud)if(this.yb=this.Ti,this.yb.setMap(this.map),this.Ti instanceof Z&&this.Ti.setPosition(this.Ud), this.so&&(this.ka=new vc({isCustom:!0,content:"<span style=\'display: block; width:80px;background: #fff;border: 1px solid blue;font-size: 12px;border-radius: 3px;\'>\\u5b9a\\u4f4d\\u7cbe\\u5ea6:"+this.so+"\\u7c73</span>",offset:new V.K(25,0)}),this.yb.e("mouseover",function(){b.ka.open(b.map,b.yb.getPosition())}),this.yb.e("mouseout",function(){b.ka.close()})),this.so){this.Fa=new xc({center:this.Ud,radius:this.so,strokeColor:"#0093FF",strokeOpacity:0.3,strokeWeight:1,fillColor:"#02B0FF",fillOpacity:0.25}); this.Fa.ea=!0;this.Fa.setMap(this.map);var c=this.map.getSize(),c=Math.min(c.width,c.height)/4,c=Math.floor(Math.LOG2E*Math.log(c*Math.cos(this.Ud.getLat()*Math.PI/180)*12756274*Math.PI/256/this.so));this.map.setZoomAndCenter(c,this.Ud)}else this.map.setCenter(this.Ud);V.event.H(this,"location",{type:"location",lnglat:this.Ud})},wQ:function(){this.yb&&(this.yb.setMap(null),this.yb=null);this.Fa&&(this.Fa.setMap(null),this.Fa=null);this.Ti.setMap(null)},aU:function(){this.NL&&this.h.labels&&V.f.ja(this.h.labels, {display:"block"})},vQ:function(){this.h.labels&&V.f.ja(this.h.labels,{display:"none"})},ho:function(b,c){var d=c-b;d&&V.event.H(this,"zoomchanged",{type:0===d?void 0:0<d?"zoomin":"zoomout"})},Jx:function(b){var c=+V.f.Cc(this.h.je,"height").replace("px",""),d=this.Pc;b>d[1]&&(b=d[1]);b<d[0]&&(b=d[0]);c=d[0]===d[1]?0:Math.floor((c-10)*(d[1]-b)/(d[1]-d[0]));V.f.ja(this.h.Nt,{height:c+"px"});V.f.ja(this.h.cursor,{top:c+"px"});this.Aj?(b===d[1]?V.f.pb(this.h.Yi,"amap-zoom-touch"):V.f.wb(this.h.Yi,"amap-zoom-touch"), b===d[0]?V.f.pb(this.h.Vi,"amap-zoom-touch"):V.f.wb(this.h.Vi,"amap-zoom-touch")):(b===d[1]?V.f.pb(this.h.Yi,"amap-zoom-plus2"):V.f.wb(this.h.Yi,"amap-zoom-plus2"),b===d[0]?V.f.pb(this.h.Vi,"amap-zoom-minus2"):V.f.wb(this.h.Vi,"amap-zoom-minus2"))},kE:function(){var b=+V.f.Cc(this.h.je,"height").replace("px",""),c=this.Pc,d=+V.f.Cc(this.h.Nt,"height").replace("px","");return c[1]-Math.round((c[1]-c[0])*d/(b-10))},Ok:function(b){this.map&&this.map.getStatus().zoomEnable&&(V.w.stopPropagation(b).preventDefault(b), this.y=V.w.hg(b,this.h.zoom).xc(),this.gb=+V.f.Cc(this.h.cursor,"top").replace("px",""),this.nl=!0)},Mk:function(b){if(this.nl){V.w.stopPropagation(b).preventDefault(b);b=V.w.hg(b,this.h.zoom).xc()-this.y;b=this.gb+b;var c=+V.f.Cc(this.h.je,"height").replace("px","");0<=b&&b<c-10&&(V.f.ja(this.h.cursor,{top:b+"px"}),V.f.ja(this.h.Nt,{height:b+2+"px"}))}},Nk:function(){if(this.nl){var b=this.map.get("zoom"),c=this.kE();this.map.setZoom(c);this.ho(b,c);this.nl=!1}},TR:function(b){V.w.stopPropagation(b).preventDefault(b)}, sj:function(){this.Jx(this.map.get("zoom"))},iS:function(b){V.w.stopPropagation(b).preventDefault(b);this.map.zoomIn();V.event.H(this,"zoomchanged",{type:"zoomin"})},gS:function(b){V.w.stopPropagation(b).preventDefault(b);this.map.zoomOut();V.event.H(this,"zoomchanged",{type:"zoomout"})},EF:function(){this.JJ=!0;this.aU()},DF:function(){this.JJ=!1;var b=this;setTimeout(function(){b.JJ||b.vQ()},1E3)},pS:function(b){if(this.map&&this.map.getStatus().zoomEnable){b=V.w.hg(b,this.h.je).y;var c=+V.f.Cc(this.h.je, "height").replace("px","");b>c-10&&(b=c-10);V.f.ja(this.h.cursor,{top:b+"px"}).ja(this.h.Nt,{height:b+"px"});b=this.map.get("zoom");c=this.kE();this.map.setZoom(c);this.ho(b,c)}},rS:function(b){this.map&&this.map.getStatus().zoomEnable&&(V.w.stopPropagation(b).preventDefault(b),this.map.setZoom(17),b=this.map.get("zoom"),this.ho(b,17))},NR:function(b){this.map&&this.map.getStatus().zoomEnable&&(V.w.stopPropagation(b).preventDefault(b),this.map.setZoom(11),b=this.map.get("zoom"),this.ho(b,11))},jS:function(b){this.map&& this.map.getStatus().zoomEnable&&(V.w.stopPropagation(b).preventDefault(b),this.map.setZoom(7),b=this.map.get("zoom"),this.ho(b,7))},SR:function(b){this.map&&this.map.getStatus().zoomEnable&&(V.w.stopPropagation(b).preventDefault(b),this.map.setZoom(3),b=this.map.get("zoom"),this.ho(b,3))},kS:function(){this.bb({locate:this.Ic})},nR:function(b){try{this.Ud=b.position,this.so=b.accuracy,this.h.Dc&&this.h.Dc.parentNode&&this.h.Dc.parentNode.removeChild(this.h.Dc),this.Aj?V.f.pb(this.h.Ic,"amap-toolbar-geo-secc"): V.f.ja(this.h.Ic,{backgroundPosition:"-130px -211px"}),this.bU({locations:this.Ud+""})}catch(c){}},lR:function(){this.Ud=null;try{this.h.Ic.removeChild(this.h.Dc),this.Aj||V.f.ja(this.h.Ic,{backgroundPosition:"-130px -185px"})}catch(b){}},getOffset:function(){V.a.add(this.CLASS_NAME,"getOffset");return this.offset},setOffset:function(b){V.a.add(this.CLASS_NAME,"setOffset");this.bb({offset:b})},hideRuler:function(){V.a.add(this.CLASS_NAME,"hideRuler");this.bb({ruler:!1})},showRuler:function(){V.a.add(this.CLASS_NAME, "showRuler");this.bb({ruler:!0})},hideDirection:function(){V.a.add(this.CLASS_NAME,"hideDirection");this.bb({direction:!1})},showDirection:function(){V.a.add(this.CLASS_NAME,"showDirection");this.bb({direction:!0})},hideLocation:function(){V.a.add(this.CLASS_NAME,"hideLocation");this.bb({locate:!1})},showLocation:function(){V.a.add(this.CLASS_NAME,"showLocation");this.bb({locate:!0})},hide:function(){V.a.add(this.CLASS_NAME,"hide");this.bb({visible:!1});V.event.H(this,"hide")},show:function(){V.a.add(this.CLASS_NAME, "show");this.bb({visible:!0});V.event.H(this,"show")},doLocation:function(){V.a.add(this.CLASS_NAME,"doLocation");this.Ud&&this.Ux();this.Vx()},getLocation:function(){V.a.add(this.CLASS_NAME,"getLocation");return this.Ud},mn:function(){var b=[0,0,0,0];if(this.h.D){var c=V.f.Cc(this.h.D,"width"),d=V.f.Cc(this.h.D,"height"),c=this.offset.Sc()+parseFloat(c),d=this.offset.xc()+parseFloat(d)+5;-1!==this.position.indexOf("T")&&(b[0]=d);-1!==this.position.indexOf("R")&&(b[1]=c);-1!==this.position.indexOf("B")&& (b[2]=d);-1!==this.position.indexOf("L")&&(b[3]=c)}return b}});window.AMap.ToolBar||(window.AMap.ToolBar=V.rN); ')

_jsload_('AMap.Heatmap', '(function(b){function c(b){b||(b={});Array.prototype.slice.call(arguments,1).forEach(function(c){if(c)for(var d in c)c.hasOwnProperty(d)&&(b[d]=c[d])})}var d={defaultRadius:30,defaultRenderer:"canvas2d",defaultGradient:{"0.25":"rgb(0,0,255)","0.55":"rgb(0,255,0)","0.85":"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:0.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},e=function(){function b(c){this._coordinator={};this._data=[];this._radi= [];this._min=0;this._max=1;this._xField=c.xField||c.defaultXField;this._yField=c.yField||c.defaultYField;this._valueField=c.valueField||c.defaultValueField;c.radius&&(this._cfgRadius=c.radius)}var e=d.defaultRadius;c(b.prototype,{_organiseData:function(b,c){var d=b[this._xField],g=b[this._yField],h=this._radi,k=this._data,l=this._max,m=this._min,s=b[this._valueField]||1,O=b.radius||this._cfgRadius||e;k[d]||(k[d]=[],h[d]=[]);k[d][g]?k[d][g]+=s:(k[d][g]=s,h[d][g]=O);return k[d][g]>l?(c?this.setDataMax(k[d][g]): this._max=k[d][g],!1):{x:d,y:g,value:s,radius:O,min:m,max:l}},_unOrganizeData:function(){var b=[],c=this._data,d=this._radi,e;for(e in c)if(c.hasOwnProperty(e))for(var g in c[e])c[e].hasOwnProperty(g)&&b.push({x:e,y:g,radius:d[e][g],value:c[e][g]});return{min:this._min,max:this._max,data:b}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(b){if(0<b.length)for(var c=b.length;c;)c-=1,this.addData.call(this,b[c]);else(b=this._organiseData(b, !0))&&this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[b]});return this},setData:function(b){var c=b.data,d=c.length;this._data=[];this._radi=[];for(var e=0;e<d;e+=1)this._organiseData(c[e],!1);this._max=b.max;this._min=b.min||0;this._onExtremaChange();this._coordinator.emit("renderall",this._getInternalData());return this},removeData:function(){},setDataMax:function(b){this._max=b;this._onExtremaChange();this._coordinator.emit("renderall",this._getInternalData());return this}, setDataMin:function(b){this._min=b;this._onExtremaChange();this._coordinator.emit("renderall",this._getInternalData());return this},setCoordinator:function(b){this._coordinator=b},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}});return b}(),g=function(){function b(c){var d=[],e=c.min,h=c.max,k=c.radi;c=c.data;for(var l=Object.keys(c),m=l.length;1<=m;)for(var m=m-1,n=l[m],p=Object.keys(c[n]),E=p.length;1<= E;){var E=E-1,C=p[E],T=c[n][C],P=k[n][C];g&&(P=g);d.push({x:n,y:C,value:T,radius:P})}return{min:e,max:h,data:d}}function d(b){b=b.gradient||b.defaultGradient;var c=document.createElement("canvas"),e=c.getContext("2d");c.width=256;c.height=1;var c=e.createLinearGradient(0,0,256,1),g;for(g in b)b.hasOwnProperty(g)&&c.addColorStop(g,b[g]);e.fillStyle=c;e.fillRect(0,0,256,1);return e.getImageData(0,0,256,1).data}function e(b){var c=b.container,g=this.shadowCanvas=document.createElement("canvas"),h=this.canvas= b.canvas||document.createElement("canvas");this._renderBoundaries=[2E3,2E3,0,0];var k=getComputedStyle(b.container)||{};h.className="heatmap-canvas";this._width=h.width=g.width=+k.width.replace(/px/,"");this._height=h.height=g.height=+k.height.replace(/px/,"");this.shadowCtx=g.getContext("2d");this.ctx=h.getContext("2d");h.style.cssText=g.style.cssText="position:absolute;left:0;top:0;";c.style.position="relative";c.appendChild(h);this.canvas=h;this.LL=g;this._palette=d(b);this._templates={};this._setStyles(b)} var g=null;c(e.prototype,{_resetSize:function(b,c){this._width=this.canvas.width=this.LL.width=b;this._height=this.canvas.height=this.LL.height=c},renderPartial:function(b){this._drawAlpha(b);this._colorize()},renderAll:function(c){this._clear();this._drawAlpha(b(c));this._colorize()},_updateGradient:function(b){this._palette=d(b)},updateConfig:function(b){b.gradient&&this._updateGradient(b);this._setStyles(b)},setDimensions:function(b,c){this._width=b;this._height=c;this.canvas.width=this.shadowCanvas.width= b;this.canvas.height=this.shadowCanvas.height=c},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height);this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(b){this._blur=0===b.blur?0:b.blur||b.defaultBlur;b.backgroundColor&&(this.canvas.style.backgroundColor=b.backgroundColor);this._opacity=255*(b.opacity||0);this._maxOpacity=255*(b.maxOpacity||b.defaultMaxOpacity);this._minOpacity=255*(b.minOpacity||b.defaultMinOpacity);this._useGradientOpacity=!!b.useGradientOpacity; b.radius&&(this._reSetRadius=b.radius)},_drawAlpha:function(b){var c=this._min=b.min,d=this._max=b.max;b=b.data||[];for(var e=b.length,g=1-this._blur;1<=e;){var e=e-1,h=b[e],k=h.x,l=h.y,m=h.radius,h=Math.min(h.value,d),k=k-m,l=l-m,n=this.shadowCtx,p;if(this._templates[m])p=this._templates[m];else{p=this._templates;var q=m,P=m,R=g,G=document.createElement("canvas"),x=G.getContext("2d");G.width=G.height=2*P;1===R?(x.beginPath(),x.arc(P,P,P,0,2*Math.PI,!1),x.fillStyle="rgba(0,0,0,1)",x.fill()):(R=x.createRadialGradient(P, P,P*R,P,P,P),R.addColorStop(0,"rgba(0,0,0,1)"),R.addColorStop(1,"rgba(0,0,0,0)"),x.fillStyle=R,x.fillRect(0,0,2*P,2*P));p[q]=p=G}n.globalAlpha=(h-c)/(d-c);n.drawImage(p,k,l);k<this._renderBoundaries[0]&&(this._renderBoundaries[0]=k);l<this._renderBoundaries[1]&&(this._renderBoundaries[1]=l);k+2*m>this._renderBoundaries[2]&&(this._renderBoundaries[2]=k+2*m);l+2*m>this._renderBoundaries[3]&&(this._renderBoundaries[3]=l+2*m)}},_colorize:function(){var b=this._renderBoundaries[0],c=this._renderBoundaries[1], d=this._renderBoundaries[2]-b,e=this._renderBoundaries[3]-c,g=this._width,h=this._height,k=this._opacity,l=this._maxOpacity,m=this._minOpacity,n=this._useGradientOpacity;0>b&&(b=0);0>c&&(c=0);b+d>g&&(d=g-b);c+e>h&&(e=h-c);for(var d=this.shadowCtx.getImageData(b,c,d,e),e=d.data,g=e.length,h=this._palette,p=3;p<g;p+=4){var q=e[p],P=4*q;P&&(q=0<k?k:q<l?q<m?m:q:l,e[p-3]=h[P],e[p-2]=h[P+1],e[p-1]=h[P+2],e[p]=n?h[P+3]:q)}d.data=e;this.ctx.putImageData(d,b,c);this._renderBoundaries=[1E3,1E3,0,0]},getValueAt:function(b){b= this.shadowCtx.getImageData(b.x,b.y,1,1).data[3];return b/255*Math.abs(this._max-this._min)>>0},getDataURL:function(){return this.canvas.toDataURL()},resetRadius:function(b){g=b}});return e}(),h=function(){var b=!1;"canvas2d"===d.defaultRenderer&&(b=g);return b}(),k={merge:function(){for(var b={},c=arguments.length,d=0;d<c;d+=1){var e=arguments[d],g;for(g in e)e.hasOwnProperty(g)&&(b[g]=e[g])}return b}},l=function(){function b(c){var d=c._renderer,e=c._coordinator,g=c._store;e.on("renderpartial", d.renderPartial,d);e.on("renderall",d.renderAll,d);e.on("extremachange",function(b){if(c._config.onExtremaChange)c._config.onExtremaChange({min:b.min,max:b.max,gradient:c._config.gradient||c._config.defaultGradient})});g.setCoordinator(e)}function g(c){c=this._config=k.merge(d,c||{});this._coordinator=new l;if(c.plugin){var n=c.plugin;if(d.plugins[n])n=d.plugins[n],this._renderer=new n.renderer(c),this._store=new n.store(c);else throw Error("Plugin \'"+n+"\' not found. Maybe it was not registered."); }else this._renderer=new h(c),this._store=new e(c);b(this)}var l=function(){function b(){this.cStore={}}c(b.prototype,{on:function(b,c,d){var e=this.cStore;e[b]||(e[b]=[]);e[b].push(function(b){return c.call(d,b)})},emit:function(b,c){var d=this.cStore;if(d[b])for(var e=d[b].length,g=0;g<e;g+=1)(0,d[b][g])(c)}});return b}();c(g.prototype,{addData:function(){this._store.addData.apply(this._store,arguments);return this},removeData:function(){this._store.removeData&&this._store.removeData.apply(this._store, arguments);return this},setData:function(){this._store.setData.apply(this._store,arguments);return this},clear:function(){this._renderer._clear()},setDataMax:function(){this._store.setDataMax.apply(this._store,arguments);return this},setDataMin:function(){this._store.setDataMin.apply(this._store,arguments);return this},configure:function(b){this._config=k.merge(this._config,b);b.radius&&this._renderer.resetRadius(b.radius);this._renderer.updateConfig(this._config);this._coordinator.emit("renderall", this._store._getInternalData());return this},repaint:function(){this._coordinator.emit("renderall",this._store._getInternalData());return this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(b){return this._store.getValueAt?this._store.getValueAt(b):this._renderer.getValueAt?this._renderer.getValueAt(b):null},resetSize:function(b,c){this._renderer._resetSize(b,c)}});return g}();b.h337={create:function(b){return new l(b)}, register:function(b,c){d.plugins[b]=c}}})(window); V.SM=V.W.extend({oa:[V.ca,V.gd],B:function(b,c){this.CLASS_NAME="AMap.Heatmap";V.a.Sa(this.CLASS_NAME,c);c=c||{};this.options={visible:!0,radius:c.radius||30,gradient:c.gradient||{"0.5":"blue","0.65":"rgb(117,211,248)","0.7":"rgb(0, 255, 0)","0.9":"#ffea00",1:"red"},opacity:c.opacity||[0,1],zooms:c.zooms||[3,18],zIndex:c.zIndex||17};this.an={radius:this.options.radius,maxOpacity:this.options.opacity[1],minOpacity:this.options.opacity[0],gradient:this.options.gradient};if(this.isCanavs=this.OO())this.ko= JSON.stringify({data:[]}),this.setMap(b)},E2:function(b,c,d){b=new AMap.LngLat(b,c);c=this.options.map.getZoom();b=this.options.map.lngLatToContainer(b,c);return{x:b.x,y:b.y,value:d}},OO:function(){return document.createElement("canvas").getContext("2d")?!0:!1},PN:function(){if(!this.rc){var b=this.options.map.map.Xa,c=this.options.map.getSize().getWidth(),d=this.options.map.getSize().getHeight();this.rc=document.createElement("div");this.rc.id="_amap_heatmap_div_";this.rc.style.cssText="position:absolute;top:0;left:0;"; this.rc.style.zIndex=this.options.zIndex;this.rc.style.width=c+"px";this.rc.style.height=d+"px";this.an.container=this.rc;this.options.visible&&(b.V.appendChild(this.rc),this.Sh=window.h337.create(this.an))}},Cw:function(){var b=this.options.zooms[1],c=this.options.zooms[0],d=this.options.map.getZoom();return parseInt(d)>=parseInt(c)&&parseInt(d)<=parseInt(b)},Sk:function(){if(this.options.map.get("zoom",null,!0)===this.options.map.getZoom()){var b=this.options.map.getSize();this.Sh.resetSize(b.width, b.height);this.K_=b;this.Aq=this.options.map.get("centerCoords");this.nL=this.options.map.getZoom();if(this.Sh&&this.Ge&&this.Ge.data&&this.Ge.data.length){this.kD();this.fl||this.lW();for(var c=Math.pow(2,20-this.options.map.getZoom()),d={max:this.Ge.max},e=[],g=this.options.map.getBounds(),g=this.options.map.qb(g.bh(),20),h=this.options.radius,k=0;k<this.fl.length;k+=1){var l=this.fl[k],m=(l.x-g.x)/c,n=(l.y-g.y)/c;m>-h&&m<b.width+h&&n>-h&&n<b.height+h&&e.push({x:(l.x-g.x)/c,y:(l.y-g.y)/c,value:l.count})}this.JG(); d.data=e;this.rc.style.top="0px";b=this.options.map.get("rotation");this.rc.style[V.f.Bd]=b?"rotate3d(0,0,1,"+-b+"deg)":"";this.rc.style.left="0px";this.rc.style.zIndex=this.options.zIndex;this.Sh.setData(d)}}},kD:function(){this.Sh.setData({data:[]});this.Sh.clear()},pm:function(){this.Sh&&this.Sh.configure(this.an)},nP:function(){return!!(this.ko&&this.options.map&&this.options.visible&&this.isCanavs&&this.Cw())},JG:function(){this.Sh&&this.options.map&&this.rc&&(this.ZG?this.rc.style.visibility= "hidden":!0===this.options.visible&&!0===this.Cw()?(this.pm(),this.rc.style.visibility="visible"):(this.pm(),this.rc.style.visibility="hidden"))},renderChanged:function(){if(this.options.map.map.dg||!1==this.options.visible)this.rc.style.visibility="hidden";else if(this.options.map.map.Hg&&this.Aq)this.Rl();else{var b=this.options.map;if(b){var c=b.get("centerCoords"),d=b.getSize();c.Hb(this.Aq)&&this.nL===b.getZoom()&&d.Hb(this.K_)||this.Sk()}}},Rl:function(){var b=this.options.map;if(b){var c=b.get("centerCoords"); if(!c.Hb(this.Aq)){var b=b.get("crs").Qh(this.nL),d=(this.Aq.x-c.x)/b;this.rc.style.top=(this.Aq.y-c.y)/b+"px";this.rc.style.left=d+"px"}}},setOptions:function(b){V.a.add(this.CLASS_NAME,"setOptions");if(this.isCanavs){b=b||{};var c=this.options;this.options.radius=b.radius||c.radius;this.options.gradient=b.gradient||c.gradient;this.options.opacity=b.opacity||c.opacity;this.options.zooms=b.zooms||c.zooms;this.options.zIndex=b.zIndex||c.zIndex;this.options.visible="boolean"==typeof b.visible?b.visible: c.visible;this.an={radius:this.options.radius,maxOpacity:this.options.opacity[1],minOpacity:this.options.opacity[0],gradient:this.options.gradient};this.Sh&&this.nP()&&(this.pm(),this.Sk());this.JG()}},getOptions:function(){V.a.add(this.CLASS_NAME,"getOptions");if(this.isCanavs){var b={},c;for(c in this.options)this.options.hasOwnProperty(c)&&"map"!==c&&"visible"!==c&&(b[c]=this.options[c]);return b}},setDataSet:function(b){V.a.add(this.CLASS_NAME,"setDataSet");if("string"==typeof b.data){var c=this; new V.na.za(b.data,{callback:"callback",callbackFunction:function(d){b.data="function"==typeof b.dataParser?b.dataParser(d):d;c.uG(b)}})}else this.uG(b)},uG:function(b){this.isCanavs&&(this.ko=JSON.stringify({data:[]}),this.Ge=null,b?(this.Ge=b,this.ko=JSON.stringify(b),this.fl=null,this.Sh&&this.options.map&&(this.pm(),this.Sk())):this.kD())},lW:function(){this.fl=[];if(this.Ge)for(var b=0,c=this.Ge.data.length;b<c;b+=1){var d=this.Ge.data[b];this.fl.push(this.SJ(d.lng,d.lat,d.count))}},SJ:function(b, c,d){b=this.options.map.qb([b,c],20);b.count=d;return b},getDataSet:function(){V.a.add(this.CLASS_NAME,"getDataSet");if(this.isCanavs)return this.Ge},addDataPoint:function(b,c,d){V.a.add(this.CLASS_NAME,"addDataPoint");if(this.isCanavs){d||isNaN(d)||(d=1);if(this.Ge){var e=JSON.parse(this.ko);e.data.push({lng:b,lat:c,count:d});this.Ge=e}else this.Ge={},this.Ge.data=[],this.Ge.data.push({lng:b,lat:c,count:d});this.fl&&this.fl.push(this.SJ(b,c,d));this.ko=JSON.stringify(this.Ge);this.pm();this.Sk()}}, setMap:function(b){V.a.add(this.CLASS_NAME,"setMap");this.isCanavs&&(b?b!==this.options.map&&(this.ii("render",this.options.map),this.options.map=b,this.rc||this.PN(),this.options.map.map.Xa.V.appendChild(this.rc),this.P("render",b)):((b=this.rc)&&b.parentNode.removeChild(b),this.ii("render",this.options.map),this.options.map=null))},hide:function(){V.a.add(this.CLASS_NAME,"hide");this.isCanavs&&(this.options.visible=!1,this.rc&&(this.ZG=!0,this.rc.style.visibility="hidden"))},show:function(){V.a.add(this.CLASS_NAME, "show");this.isCanavs&&(this.options.visible=!0,this.rc&&this.Cw()&&(this.ZG=!1,this.rc.style.visibility="visible",this.pm(),this.Sk()))},getMap:function(){V.a.add(this.CLASS_NAME,"getMap");if(this.isCanavs)return this.options.map},setzIndex:function(b){V.a.add(this.CLASS_NAME,"setzIndex");this.options.zIndex=b},getzIndex:function(){V.a.add(this.CLASS_NAME,"getzIndex");return this.options.zIndex}});window.AMap.Heatmap=V.SM; ')
_jsload_('AMap.MouseTool', 'V.bN=V.W.extend({oa:[V.ca],B:function(b){this.CLASS_NAME="AMap.MouseTool";this.Sb=[];this.aa={};this.Dh={};this.A=b;this.Zf(b);var c=this;window.AMap.plugin("AMap.RangingTool",function(){c.ag=new V.qC(b);V.event.H(c,"rangingtool-loaded")});window.AMap.plugin("AMap.AutoPanby",function(){c.VC=new V.GM(b)})},Zf:function(b){this.A=b;this.aa={Uc:[],c_:[],b_:[],l_:[],KV:[],W_:[],O4:[],h5:[],i5:[]}},$c:function(){return Math.round(1E5*Math.random())},Fh:function(){for(;0<this.Sb.length;)V.event.removeListener(this.Sb.shift()); this.ag&&this.ag.turnOff()},marker:function(b){V.a.add(this.CLASS_NAME,"marker");this.A.set("allBubble",!0);this.Fh();b=b||{bubble:!0};var c=this,d=this.A,e=this.aa.Uc;this.Sb.push(V.event.addListener(d,"click",function(g){b.position=g.lnglat;g=new Z(b);g.setMap(d);V.event.H(c,"draw",{obj:g});e.push(g)},d))},polyline:function(b){V.a.add(this.CLASS_NAME,"polyline");this.A.set("allBubble",!0);this.Fh();b=b||{};var c=this,d=this.A,e=this.aa.c_,g=d.getStatus().doubleClickZoom,h=!1;this.Sb.push(V.event.addListener(d, "click",function(c){if(!1===h)h=new yc({path:[c.lnglat,c.lnglat],strokeColor:b.strokeColor||"#1791fc",strokeOpacity:b.strokeOpacity||0.8,strokeWeight:b.strokeWeight||2,strokeStyle:b.strokeStyle||"solid",strokeDasharray:b.strokeDasharray||[10,5],zIndex:b.zIndex||10,extData:b.extData||{},bubble:!0}),d.setStatus({doubleClickZoom:!1}),h.setMap(d),e.push(h);else{var g=h.getPath(),m=g.pop();g.push(c.lnglat,m);h.setPath(g)}},d));this.Sb.push(V.event.addListener(d,"mousemove",function(b){if(h){var c=h.getPath(); c.pop();c.push(b.lnglat);h.setPath(c)}},d,d));this.Sb.push(V.event.addListener(d,"dblclick",function(){if(h){var b=h.getPath();b.pop();h.setPath(b);2<=h.getPath().length?V.event.H(c,"draw",{obj:h}):h.setMap(null)}h=!1;d.setStatus({doubleClickZoom:g})},d));this.Sb.push(V.event.addListener(d,"rightclick",function(){if(h){var b=h.getPath();b.pop();h.setPath(b);2<=h.getPath().length?(e.push(h),V.event.H(c,"draw",{obj:h})):h.setMap(null)}h=!1;d.setStatus({doubleClickZoom:g})},d))},polygon:function(b){V.a.add(this.CLASS_NAME, "polygon");this.A.set("allBubble",!0);this.Fh();b=b||{};var c=this,d=this.A,e=this.aa.b_,g=d.getStatus().doubleClickZoom,h=!1;this.Sb.push(V.event.addListener(d,"click",function(c){if(!1===h)h=new zc({path:[c.lnglat,c.lnglat],strokeColor:b.strokeColor||"#1791fc",strokeOpacity:b.strokeOpacity||0.8,strokeWeight:b.strokeWeight||2,fillColor:b.fillColor||"#1791fc",fillOpacity:b.fillOpacity||0.35,strokeStyle:b.strokeStyle||"solid",strokeDasharray:b.strokeDasharray||[10,5],zIndex:b.zIndex||10,extData:b.extData|| {},bubble:b.bubble||!0}),d.setStatus({doubleClickZoom:!1}),h.setMap(d),e.push(h);else{var g=h.getPath(),m=g.pop();g.push(c.lnglat,m);h.setPath(g)}},d,this));this.Sb.push(V.event.addListener(d,"mousemove",function(b){if(h){var c=h.getPath();c.pop();c.push(b.lnglat);h.setPath(c)}},d,this));this.Sb.push(V.event.addListener(d,"dblclick",function(){if(h){var b=h.getPath();b.pop();h.setPath(b);2<h.getPath().length?V.event.H(c,"draw",{obj:h}):h.setMap(null)}h=!1;d.setStatus({doubleClickZoom:g})},this)); this.Sb.push(V.event.addListener(d,"rightclick",function(){if(h){var b=h.getPath();b.pop();h.setPath(b);2<h.getPath().length?(e.push(h),V.event.H(c,"draw",{obj:h})):h.setMap(null)}h=!1;d.setStatus({doubleClickZoom:g})},this))},rectangle:function(b){V.a.add(this.CLASS_NAME,"rectangle");this.A.set("allBubble",!0);this.Fh();b=b||{};var c=this,d=this.A,e=this.aa.l_,g=d.getStatus().dragEnable,h,k;this.Sb.push(V.event.addListener(d,"mousedown",function(c){h||(k=c.lnglat,h=new zc({path:[c.lnglat],strokeColor:b.strokeColor|| "#1791fc",strokeOpacity:b.strokeOpacity||0.8,strokeWeight:b.strokeWeight||2,fillColor:b.fillColor||"#1791fc",fillOpacity:b.fillOpacity||0.35,strokeStyle:b.strokeStyle||"solid",strokeDasharray:b.strokeDasharray||[10,5],zIndex:b.zIndex||10,extData:b.extData||{},bubble:b.bubble||!0}),h.setMap(d),e.push(h));d.setStatus({dragEnable:!1})},this));this.Sb.push(V.event.addListener(d,"mousemove",function(b){h&&(b=b.lnglat,b=[k,new V.O(b.I,k.M),b,new V.O(k.I,b.M)],h.setPath(b))},this));this.Sb.push(V.event.addListener(d, "mouseup",function(){h&&(V.event.H(c,"draw",{obj:h}),h=!1);d.setStatus({dragEnable:g})},this))},circle:function(b){V.a.add(this.CLASS_NAME,"circle");this.A.set("allBubble",!0);this.Fh();b=b||{};var c=this,d=this.A,e=this.aa.KV;d.getStatus();var g;this.Sb.push(V.event.addListener(d,"mousedown",function(h){function k(b){d.getSize();d.getSize();b=n.ye(b.lnglat);g.setRadius(b)}function l(){for(c.VC.V0();0<m.length;)V.event.removeListener(m.shift());e.push(g);V.event.H(c,"draw",{obj:g});g=null;d.setStatus({dragEnable:!0}); d.C("mousemove",k,this);V.w.C(document,"mouseup",l,this);d.C("mouseup",l,this)}if(!g){d.setStatus({dragEnable:!1});var m=[],n=h.lnglat;g=new xc({center:h.lnglat,radius:1,strokeColor:b.strokeColor||"#1791fc",strokeOpacity:b.strokeOpacity||0.8,strokeWeight:b.strokeWeight||2,fillColor:b.fillColor||"#1791fc",fillOpacity:b.fillOpacity||0.35,strokeStyle:b.strokeStyle||"solid",strokeDasharray:b.strokeDasharray||[10,5],zIndex:b.zIndex||10,extData:b.extData||{},bubble:b.bubble||!0});c.VC.W0();g.setMap(d); m.push(V.event.addListener(d,"mousemove",k,this));m.push(V.event.addListener(d,"mouseup",l,this));m.push(V.event.T(document,"mouseup",l,this))}},this))},rule:function(b){function c(b){V.event.H(this,"draw",{obj:b.polyline})}V.a.add(this.CLASS_NAME,"rule");this.A.set("allBubble",!0);this.Fh();this.VQ=!0;this.ag?(b&&this.ag.bb(b),this.ag.turnOn(),this.Ex||(this.Ex=V.event.addListener(this.ag,"end",c,this))):V.event.bH(this,"rangingtool-loaded",function(){this.VQ&&(b&&this.ag.bb(b),this.ag.turnOn(), this.Ex||(this.Ex=V.event.addListener(this.ag,"end",c,this)))},this);return this.ag},measureArea:function(b){function c(b){var c=document.createElement("div");c.style.cssText="position:relative;background-color:#FFFFFF;border:1px solid #4B4B4B;border-radius:3px 3px 3px 3px;box-shadow:2px 2px 8px #999999;padding:2px 7px;white-space:nowrap;";var h=b.getArea();c.innerHTML=1E5<h?(1E-6*h).toFixed(2)+"\\u5e73\\u65b9\\u516c\\u91cc":h.toFixed(1)+"\\u5e73\\u65b9\\u7c73";b=new Z({position:b.getPath()[0],content:c, offset:new V.K(8,8),bubble:!0});b.ea=!0;b.id=d.$c();g[b.id]=b;b.setMap(e)}V.a.add(this.CLASS_NAME,"measureArea");this.A.set("allBubble",!0);this.Fh();b=b||{};var d=this,e=this.A,g,h=e.getStatus().doubleClickZoom,k=!1;this.Sb.push(V.event.addListener(e,"click",function(c){if(!1===k)k=new zc({path:[c.lnglat,c.lnglat],strokeColor:b.strokeColor||"#1791fc",strokeOpacity:b.strokeOpacity||0.8,strokeWeight:b.strokeWeight||2,fillColor:b.fillColor||"#1791fc",fillOpacity:b.fillOpacity||0.35,strokeStyle:b.strokeStyle|| "solid",strokeDasharray:b.strokeDasharray||[10,5],zIndex:b.zIndex||10,extData:b.extData||{},bubble:!0}),k.ea=!0,k.id=d.$c(),e.setStatus({doubleClickZoom:!1}),g=d.Dh[k.id]={},g[k.id]=k,k.setMap(e);else{var h=k.getPath(),n=h.pop();h.push(c.lnglat,n);k.setPath(h)}},this));this.Sb.push(V.event.addListener(e,"mousemove",function(b){if(k){var c=k.getPath();c.pop();c.push(b.lnglat);k.setPath(c)}},this));this.Sb.push(V.event.addListener(e,"dblclick",function(){if(k){var b=k.getPath();b.pop();k.setPath(b); 2<k.getPath().length?(c(k),V.event.H(d,"draw",{obj:k})):k.setMap(null)}k=!1;e.setStatus({doubleClickZoom:h})},this));this.Sb.push(V.event.addListener(e,"rightclick",function(){if(k){var b=k.getPath();b.pop();k.setPath(b);2<k.getPath().length?(c(k),V.event.H(d,"draw",{obj:k})):k.setMap(null)}k=!1;e.setStatus({doubleClickZoom:h})},this))},rectZoomIn:function(b){V.a.add(this.CLASS_NAME,"rectZoomIn");this.A.set("allBubble",!0);this.Fh();b=b||{};var c=this.A,d=c.getStatus().dragEnable,e,g,h;this.Sb.push(V.event.addListener(c, "mousedown",function(d){e=h=null;g=d.lnglat,h=d.pixel,e=new zc({path:[d.lnglat],strokeColor:b.strokeColor||"#1791fc",strokeOpacity:b.strokeOpacity||0.8,strokeWeight:b.strokeWeight||2,fillColor:b.fillColor||"#1791fc",fillOpacity:b.fillOpacity||0.35,dragEnable:!1,strokeStyle:b.strokeStyle||"solid",strokeDasharray:b.strokeDasharray||[10,5],zIndex:b.zIndex||10,bubble:!0}),e.ea=!0,c.setStatus({dragEnable:!1}),e.setMap(c)},this));this.Sb.push(V.event.T(document,"mousemove",function(b){e&&(b=V.w.hg(b,c.D), c.Jj(b),b=c.Jj(b),b=[g,new V.O(b.I,g.M),b,new V.O(g.I,b.M),g],e.setPath(b))},this));this.Sb.push(V.event.T(document,"mouseup",function(b){c.setStatus({dragEnable:d});e&&1<e.getPath().length&&(b=V.w.hg(b,c.D),c.Jj(b),c.Jj(b),(3<Math.abs(b.x-h.x)||3<Math.abs(b.y-h.y))&&c.setFitView([e]));e&&e.setMap(null);e=null},this))},rectZoomOut:function(b){V.a.add(this.CLASS_NAME,"rectZoomOut");this.A.set("allBubble",!0);this.Fh();b=b||{};var c=this.A,d=c.getStatus().dragEnable,e,g,h,k,l,m;this.Sb.push(V.event.addListener(c, "mousedown",function(d){l||(g=d.lnglat,m=d.pixel,l=new zc({path:[d.lnglat],strokeColor:b.strokeColor||"#1791fc",strokeOpacity:b.strokeOpacity||0.8,strokeWeight:b.strokeWeight||2,fillColor:b.fillColor||"#1791fc",fillOpacity:b.fillOpacity||0.35,strokeStyle:b.strokeStyle||"solid",strokeDasharray:b.strokeDasharray||[10,5],zIndex:b.zIndex||10,bubble:!0}),l.ea=!0,c.setStatus({dragEnable:!1}),l.setMap(c))},this));this.Sb.push(V.event.addListener(c,"mousemove",function(b){l&&(h=b.lnglat,k=new V.O(h.I,g.M), e=new V.O(g.I,h.M),l.setPath([g,k,h,e,g]))},this));this.Sb.push(V.event.T(document,"mouseup",function(b){c.setStatus({dragEnable:d});if(l&&1<l.getPath().length&&(b=V.w.hg(b,c.D),c.Jj(b),c.Jj(b),!b.Hb(m))){c.getBounds();b=(g.I+k.I)/2;var e=(g.M+k.M)/2;c.setZoomAndCenter(c.get("zoom")-1,new V.O(b,e))}l&&l.setMap(null);l=m=null},this))},close:function(b){V.a.add(this.CLASS_NAME,"close");this.A.set("allBubble",!1);this.Fh();var c;if(b){for(c in this.aa)if(this.aa.hasOwnProperty(c))for(;0<this.aa[c].length;)b= this.aa[c].shift(),b.setMap(null);for(c in this.Dh)if(this.Dh.hasOwnProperty(c)){for(var d in this.Dh[c])this.Dh[c].hasOwnProperty(d)&&(b=this.Dh[c][d],b.setMap(null),this.Dh[c][d]=null,delete this.Dh[c][d]);this.Dh[c]=null;delete this.Dh[c]}this.ag&&this.ag.turnOff(!0)}}});window.AMap.MouseTool=V.bN; ')

_jsload_('AMap.PolyEditor', 'V.gN=V.W.extend({oa:[V.ca],B:function(b,c){this.A=b;this.Me=c;this.nb=V.k.nb;this.CLASS_NAME="AMap.PolyEditor"},RH:function(){this.Na||this.zw();for(var b=0;b<this.Na.length;b+=1)for(var c=this.Na[b],d=0;d<c.length;d+=1)c[d].setMap(this.A),c[d].Ch&&c[d].Ch.setMap(this.A)},dL:function(){if(this.Na){for(var b=0;b<this.Na.length;b+=1)for(var c=this.Na[b],d=0;d<c.length;d+=1)c[d].setMap(null),c[d].Ji(),c[d].Ch&&(c[d].Ch.setMap(null),c[d].Ch.Ji());delete this.Na}},open:function(){V.a.add(this.CLASS_NAME, "open");this.RH();this.Me.e("setPath",this.OK,this)},OK:function(){this.dL();this.RH()},close:function(){V.a.add(this.CLASS_NAME,"close");this.dL();this.Me.C("setPath",this.OK,this);V.event.H(this,"end",{type:"end",target:this.Me})},zw:function(){this.Na=[];var b=this.Me.getPath();if(b.length){b[0]instanceof V.O&&(b=[b]);this.Jk=b;for(var c=0;c<b.length;c+=1){var d=b[c];this.Na[c]=[];for(var e=0,g=0,h=0,e=0,h=d.length;e<h;e+=1)g=this.yo(d[e],e,c),g.e("click",this.ex,this),this.Na[c].push(g);e=0;for(g= h-1;e<h;g=e,e+=1)if(0!==e||zc&&this.Me instanceof zc)d=this.Na[c][g],g=this.Na[c][e],this.vr(d,g,c),this.As(d,g)}}},yo:function(b,c,d){var e=new Z({position:b,draggable:!0,icon:new Lc({size:new V.Yb(11,11),imageOffset:new V.K(0,0),image:this.nb+"/theme/v1.3/dd-via.png"}),offset:new V.K(-6,-6),cursor:"pointer",zIndex:this.Me.get("zIndex")+1E3});e.ea=!0;e.L2=b;e.No=c;e.$f=d;e.e("dragging",this.Zo,this);e.e("dragend",function(b){this.um(b);var c={target:this.Me};c.lnglat=b.target.getPosition();b=this.A.lngLatToContainer(c.lnglat); c.pixel=new V.K(b.x,b.y,1);V.event.H(this,"adjust",c)},this);return e},hs:function(b){var c=b.No;b.setMap(null);this.Na[b.$f].splice(c,1);this.Jk[b.$f].splice(c,1);this.uu(this.Jk,!0);this.RG(this.Na[b.$f]);b.C("dragging",this.Zo,this).C("dragend",this.um,this).C("click",this.ex,this)},um:function(){this.Me.VW=!0;this.Me.l("edit")},Zo:function(b){b=b.target;b.qc=!0;b.Wo&&b.Wo.setPosition(this.ow(b.Km,b));b.Ch&&b.Ch.setPosition(this.ow(b,b.Dm));this.Jk[b.$f][b.No]=b.getPosition();this.uu(this.Jk,!0)}, ex:function(b){if(b.target.qc||this.Jk[b.target.$f].length<=(this.Me instanceof yc?2:3))b.target.qc=!1;else{var c=b.target;this.hs(c);var d={target:this.Me};d.lnglat=b.target.getPosition();b=this.A.lngLatToContainer(d.lnglat);d.pixel=new V.K(b.x,b.y,1);V.event.H(this,"removenode",d);this.As(c.Km,c.Dm);c.Wo&&c.Wo.setMap(null);c.Ch&&c.Ch.setMap(null);c.Km&&c.Dm?this.vr(c.Km,c.Dm,c.$f):c.Km?c.Dm||(c.Km.Ch=null):c.Dm.Wo=null;this.um()}},RG:function(b){for(var c=0,d=b.length;c<d;c+=1)b[c].No=c},uu:function(b){this.Me&& (this.Me instanceof yc?b=b[0]:1!==b.length||b[0]instanceof V.O||(b=b[0]),this.Me.setPath(b,!0))},vr:function(b,c,d){var e=this.ow(b,c),g=this.yo(e),h,k,l;g.setOpacity(0.5);g.$f=d;b.Ch=c.Wo=g;k=function(){var d=c.No;g.No=d;g.qc=!0;g.C("click",h,this).e("click",this.ex,this);e=g.getPosition();this.Jk[g.$f].splice(d,0,e);this.uu(this.Jk,!0);this.Na[g.$f].splice(d,0,g);g.setOpacity(1);this.RG(this.Na[g.$f]);this.As(b,g);this.As(g,c)};l=function(d){g.qc=!1;g.C("dragstart",k,this);g.C("dragend",l,this); if(g.getMap()){var e={target:this.Me};e.lnglat=d.target.getPosition();d=this.A.lngLatToContainer(e.lnglat);e.pixel=new V.K(d.x,d.y,1);V.event.H(this,"addnode",e);this.vr(b,g,g.$f);this.vr(g,c,g.$f)}};h=function(b){k.call(this);l.call(this,b);this.um()};g.e("click",h,this).e("dragstart",k,this).e("dragend",l,this);g.setMap(this.A)},As:function(b,c){b&&(b.Dm=c);c&&(c.Km=b)},ow:function(b,c){var d=this.A,e=d.qb(b.getPosition()),g=d.qb(c.getPosition());return d.yf(e.add(g).Gb(2))}}); window.AMap.PolyEditor=V.gN; ')
_jsload_('AMap.Geolocation', 'V.dC=V.W.extend({oa:[V.ca],B:function(b){this.CLASS_NAME="AMap.Geolocation";V.a.Sa(this.CLASS_NAME,b);this.options={enableHighAccuracy:!1,timeout:5E3,maximumAge:3E4,GeoLocationFirst:!1,convert:!0,convertUrl:V.k.gc+"/v3/assistant/coordinate/convert?coordsys=gps&output=json&s=rsv3&locations={x},{y}&key="+V.k.key,showButton:!0,buttonDom:\'<div class="amap-geo"></div>\',buttonPosition:"LB",buttonOffset:new V.K(10,20),showMarker:!0,markerOptions:{offset:new V.K(-11,-11),content:"<div style=\'width:23px;height:23px;overflow:hidden;\'><img style=\'position:relative;cursor:pointer;\'  width=\'23px\' height=\'23px\'  src=\'"+ V.k.Ce+"/loc.png\'></div>"},showCircle:!0,circleOptions:{strokeColor:"#0093FF",strokeOpacity:0.5,strokeWeight:1,fillColor:"#02B0FF",fillOpacity:0.25},panToLocation:!0,zoomToAccuracy:!1,noIpLocate:0,noGeoLocation:0,useNative:!1,extensions:"base",stopWhenPermissionDenied:!0};if(b)for(var c in b)c in this.options&&(this.options[c]=b[c]);switch(this.options.noGeoLocation){case 0:this.$n=!0;break;case 1:this.$n=!V.j.U;break;case 2:this.$n=V.j.U;break;case 3:this.$n=!1;break;default:this.$n=!0}switch(this.options.noIpLocate){case 0:this.dm= !0;break;case 1:this.dm=!V.j.U;break;case 2:this.dm=V.j.U;break;case 3:this.dm=!1;break;case !0:this.dm=!1;break;default:this.dm=!0}this.Fa=this.yb=this.Dv=this.qm=this.re=this.A=null;this.oD=V.event.addListener(this,"complete",this.tZ,this);this.FD=V.event.addListener(this,"error",this.uZ,this)},isSupported:function(){return!!navigator.geolocation},bg:function(b){new V.na.za(V.k.nc+"://webapi.amap.com/count?"+["type=loc","k="+V.k.key,"u="+V.k.al,"m="+(V.j.U?1:0),"pf="+V.j.uq,"suc="+b].join("&"))}, xX:function(b){function c(c){c.status=1;e.Bn(c,function(c,d){d.info="SUCCESS";b&&b("complete",d);V.event.H(e,"complete",d)})}function d(c){function d(h){h.message=c.message+h.message;h.status=1;e.Bn(h,function(c,d){d.info="SUCCESS";b&&b("complete",d);V.event.H(e,"complete",d)})}function k(d){c.message+=d.message;c.info="FAILED";c.status=0;b&&b("error",c);V.event.H(e,"error",c)}e.$n?e.DI(d,k):k({message:"GeoLocation is closed by noGeoLocation option,pass Geolocation."})}var e=this;e.dm?e.HI(c,d):d({message:"IpLocation is closed by noIpLocate option,pass IpLocation."})}, DI:function(b,c){if(this.isSupported()){var d=this;V.g.lz(function(e,g){if(e)d.bg("err"),c({message:e?e.message:""});else{var h=setTimeout(function(){h=null;c({message:"Get geolocation time out."});d.bg("waitetimeout");k=!0},d.options.timeout),k=!1;g.getCurrentPosition(function(e){if(!k)if(clearTimeout(h),e.coords&&e.coords.longitude){d.bg("success");e={position:new V.O(e.coords.longitude,e.coords.latitude),location_type:"html5",message:"Get geolocation success.",accuracy:e.coords.accuracy};var g= !1;V.j.xI&&(g=!0);d.options.convert?g?(e.isConverted=!0,e.message+="Don\'t need convert.",b(e)):d.OH(e,function(c){b(c)}):(g?(e.message+="Don\'t need convert.",e.isConverted=!0):(e.isConverted=!1,e.message+="convert option is false,pass convert."),b(e))}else d.bg("failed"),c({code:2,info:"POSITION_UNAVAILABLE",message:"Get geolocation failed."})},function(b){k||(clearTimeout(h),1===b.code?(b={code:1,info:"PERMISSION_DENIED",message:"Geolocation permission denied."},d.bg("denied"),c(b)):3===b.code?(b= {code:3,info:"TIME_OUT",message:"Get geolocation time out."},d.bg("timeout"),c(b)):2===b.code&&(b={code:3,info:"POSITION_UNAVAILABLE",message:"Get geolocation failed."},d.bg("failed"),c(b)))},this.options)}},{timeout:d.options.timeout})}else c({message:"Browser not Support html5 geolocation."})},OH:function(b,c){var d=b.position,d=this.options.convertUrl.replace("{x}",d.I).replace("{y}",d.M),d=new V.na.za(d,{callback:"callback"});V.event.addListener(d,"complete",function(d){1===parseInt(d.status)&& d.locations?(d=d.locations.split(","),d=new V.O(parseFloat(d[0]),parseFloat(d[1])),b.position=d,b.isConverted=!0,b.message+="Convert Success."):(b.isConverted=!1,b.message+="Convert failed.");c(b)},this);V.event.addListener(d,"error",function(){b.message+="Convert request failed.";b.isConverted=!1;c(b)},this)},HI:function(b,c){var d=new V.na.za(V.k.nc+"://webapi.amap.com/maps/ipLocation?key="+V.k.key,{callback:"callback"});d.e("complete",function(d){d.status&&d.lng&&d.lat?(d.position=V.g.pW(d.lng, d.lat),delete d.lng,delete d.lat,d.message="Get ipLocation success.",d.location_type="ip",d.accuracy=null,d.isConverted=!0,b(d)):c({message:"Get ipLocation failed."})},this);d.e("error",function(){c({message:"Request ipLocation failed."})},this)},wX:function(b){function c(c){function g(g){g.message=c.message+g.message;g.status=1;d.Bn(g,function(c,e){e.info="SUCCESS";b&&b("complete",e);V.event.H(d,"complete",e)})}function h(g){c.message+=g.message;if(1==g.code)c.info="FAILED",c.status=0,b&&b("error", c),V.event.H(d,"error",c);else{g=function(g){c.message+=g.message;c.info="FAILED";c.status=0;b&&b("error",c);V.event.H(d,"error",c)};var h=function(g){g.status=1;g.message=c.message+g.message;d.Bn(g,function(c,e){e.info="SUCCESS";b&&b("complete",e);V.event.H(d,"complete",e)})};d.dm?d.HI(h,g):g({message:"IpLocation is closed by noIpLocate option,pass ipLocation."})}}d.$n?d.DI(g,h):h({message:"Geolocation is closed by noGeoLocation option,pass Geolocation."})}var d=this;this.options.useNative&&V.j.Lf? this.VY(function(c){c.status=1;d.Bn(c,function(c,e){e.info="SUCCESS";b&&b("complete",e);V.event.H(d,"complete",e)})},function(b){c(b)}):c({message:""})},getCurrentPosition:function(b){V.a.add(this.CLASS_NAME,"getCurrentPosition");this.Lw=!0;V.f.pb(this.re,"amap-locate-loading");V.j.U||this.options.GeoLocationFirst?this.wX(b):this.xX(b)},getCityInfo:function(b){V.a.add(this.CLASS_NAME,"getCityInfo");var c=new V.na.za(V.k.nc+"://webapi.amap.com/maps/ipCity?key="+V.k.key,{callback:"callback"});c.e("complete", function(c){c.center&&1==c.status?(c.isConverted=!0,c.info="SUCCESS",c.message="Get city by ip success.",b&&b("complete",c)):(c.info="FAILED",c.message="Get city by ip failed.",b&&b("error",c))},this);c.e("error",function(){b&&b("error",{status:0,message:"Request ipCity failed.",info:"FAILED"})},this)},watchPosition:function(){V.a.add(this.CLASS_NAME,"watchPosition");if(this.isSupported()){if(V.j.U){var b=this;return V.g.lz(function(c,d,e){if(c)V.event.H(b,"error",{status:0,info:"FAILED",message:"Get geolocation error on watch."}); else return c=d.watchPosition(function(c){if(c.coords&&c.coords.longitude){c={position:new V.O(c.coords.longitude,c.coords.latitude),location_type:"html5",message:"Watch position success by GeoLocation.",status:1,accuracy:c.coords.accuracy};var d=!1;V.j.xI&&(d=!0);var e=function(c){b.Bn(c,function(c,d){d.info="SUCCESS";V.event.H(b,"complete",d)})};b.options.convert?d?(c.message+="Don\'t need convert.",c.isConverted=!0,e(c)):b.OH(c,function(b){e(b)}):(d?(c.message+="Don\'t need convert.",c.isConverted= !0):(c.message+="convert option is false,pass convert.",c.isConverted=!1),e(c))}else V.event.H(b,"error",{status:0,info:"FAILED",message:"Watch position failed by GeoLocation,incorrect position."})},function(){V.event.H(b,"error",{status:0,info:"FAILED",message:"Watch position failed by GeoLocation."})},b.options),e&&V.g.l0(e,c),c},{x1:!0})}V.event.H(this,"error",{status:0,info:"NOT_SUPPORT",message:"Forbidden watchPosition on PC device."})}else return V.event.H(this,"error",{status:0,info:"NOT_SUPPORT", message:"Browser not Support html5 GeoLocation."}),null},clearWatch:function(b){V.a.add(this.CLASS_NAME,"clearWatch");if(this.isSupported())return V.g.lz(function(c,d){c||V.g.w1(b,function(c,g){c||(V.g.OV(b),d.clearWatch(g))})})},Wm:function(b,c){if(!this.re){var d=document.createElement("div");this.Lw&&V.f.pb(d,"amap-locate-loading");V.f.pb(d,"amap-geolocation-con");"object"===typeof this.options.buttonDom?d.appendChild(this.options.buttonDom):d.innerHTML=this.options.buttonDom;d.style.position= "absolute";d.style.zIndex="9999";this.options.showButton||(d.style.visibility="hidden");this.kp(d,this.options.buttonPosition,this.options.buttonOffset);this.re=d}this.A=b;c.appendChild(this.re);this.qm=c;this.Dv=V.event.T(this.re,"click",this.sZ,this)},Jn:function(){V.event.removeListener(this.oD);this.oD=null;V.event.removeListener(this.FD);this.FD=null;V.event.removeListener(this.Dv);this.Dv=null;this.qm.removeChild(this.re);this.A=this.qm=null;this.yb&&(this.yb.setMap(null),this.yb=null);this.Fa&& (this.Fa.setMap(null),this.Fa=null)},kp:function(b,c,d){"LT"!==c&&"RT"!==c&&"LB"!==c&&"RB"!==c&&(c="LT");switch(c){case "LT":V.f.ja(b,{left:d.x+"px",top:d.y+"px",right:"",bottom:""});break;case "RT":V.f.ja(b,{right:d.x+"px",top:d.y+"px",left:"",bottom:""});break;case "LB":V.f.ja(b,{left:d.x+"px",bottom:d.y+"px",right:"",top:""});break;case "RB":V.f.ja(b,{right:d.x+"px",bottom:d.y+"px",left:"",top:""})}this.qm&&(this.qm.removeChild(b),this.qm.appendChild(b))},x0:function(b,c){if(this.A){var d=this.options; d.showMarker&&(this.yb||(this.yb=new Z(d.markerOptions),this.yb.ea=!0),this.yb.setPosition(b),this.yb.setMap(this.A));d.showCircle&&(this.Fa||(this.Fa=new xc(d.circleOptions)),this.Fa.setCenter(b),this.Fa.setRadius(c||0),this.Fa.setMap(this.A),this.Fa.ea=!0);d.panToLocation&&this.A.panTo(b);d.zoomToAccuracy&&this.Fa&&this.A.setFitView([this.Fa])}},p4:function(){this.yb&&this.yb.setMap(null);this.Fa&&this.Fa.setMap(null)},Bn:function(b,c){var d=this,e=b.position;V.Qa.load("AMap.Geocoder",function(){d.yI|| (d.yI=new V.cC({extensions:d.options.extensions}));d.yI.getAddress(e,function(d,e){"complete"==d?(V.extend(b,e.regeocode),b.message+="Get address success."):b.message+="Get address fail,check your key or network.";c("complete",b)})})},sZ:function(){this.getCurrentPosition()},tZ:function(b){this.Lw=!1;V.f.wb(this.re,"amap-locate-loading");this.x0(b.position,b.accuracy)},uZ:function(){this.Lw=!1;V.f.wb(this.re,"amap-locate-loading")},VY:function(b,c){function d(b){1!=b&&e.bg("sdkerror");c&&c.call&& c.call(e,{message:"Get sdkLocation failed."})}var e=this,g=new V.na.za("http://127.0.0.1:43689/geolocation?to=3000&_="+(new Date).getTime(),{callback:"callback"});g.e("complete",function(c){b&&b.call&&c.location&&c.location.x&&c.location.y?(b.call(e,{position:new V.O(c.location.x,c.location.y),accuracy:c.location.precision,message:"Get sdkLocation success.",location_type:"sdk",isConverted:!0}),e.bg("sdksuccess")):(d(1),e.bg("sdkfail"))});g.e("error",d)}});window.AMap.Geolocation=V.dC; ')
_jsload_('AMap.CircleEditor', 'V.WB=V.W.extend({oa:[V.ca],B:function(b,c,d,e){this.CLASS_NAME="AMap.CircleEditor";V.a.Sa(this.CLASS_NAME,e);this.A=b;this.Fa=c;this.Fa.setOptions({draggable:d||!1});this.nb=V.k.nb;e&&e.gt&&(this.gt=!0)},open:function(){V.a.add(this.CLASS_NAME,"open");this.Hf&&this.Gd||this.zw();this.Hf&&this.Hf.setMap(this.A);if(this.Gd)for(var b=0,c=this.Gd.length;b<c;b+=1)this.Gd[b].setMap(this.A);this.IR=this.Fa.getOptions.draggable;this.Fa.e("dragstart",this.jF,this);this.Fa.e("dragging",this.iF,this);this.Fa.e("setCenter", this.AH,this);this.Fa.e("setRadius",this.YK,this)},AH:function(){var b=this.Fa.getCenter(),c=this.Hf.getPosition(),c=b.Ja(c);this.Gd[0].setPosition(this.Gd[0].getPosition().add(c));this.Hf.setPosition(b)},YK:function(){var b=this.Fa.getCenter(),c=this.Fa.getRadius(),d=c*Math.cos(Math.PI/4);this.Gd[0].setPosition(b.offset(d,d));this.Gd[0].setLabel({content:"\\u534a\\u5f84:"+c+"\\u7c73"})},close:function(){V.a.add(this.CLASS_NAME,"close");this.Hf&&(this.Hf.setMap(null),delete this.Hf);if(this.Gd){for(var b= 0,c=this.Gd.length;b<c;b+=1)this.Gd[b].setMap(null);delete this.Gd}this.Fa.setOptions({draggable:this.IR});this.Fa.C("dragstart",this.jF,this);this.Fa.C("dragging",this.iF,this);this.Fa.C("setCenter",this.AH,this);this.Fa.C("setRadius",this.YK,this);this.l("end",{type:"end",target:this.Fa})},jF:function(b){this.DC=b.lnglat},iF:function(b){var c=b.lnglat.Ja(this.DC);this.DC=b.lnglat;this.Hf.setPosition(this.Hf.getPosition().add(c));this.Gd[0].setPosition(this.Gd[0].getPosition().add(c))},zw:function(){this.bP(); this.dP()},bP:function(){var b=this.Fa.getCenter();this.gt?(this.Hf=new Z({position:b,visible:!1}),this.Hf.ea=!0):this.Hf=this.yo(b)},dP:function(){var b=this.Fa.getCenter(),b=this.bQ(b);this.Gd=[];this.Gd.push(this.yo(b,!0))},bQ:function(b){var c=this.Fa.getRadius()*Math.cos(Math.PI/4);return b.offset(c,c)},yo:function(b,c){var d=new Z({position:b,draggable:!0,icon:new Lc({size:new V.Yb(11,11),imageOffset:new V.K(0,0),image:this.nb+"/theme/v1.3/dd-via.png"}),offset:new V.K(-6,-6),zIndex:this.Fa.get("zIndex")+ 1E3});d.ea=!0;c&&(d.setLabel({content:"\\u534a\\u5f84:"+this.Fa.getRadius()+"\\u7c73",offset:new AMap.Pixel(15,-4)}),d.setTitle("\\u62d6\\u62fd\\u4fee\\u6539\\u534a\\u5f84"));this.hO(d);return d},hO:function(b){b.e("dragstart",this.CF,this).e("dragging",this.Zo,this).e("dragend",this.BF,this)},S2:function(b){b.C("dragstart",this.CF,this).C("dragging",this.Zo,this).C("dragend",this.BF,this)},CF:function(){},um:function(){this.Fa.VW=!0;this.Fa.l("edit")},Zo:function(b){b=b.target;var c=b.getPosition();b===this.Hf? this.uR(c):this.IT(c)},BF:function(){this.um();this.l("dragend",{type:"dragend",target:this.Fa})},uR:function(b){if(!this.gt){var c=this.Gd[0].getPosition().add(b.Ja(this.Fa.getCenter()));this.Gd[0].setPosition(c);this.Fa.setCenter(b,!0);this.l("move",{type:"move",lnglat:b,target:this.Fa})}},IT:function(b){var c=this.Fa.getCenter();b=Math.round(c.distance(b));this.Fa.setRadius(b,!0);this.Gd[0].setLabel({content:"\\u534a\\u5f84:"+b+"\\u7c73"});this.l("adjust",{type:"adjust",radius:b,target:this.Fa})}}); window.AMap.CircleEditor=V.WB; ')